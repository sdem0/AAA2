(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 10.2' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[    317306,       8505]
NotebookOptionsPosition[    304751,       8292]
NotebookOutlinePosition[    305189,       8309]
CellTagsIndexPosition[    305146,       8306]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell["Background", "Section",
 CellChangeTimes->{{3.8533889500480013`*^9, 
  3.8533889598990817`*^9}},ExpressionUUID->"2820e5eb-ad93-4e7a-9a51-\
957c3d5b4c62"],

Cell[TextData[{
 "For ease of handling all the shape functions are collected in one vector ",
 Cell[BoxData[
  FormBox[
   RowBox[{"{", "\[Psi]", "}"}], TraditionalForm]],
  FormatType->TraditionalForm,ExpressionUUID->
  "cae63727-531d-4306-aa50-f2426b8dfcfa"],
 " . The appropriate shape functions are selected using the Selection \
matrices when constructing the displacement fields (twist, out - of - plane \
deflection and bending rotation) over the element ",
 Cell[BoxData[
  FormBox["i", TraditionalForm]],
  FormatType->TraditionalForm,ExpressionUUID->
  "1963efd4-49c1-4f0a-84fc-b91c42f48436"],
 ":\n",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{
     SuperscriptBox["\[Theta]", "i"], "(", 
     RowBox[{"z", ",", "t"}], ")"}], "=", 
    RowBox[{
     SuperscriptBox[
      RowBox[{"{", "\[Psi]", "}"}], "T"], "*", 
     RowBox[{"[", 
      SubscriptBox["A", "\[Theta]"], "]"}], "*", 
     SubscriptBox[
      RowBox[{"{", "\[Theta]", "}"}], "i"]}]}], TraditionalForm]],
  FormatType->TraditionalForm,ExpressionUUID->
  "2059677b-2815-4cf7-b5f2-fedc6aa454f2"],
 "\nwhere ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SuperscriptBox["\[Theta]", "i"], "(", 
    RowBox[{"z", ",", "t"}], ")"}], TraditionalForm]],
  FormatType->TraditionalForm,ExpressionUUID->
  "c0ad3567-3fc8-4e88-94fa-ce697e279318"],
 " represents the continuous torsional displacement over the element ",
 Cell[BoxData[
  FormBox["i", TraditionalForm]],
  FormatType->TraditionalForm,ExpressionUUID->
  "b42c1b58-2f5c-4077-8132-e7348b2fbef5"],
 ", ",
 Cell[BoxData[
  FormBox[
   RowBox[{"{", "\[Psi]", "}"}], TraditionalForm]],
  FormatType->TraditionalForm,ExpressionUUID->
  "e7366d40-4875-462e-9e52-545c251519f1"],
 " is the vector of shape functions, ",
 Cell[BoxData[
  FormBox[
   RowBox[{"[", 
    SubscriptBox["A", "\[Theta]"], "]"}], TraditionalForm]],
  FormatType->TraditionalForm,ExpressionUUID->
  "054efec6-8b2f-4722-8510-bfc4c581f737"],
 " is the selection matrix that selects the right shape functions from the \
vector of shape functions ",
 Cell[BoxData[
  FormBox[
   RowBox[{"{", "\[Psi]", "}"}], TraditionalForm]],
  FormatType->TraditionalForm,ExpressionUUID->
  "e8c9a97e-dfe0-4c7b-96a6-5a419b6beec4"],
 ", ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox[
     RowBox[{"{", "\[Theta]", "}"}], "i"], "=", " ", 
    RowBox[{"{", 
     RowBox[{
      SubscriptBox["\[Theta]", "i"], ",", " ", 
      SubscriptBox["\[Theta]", 
       RowBox[{"i", "+", "1"}]]}], "}"}]}], TraditionalForm]],
  FormatType->TraditionalForm,ExpressionUUID->
  "8de82f40-8070-4816-aead-f6fc4ead61a7"],
 " is the vector of nodal displacements on element ",
 Cell[BoxData[
  FormBox["i", TraditionalForm]],
  FormatType->TraditionalForm,ExpressionUUID->
  "41e8210d-c54b-4226-8ea5-1caf97e9e00e"],
 ".\n\nThe same is done for   other quantities:\n",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{
     SuperscriptBox["v", "i"], "(", 
     RowBox[{"z", ",", "t"}], ")"}], "=", 
    RowBox[{
     SuperscriptBox[
      RowBox[{"{", "\[Psi]", "}"}], "T"], "*", 
     RowBox[{"[", 
      SubscriptBox["A", "v"], "]"}], "*", 
     SubscriptBox[
      RowBox[{"{", "v", "}"}], "i"]}]}], TraditionalForm]],
  FormatType->TraditionalForm,ExpressionUUID->
  "1848d1f7-da92-4d10-b6af-88da70ac6f04"],
 "\n",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{
     SuperscriptBox["r", "i"], "(", 
     RowBox[{"z", ",", "t"}], ")"}], "=", 
    RowBox[{
     SuperscriptBox[
      RowBox[{"{", "\[Psi]", "}"}], "T"], "*", 
     RowBox[{"[", 
      SubscriptBox["A", "r"], "]"}], "*", 
     SubscriptBox[
      RowBox[{"{", "r", "}"}], "i"]}]}], TraditionalForm]],
  FormatType->TraditionalForm,ExpressionUUID->
  "5b31390a-fd27-46f2-97de-de12603550e7"],
 "\n",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{
     SuperscriptBox["V", "i"], "(", 
     RowBox[{"z", ",", "t"}], ")"}], "=", 
    RowBox[{
     SuperscriptBox[
      RowBox[{"{", "\[Psi]", "}"}], "T"], "*", 
     RowBox[{"[", 
      SubscriptBox["A", "V"], "]"}], "*", 
     SubscriptBox[
      RowBox[{"{", "V", "}"}], "i"]}]}], TraditionalForm]],
  FormatType->TraditionalForm,ExpressionUUID->
  "3a973ccf-5bf2-48fa-a4ae-a0b032301900"],
 "\n",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{
     SuperscriptBox["M", "i"], "(", 
     RowBox[{"z", ",", "t"}], ")"}], "=", 
    RowBox[{
     SuperscriptBox[
      RowBox[{"{", "\[Psi]", "}"}], "T"], "*", 
     RowBox[{"[", 
      SubscriptBox["A", "M"], "]"}], "*", 
     SubscriptBox[
      RowBox[{"{", "M", "}"}], "i"]}]}], TraditionalForm]],
  FormatType->TraditionalForm,ExpressionUUID->
  "e1d9c776-d7dd-42b4-a47e-95346f960477"],
 "\nwhere ",
 Cell[BoxData[
  FormBox[
   RowBox[{"v", " ", "=", " ", 
    RowBox[{"{", 
     RowBox[{"v", ",", "\[Beta]"}], "}"}]}], TraditionalForm]],
  FormatType->TraditionalForm,ExpressionUUID->
  "24ca5374-c6e5-4a53-913d-3f0a33aed918"],
 " represents the out-of-plane displacement and bending rotation associated \
with bending, ",
 Cell[BoxData[
  FormBox["r", TraditionalForm]],
  FormatType->TraditionalForm,ExpressionUUID->
  "cae3dce6-665b-49e3-aade-128c6d924cb5"],
 " represents torque per unit length, ",
 Cell[BoxData[
  FormBox["V", TraditionalForm]],
  FormatType->TraditionalForm,ExpressionUUID->
  "65a781d5-1a00-4d42-90f1-6cee26949f9c"],
 " represents shear force per unit length, and ",
 Cell[BoxData[
  FormBox["M", TraditionalForm]],
  FormatType->TraditionalForm,ExpressionUUID->
  "454a0ee9-4e88-4966-b5c2-86c51f954df1"],
 " represents bending moment per unit length. "
}], "Text",
 CellChangeTimes->{{3.8533848795130777`*^9, 3.853384888232539*^9}, {
  3.8533849374078526`*^9, 3.853384955832472*^9}, {3.853384992383651*^9, 
  3.8533850469387007`*^9}, {3.853385077270194*^9, 3.853385093431815*^9}, {
  3.8533851759829082`*^9, 3.85338556100807*^9}, {3.8533856609829173`*^9, 
  3.8533858269853077`*^9}, {3.8533858850420017`*^9, 
  3.8533859820114946`*^9}},ExpressionUUID->"e014c3eb-9496-4ff2-a15d-\
3e4365783218"],

Cell[CellGroupData[{

Cell["Scaling", "Subsection",
 CellChangeTimes->{{3.85338899886574*^9, 
  3.853389007400195*^9}},ExpressionUUID->"4d02d3aa-253a-4332-825f-\
23eec052ed53"],

Cell[TextData[{
 "Dimensional scaling matrices are required to match the dimensions in the \
energy expressions for bending. Bending displacement is described by the \
out-of-plane displacement, ",
 Cell[BoxData[
  FormBox["v", TraditionalForm]],
  FormatType->TraditionalForm,ExpressionUUID->
  "5738c652-372f-4247-bde4-76ab7af6b86e"],
 ", and bending rotation, ",
 Cell[BoxData[
  FormBox["\[Beta]", TraditionalForm]],
  FormatType->TraditionalForm,ExpressionUUID->
  "8ddc5c4a-360c-405e-a84b-f2f2c714c53d"],
 ". To arrive at the correct dimensions the bending rotation must be scaled \
with the length of the beam element:\n",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SuperscriptBox["U", "i"], "=", " ", 
    RowBox[{
     RowBox[{
      FractionBox["1", "2"], 
      RowBox[{
       SubsuperscriptBox["\[Integral]", 
        SubscriptBox["x", "i"], 
        SubscriptBox["x", 
         RowBox[{"i", "+", "1"}]]], 
       RowBox[{
        SuperscriptBox[
         RowBox[{"EI", "(", 
          RowBox[{
           SubscriptBox["\[PartialD]", "x"], " ", 
           RowBox[{
            SuperscriptBox["v", "i"], "(", 
            RowBox[{"z", ",", "t"}], ")"}]}], ")"}], "2"], 
        RowBox[{"\[DifferentialD]", "x"}]}]}]}], "=", "  ", 
     RowBox[{
      RowBox[{
       FractionBox["1", "2"], 
       RowBox[{
        SubsuperscriptBox["\[Integral]", "0", "1"], 
        RowBox[{"EI", " ", 
         FractionBox["1", 
          SuperscriptBox[
           SubscriptBox["L", "i"], "4"]], 
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{
            SubscriptBox["\[PartialD]", "z"], 
            RowBox[{
             SubscriptBox["\[PartialD]", "z"], " ", 
             RowBox[{
              SuperscriptBox["v", "i"], "(", 
              RowBox[{"z", ",", "t"}], ")"}]}]}], ")"}], "2"], 
         SubscriptBox["L", "i"], 
         RowBox[{"\[DifferentialD]", "z"}]}]}]}], " ", "=", " ", 
      RowBox[{
       FractionBox["1", "2"], 
       FractionBox["1", 
        SuperscriptBox[
         SubscriptBox["L", "i"], "3"]], 
       RowBox[{
        SubsuperscriptBox["\[Integral]", "0", "1"], 
        RowBox[{
         RowBox[{
          RowBox[{
           SuperscriptBox[
            SubscriptBox[
             RowBox[{"{", "v", "}"}], "i"], "T"], "[", 
           SubscriptBox["S", "1"], "]"}], "[", 
          SubscriptBox["A", "v"], "]"}], 
         SuperscriptBox[
          RowBox[{"{", "\[Psi]", "}"}], "''"], "EI", 
         RowBox[{
          RowBox[{
           SuperscriptBox[
            RowBox[{"{", "\[Psi]", "}"}], 
            RowBox[{"''", "T"}]], "[", 
           SubscriptBox["A", "v"], "]"}], "[", 
          SubscriptBox["S", "1"], "]"}], 
         SubscriptBox[
          RowBox[{"{", "v", "}"}], "i"], 
         RowBox[{"\[DifferentialD]", "z"}]}]}]}]}]}]}], TraditionalForm]],
  FormatType->TraditionalForm,ExpressionUUID->
  "3923a08c-3da0-430a-b367-e2c23a5797cd"],
 "\n",
 Cell[BoxData[
  FormBox[
   SuperscriptBox["U", "i"], TraditionalForm]],
  FormatType->TraditionalForm,ExpressionUUID->
  "3cf293d3-97c4-4446-bc32-596f7575cf66"],
 " is the bending strain energy of the element ",
 Cell[BoxData[
  FormBox["i", TraditionalForm]],
  FormatType->TraditionalForm,ExpressionUUID->
  "84d3729a-e78e-40ee-9ff5-86c3981732f3"],
 ". When discretizing the nodal displacements must be scaled with the scaling \
matrix ",
 Cell[BoxData[
  FormBox[
   RowBox[{"[", 
    SubscriptBox["S", "i"], "]"}], TraditionalForm]],
  FormatType->TraditionalForm,ExpressionUUID->
  "59dda90b-dacc-4b45-ad98-b4f7acc9bdf6"],
 " to get to the correct dimensions for energy. ",
 Cell[BoxData[
  FormBox[
   RowBox[{"[", 
    SubscriptBox["S", "i"], "]"}], TraditionalForm]],
  FormatType->TraditionalForm,ExpressionUUID->
  "dbfce208-98f7-453f-8e14-b922605e5e98"],
 "  is of the following form:\n",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox[
     RowBox[{"[", 
      SubscriptBox["S", "1"], "]"}], "i"], "=", 
    RowBox[{"(", GridBox[{
       {"1", "0", "0", "0", "0", "0"},
       {"0", "1", "0", "0", "0", "0"},
       {"0", "0", "Li", "0", "0", "0"},
       {"0", "0", "0", "1", "0", "0"},
       {"0", "0", "0", "0", "1", "0"},
       {"0", "0", "0", "0", "0", "Li"}
      },
      GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.7]}, 
          Offset[0.27999999999999997`]}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}}], "\[NoBreak]", ")"}]}], TraditionalForm]],
  FormatType->TraditionalForm,ExpressionUUID->
  "005099a4-b2f4-40b0-a6fb-5a433d56385f"],
 "\nIn the current case the nodal DOFs are organised as follows ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox[
     RowBox[{"{", "\[Xi]", "}"}], "i"], "=", 
    RowBox[{"{", 
     RowBox[{
      SubscriptBox["\[Theta]", "i"], ",", " ", 
      SubscriptBox["v", "i"], ",", " ", 
      SubscriptBox["\[Beta]", "i"], ",", " ", 
      SubscriptBox["\[Theta]", 
       RowBox[{"i", "+", "1"}]], ",", " ", 
      SubscriptBox["v", 
       RowBox[{"i", "+", "1"}]], ",", " ", 
      SubscriptBox["\[Beta]", 
       RowBox[{"i", "+", "1"}]]}], "}"}]}], TraditionalForm]],
  FormatType->TraditionalForm,ExpressionUUID->
  "95ec77eb-220d-4486-af09-6e21ecd5a089"],
 ".  ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["\[Beta]", "i"], TraditionalForm]],
  FormatType->TraditionalForm,ExpressionUUID->
  "9409a662-50e4-4d33-b88b-e9e216605ab6"],
 ", ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["\[Beta]", 
    RowBox[{"i", "+", "1"}]], TraditionalForm]],
  FormatType->TraditionalForm,ExpressionUUID->
  "0e9837c8-5e3d-4049-9aea-2aeef67964a9"],
 " need to be scaled by ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["L", "i"], TraditionalForm]],
  FormatType->TraditionalForm,ExpressionUUID->
  "9f7ee2a8-daac-48bd-8ac4-90d387ba0525"],
 ", hence the ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["L", "i"], TraditionalForm]],
  FormatType->TraditionalForm,ExpressionUUID->
  "fe29593b-babb-4f4e-b2dc-ed27494d31a8"],
 " entries at locations [3,3] and [6,6].\n\nNOTE:\n> That matrices ",
 Cell[BoxData[
  FormBox[
   RowBox[{"[", 
    SubscriptBox["A", "v"]}], TraditionalForm]],
  FormatType->TraditionalForm,ExpressionUUID->
  "4c33c693-352b-4e04-8dba-70475227d0ed"],
 "], ",
 Cell[BoxData[
  FormBox[
   RowBox[{"[", 
    SubscriptBox["S", "1"]}], TraditionalForm]],
  FormatType->TraditionalForm,ExpressionUUID->
  "a493e859-41e1-4a0e-96bd-da2de97ad4f9"],
 "] are symmetric, hence no Transpose is required.\n> when changing the \
derivatives from physical coordinate ",
 Cell[BoxData[
  FormBox["x", TraditionalForm]],
  FormatType->TraditionalForm,ExpressionUUID->
  "a7132428-4447-4e64-8e44-f17c8a11e352"],
 " to non-dimensional coordinate ",
 Cell[BoxData[
  FormBox[
   RowBox[{"z", "=", " ", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"x", "-", 
       SubscriptBox["x", "i"]}], ")"}], "/", 
     SubscriptBox["L", "i"]}]}], TraditionalForm]],
  FormatType->TraditionalForm,ExpressionUUID->
  "77932fd4-5288-4948-b026-fb030e970536"],
 ", the derivates scale as:\n",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{
     SubscriptBox["\[PartialD]", "x"], " ", 
     RowBox[{"(", ")"}]}], " ", "=", " ", 
    RowBox[{
     RowBox[{
      RowBox[{
       SubscriptBox["\[PartialD]", "z"], " ", 
       RowBox[{"(", ")"}]}], "*", 
      RowBox[{
       SubscriptBox["\[PartialD]", "x"], " ", "z"}]}], "=", " ", 
     RowBox[{
      FractionBox["1", 
       SubscriptBox["L", "i"]], 
      RowBox[{
       SubscriptBox["\[PartialD]", "z"], " ", 
       RowBox[{"(", ")"}]}]}]}]}], TraditionalForm]],
  FormatType->TraditionalForm,ExpressionUUID->
  "611f183e-0fb0-4990-ac76-57916b410ff8"],
 "\n",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{
     SubscriptBox["\[PartialD]", "xx"], " ", 
     RowBox[{"(", ")"}]}], " ", "=", " ", 
    RowBox[{
     RowBox[{
      RowBox[{
       SubscriptBox["\[PartialD]", "z"], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          SubscriptBox["\[PartialD]", "z"], " ", 
          RowBox[{"(", ")"}]}], "*", 
         RowBox[{
          SubscriptBox["\[PartialD]", "x"], " ", "z"}]}], ")"}]}], 
      RowBox[{
       SubscriptBox["\[PartialD]", "x"], " ", "z"}]}], "=", " ", 
     RowBox[{
      RowBox[{
       FractionBox["1", 
        SubscriptBox["L", "i"]], 
       RowBox[{
        SubscriptBox["\[PartialD]", "z"], 
        RowBox[{"(", 
         RowBox[{
          FractionBox["1", 
           SubscriptBox["L", "i"]], 
          RowBox[{
           SubscriptBox["\[PartialD]", "z"], " ", 
           RowBox[{"(", ")"}]}]}], ")"}]}]}], " ", "=", 
      RowBox[{
       FractionBox["1", 
        SuperscriptBox[
         SubscriptBox["L", "i"], "2"]], 
       RowBox[{
        SubscriptBox["\[PartialD]", "zz"], " ", 
        RowBox[{"(", ")"}], " "}]}]}]}]}], TraditionalForm]],
  FormatType->TraditionalForm,ExpressionUUID->
  "3e566c3c-4760-4fd7-a864-4e56f8d31710"],
 "\n> Matrix ",
 Cell[BoxData[
  FormBox[
   RowBox[{"[", 
    SubscriptBox["S", "1"]}], TraditionalForm]],
  FormatType->TraditionalForm,ExpressionUUID->
  "e274cd68-258a-44bd-b4c5-2b3bbf685618"],
 "] is element dependent (on the length of the element)\n> Matrix ",
 Cell[BoxData[
  FormBox[
   RowBox[{"[", 
    SubscriptBox["A", "v"]}], TraditionalForm]],
  FormatType->TraditionalForm,ExpressionUUID->
  "8c08d8f3-b705-492b-ba8a-17ded910b17d"],
 "] is element independent."
}], "Text",
 CellChangeTimes->{{3.8533860361894417`*^9, 3.853386150500641*^9}, {
  3.8533862156199703`*^9, 3.853386240569703*^9}, {3.853386288798647*^9, 
  3.8533863023772078`*^9}, {3.853386353291856*^9, 3.8533863696718717`*^9}, {
  3.8533864031614084`*^9, 3.8533864267290335`*^9}, {3.853386525412778*^9, 
  3.8533868382328625`*^9}, {3.853386922659117*^9, 3.853386943082583*^9}, {
  3.8533869778184166`*^9, 3.8533871253243093`*^9}, {3.853387162836444*^9, 
  3.8533873953942566`*^9}, {3.8533874546538353`*^9, 3.8533875057360115`*^9}, {
  3.8533875536568956`*^9, 3.853387771709468*^9}, {3.8533881711649685`*^9, 
  3.8533885545278125`*^9}, {3.8533886850618854`*^9, 3.8533887772408314`*^9}, {
  3.853388853783249*^9, 
  3.853388917948744*^9}},ExpressionUUID->"1569139e-cee4-4ad7-a9c2-\
f4883bc1e428"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Derivation of the Elemental matrices ", "Subsection",
 CellChangeTimes->{{3.85338902375171*^9, 3.8533890403147087`*^9}, {
  3.8533900373384933`*^9, 
  3.8533900448357553`*^9}},ExpressionUUID->"8c8042b4-13fe-4d5b-967b-\
52c31362409e"],

Cell[TextData[{
 "The main part of the FEM model are elemental mass and stiffness matrices, \
and the matrices for generalised forces. The elemental matrices are derived \
in three steps: \n1) derive the nucleus of the elemental matrix (numerical \
coefficients which are equal for all the elements based on the selection of \
the shape functions):\n\n",
 Cell[BoxData[{
  FormBox[
   RowBox[{
    RowBox[{
     SuperscriptBox["U", "i"], "=", " ", 
     RowBox[{
      RowBox[{
       FractionBox["1", "2"], 
       FractionBox["1", 
        SuperscriptBox[
         SubscriptBox["L", "i"], "3"]], 
       RowBox[{
        SubsuperscriptBox["\[Integral]", "0", "1"], 
        RowBox[{
         RowBox[{
          RowBox[{
           SuperscriptBox[
            SubscriptBox[
             RowBox[{"{", "v", "}"}], "i"], "T"], "[", 
           SubscriptBox["S", "1"], "]"}], "[", 
          SubscriptBox["A", "v"], "]"}], 
         SuperscriptBox[
          RowBox[{"{", "\[Psi]", "}"}], "''"], "EI", 
         RowBox[{
          RowBox[{
           SuperscriptBox[
            RowBox[{"{", "\[Psi]", "}"}], 
            RowBox[{"''", "T"}]], "[", 
           SubscriptBox["A", "v"], "]"}], "[", 
          SubscriptBox["S", "1"], "]"}], 
         SubscriptBox[
          RowBox[{"{", "v", "}"}], "i"], 
         RowBox[{"\[DifferentialD]", "z"}]}]}]}], " ", "=", " ", 
      RowBox[{
       RowBox[{
        FractionBox["1", "2"], 
        FractionBox["1", 
         SuperscriptBox[
          SubscriptBox["L", "i"], "3"]], 
        RowBox[{
         RowBox[{
          RowBox[{
           SuperscriptBox[
            SubscriptBox[
             RowBox[{"{", "v", "}"}], "i"], "T"], "[", 
           SubscriptBox["S", "1"], "]"}], "[", 
          RowBox[{
           SubsuperscriptBox["\[Integral]", "0", "1"], 
           RowBox[{
            RowBox[{"[", 
             SubscriptBox["A", "v"], "]"}], 
            SuperscriptBox[
             RowBox[{"{", "\[Psi]", "}"}], "''"], "EI", 
            RowBox[{
             SuperscriptBox[
              RowBox[{"{", "\[Psi]", "}"}], 
              RowBox[{"''", "T"}]], "[", 
             SubscriptBox["A", "v"], "]"}], 
            RowBox[{"\[DifferentialD]", "z"}]}]}], " ", "]"}], "[", 
         SubscriptBox["S", "1"], "]"}], 
        SubscriptBox[
         RowBox[{"{", "v", "}"}], "i"]}], " ", "=", 
       RowBox[{
        FractionBox["1", "2"], 
        FractionBox["EI", 
         SuperscriptBox[
          SubscriptBox["L", "i"], "3"]], 
        RowBox[{
         RowBox[{
          RowBox[{
           SuperscriptBox[
            SubscriptBox[
             RowBox[{"{", "v", "}"}], "i"], "T"], "[", 
           SubscriptBox["S", "1"], "]"}], "[", 
          SubscriptBox["N", "KB"], " ", "]"}], "[", 
         SubscriptBox["S", "1"], "]"}], 
        SubscriptBox[
         RowBox[{"{", "v", "}"}], "i"]}]}]}]}], " "}], 
   TraditionalForm], "\[IndentingNewLine]", 
  FormBox[
   RowBox[{
    SubscriptBox["N", "KB"], "=", 
    RowBox[{"[", 
     RowBox[{
      SubsuperscriptBox["\[Integral]", "0", "1"], 
      RowBox[{
       RowBox[{"[", 
        SubscriptBox["A", "v"], "]"}], 
       SuperscriptBox[
        RowBox[{"{", "\[Psi]", "}"}], "''"], 
       RowBox[{
        SuperscriptBox[
         RowBox[{"{", "\[Psi]", "}"}], 
         RowBox[{"''", "T"}]], "[", 
        SubscriptBox["A", "v"], "]"}], 
       RowBox[{"\[DifferentialD]", "z"}]}]}], " ", "]"}]}], 
   TraditionalForm]}],ExpressionUUID->"b8a6fb3f-632f-4c1d-bcfa-b7b7ef8347cc"],
 "\n\nwhere ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["N", "KB"], TraditionalForm]],ExpressionUUID->
  "ffb37f04-a695-4056-a467-0a73a98f866d"],
 " is the nucleus of the stiffness matrix due to bending.  \n\n2) scale the \
nucleus with the physical properties and the scaling matrix of every \
individual element to get the elemental stiffness matrix due to bending:\n",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SuperscriptBox[
     SubscriptBox["K", "B"], "i"], " ", "=", " ", 
    SubscriptBox[
     RowBox[{
      RowBox[{
       SubscriptBox[
        RowBox[{
         FractionBox[
          SubscriptBox["EI", "i"], 
          SuperscriptBox[
           SubscriptBox["L", "i"], "3"]], "[", 
         SubscriptBox["S", "1"], "]"}], "i"], "[", 
       SubscriptBox["N", "KB"], " ", "]"}], "[", 
      SubscriptBox["S", "1"], "]"}], "i"]}], TraditionalForm]],ExpressionUUID->
  "734fc34f-b670-4021-b5cb-822b6df8a39d"],
 "\n> note, that 1/2 is dropped since the stiffness matrix is obtained as a \
derivative of the strain energy wrt. the displacement DOFs.\n\n3) Add \
together the different contributions to the complete stiffness matrix:\n",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["K", "i"], "="}], TraditionalForm]],ExpressionUUID->
  "56dfddef-4175-4d53-aec2-f16b1f06f94f"],
 " ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SuperscriptBox[
     SubscriptBox["K", "T"], "i"], "+", 
    SuperscriptBox[
     SubscriptBox["K", "TB"], "i"], "+", 
    SuperscriptBox[
     SubscriptBox["K", "BT"], "i"], "+", 
    SuperscriptBox[
     SubscriptBox["K", "B"], "i"]}], TraditionalForm]],ExpressionUUID->
  "24874dda-6a9a-476c-ac0a-66001cb3ae98"],
 "\n\nThe same process is repeated for the elemental mass matrix and the \
matrices governing the distribution of generalised forces (external forces.)"
}], "Text",
 CellChangeTimes->{{3.8533890538715086`*^9, 3.853389168018314*^9}, {
   3.8533892711300917`*^9, 3.853389285324218*^9}, {3.853389315548589*^9, 
   3.8533894368981276`*^9}, {3.853389489555315*^9, 3.8533901514760065`*^9}, 
   3.8540831418467712`*^9, {3.8947940509206204`*^9, 
   3.894794071534791*^9}},ExpressionUUID->"dda5aed4-e7fb-4406-a673-\
b055eea9099d"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Beam Properties", "Section",
 CellChangeTimes->{{3.8529703608935747`*^9, 
  3.8529703680551386`*^9}},ExpressionUUID->"580e10fa-faee-47c9-a4d9-\
319887c7bd49"],

Cell[CellGroupData[{

Cell["Beam properties", "Subsection",
 CellChangeTimes->{{3.6546843383211565`*^9, 
  3.654684344140297*^9}},ExpressionUUID->"c4aa0e9e-f4e9-4053-b1e6-\
99c33b6aa18b"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
   "Number", " ", "of", " ", "elements", " ", "in", " ", "the", " ", "beam", 
    " ", 
    RowBox[{"(", 
     RowBox[{"max", " ", "5"}], ")"}]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"n", " ", "=", " ", "3"}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"Lengths", " ", "of", " ", "individual", " ", "beam", " ", 
     RowBox[{"elements", " ", "[", "m", "]"}]}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"L", " ", "=", " ", 
     RowBox[{"{", 
      RowBox[{
      "L1", ",", " ", "L2", ",", " ", "L3", ",", " ", "L4", ",", " ", "L5"}], 
      "}"}]}], ";"}], " ", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"specific", " ", 
     RowBox[{"mass", " ", "[", 
      RowBox[{"kg", "/", "m"}], "]"}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"M", " ", "=", " ", 
     RowBox[{"{", 
      RowBox[{
      "m1", ",", " ", "m2", ",", " ", "m3", ",", " ", "m4", ",", " ", "m5"}], 
      "}"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "specific", " ", "mass", " ", "polar", " ", "moment", " ", "of", " ", 
     RowBox[{"inertia", " ", "[", 
      RowBox[{
       RowBox[{"kgm", "^", "2"}], "/", "m"}], "]"}]}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Ip", "=", 
     RowBox[{"{", 
      RowBox[{
      "\[Rho]Ip1", ",", " ", "\[Rho]Ip2", ",", " ", "\[Rho]Ip3", ",", " ", 
       "\[Rho]Ip4", ",", " ", "\[Rho]Ip5"}], "}"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"offset", " ", "of", " ", "the", " ", "cross"}], "-", 
     RowBox[{"sectional", " ", "mass", " ", 
      RowBox[{"matrix", " ", "[", "m", "]"}]}]}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"d", " ", "=", " ", 
     RowBox[{"{", 
      RowBox[{
      "d1", ",", " ", "d2", ",", " ", "d3", ",", " ", "d4", ",", " ", "d5"}], 
      "}"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"Torsinal", " ", 
     RowBox[{"stiffness", " ", "[", 
      RowBox[{"Nm", "^", "2"}], "]"}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"GJ", " ", "=", " ", 
     RowBox[{"{", 
      RowBox[{
      "GJ1", ",", " ", "GJ2", ",", " ", "GJ3", ",", " ", "GJ4", ",", " ", 
       "GJ5"}], "}"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"Bending", " ", 
     RowBox[{"stiffness", " ", "[", 
      RowBox[{"Nm", "^", "2"}], "]"}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"EI", " ", "=", " ", 
     RowBox[{"{", 
      RowBox[{
      "EI1", ",", " ", "EI2", ",", " ", "EI3", ",", " ", "EI4", ",", " ", 
       "EI5"}], "}"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"Bend", "-", 
     RowBox[{"twist", " ", 
      RowBox[{"coupling", " ", "[", 
       RowBox[{"Nm", "^", "2"}], "]"}]}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"KBT", " ", "=", " ", 
     RowBox[{"{", 
      RowBox[{
      "K1", ",", " ", "K2", ",", " ", "K3", ",", " ", "K4", ",", " ", "K5"}], 
      "}"}]}], ";"}]}]}]], "Input",
 CellChangeTimes->{{3.654684347523673*^9, 3.654684398983139*^9}, {
   3.654684543469679*^9, 3.654684584784815*^9}, {3.6546849804401093`*^9, 
   3.6546850133483686`*^9}, 3.654685079144248*^9, {3.6546853948601723`*^9, 
   3.654685402156328*^9}, {3.8529703755882783`*^9, 3.8529704585533733`*^9}, {
   3.852970509582361*^9, 3.8529705406412835`*^9}, {3.852970621317469*^9, 
   3.8529707454769707`*^9}, {3.852970816108339*^9, 3.852970864489204*^9}, {
   3.852971014359644*^9, 3.852971019086829*^9}, {3.852971100736109*^9, 
   3.8529711008737364`*^9}, {3.852971722969946*^9, 3.8529717665819263`*^9}, 
   3.853068122273751*^9, {3.853161605773923*^9, 3.853161639093835*^9}, {
   3.8533208183500175`*^9, 3.8533208865682807`*^9}, {3.8533212196096077`*^9, 
   3.853321271496924*^9}},
 CellLabel->"In[12]:=",ExpressionUUID->"23af980d-e0d6-42ee-8ba7-48292dd1140f"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Shape functions", "Subsection",
 CellChangeTimes->{{3.8531481431389*^9, 
  3.853148147717317*^9}},ExpressionUUID->"b4036aa0-d7f2-465c-8793-\
6ed1debf4333"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", "Torison", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"shapeT", " ", "=", " ", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"1", "-", "z"}], ",", " ", "z"}], "}"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"shapeT1", " ", "=", " ", 
     RowBox[{"D", "[", 
      RowBox[{"shapeT", ",", " ", 
       RowBox[{"{", 
        RowBox[{"z", ",", "1"}], "}"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"Plot", "[", 
    RowBox[{"shapeT", ",", " ", 
     RowBox[{"{", 
      RowBox[{"z", ",", "0", ",", "1"}], "}"}], ",", " ", 
     RowBox[{"PlotLegends", "\[Rule]", "\"\<Expressions\>\""}]}], 
    "]"}]}]}]], "Input",
 CellChangeTimes->{{3.8531481588586855`*^9, 3.853148186857016*^9}, {
  3.8531482269634914`*^9, 3.8531482377673087`*^9}, {3.853148277581543*^9, 
  3.853148287163275*^9}},
 CellLabel->"In[20]:=",ExpressionUUID->"6e1a39d7-6ce6-4aa8-bea3-62cfcf4f36db"],

Cell[BoxData[
 TemplateBox[{
   GraphicsBox[{{{{}, {}, 
       TagBox[{
         Directive[
          Opacity[1.], 
          RGBColor[0.368417, 0.506779, 0.709798], 
          AbsoluteThickness[1.6]], 
         LineBox[CompressedData["
1:eJw1lGs0lAkYxwfTydISbZhK0iqSSoii9i/aFLqQVu0qkqKpRKHaU5OxJrqI
NumCmlxaccxoXY4yZZY52uZMkUtD6R2mMcbM8OasabCVffuwH57znN/5P//z
fPvZRx8LPWBIo9G2UPN1Bx5QvRIO7fzhhp2pbmqKBN1/ToKM4YH6TxaiM59J
uN+9WVDN2IDuHptrE5Mkgl5I/yxkhIGRu3jlPzoS4TH6J78zYlBg7HdUqSHx
bkWGfxYjCdzRUwMSKQnu7G3nLzLSUd6s7LrFJ8E2rna8wMiFILapzj2SxK7d
9/gfRkvAVE/T9VWNwHSKHREwnw/zPq+Lc81GsChkRNV8qQZvV8nTMuKHcfLl
Gtwce4SVLTbjR/7SwrrGgjAwaMTZ5+tEMjst6uT+kta1TQidTs6QJGjQxCyc
u1srwvZSm0dDIjV0i9eZVx59Bv86V0GugxqGExUz5y4SQ2jQ5fMoZQieU1F1
O3gSuAljLQ93qiBJ93jZ4tyKF8Tx4K2rVLDL0Uw8GGnDBy8To4rMQWj0MqLL
tR0m9JyZ1weVKFE3iM2udIBnUnR7fLUSZrZ/kApFJ04numRmZQ3g8qHag1yH
1/AOKpXwhxX46FuhiDsnBSeyPCvIV4EkN1GNVXM3WpSFpUl33kPGE116Zf8G
OWW23takHP8yO/OX/PoWaeLZbho/OZaun/7lYEMvmJGfUoOL+hFQZB/70JpA
7/JjwY5jfThpG7mwP0KGDYlt8dkhfXDR7jSVbulDmWPYUEiMDLPMPxiLJvvw
pt9u5KQJAXpjPv/7gn6Ms//m1j/rxWGPhp5vguRwvnEhWHvoLSo2R3OffpSj
/IhPY5rlG+g0c2Yq897Dykksc2/vRu2OAKPcDQrk7UqckKZIcW4T526NUgHD
Yzphnttr2L8L7C7mDODpj8xt9WOd8PZKz2W4KXH5qv61JL8DEfNbJww6lNjU
vG/Gp93t0Imz5AnsQVgxFd7zP7fhJn1vUqiDCtzhjOV18a2YRdQWGYpUqMlw
StaREkw7yw5bkzgErelk5RwfMWgP9vLllmrQIjh+yTXPcPw2P8uySY3Veeuf
1+pFeLI009giXoMZIbJ3DQFNsAg87pJmpsUp/tGCkUuN6F3W1nFaoMWCq6x9
K+c9RtUdOCj2DiPVxIggjGuxh+9pYftlGDacwBRr8yqkcu6xe8tHQCsbHPAK
LUWlyjbfLJhElNqvwIWVh8xCThSxlQRtWzDp7pCHmNDhRbwQEqnVO/18xNcx
TyCo2hJO8Zk41War67iY/UvL5WgSQrMrHrG8a4jzvDVqcprqu/dI7hE5WJj+
3abp96l7PTG5jHUeX1af+VZaRrFwlLtWzEHP8Pv2+xVU/wI9IMiKg5zw6j0b
H1L9ec7X4ni/Yco59ARHQMLXN3lpMZGK3lfZd4w6qNzSut6VlYL68/r9HV0U
l6ylb7VKRq5P5JLiboo9o7cf5p1AUOnyGj+C+vdzpaqUSMDjUy+es4eofGOG
myfrIPKWrcoO0VLMbBcn8PYjUV4QZk9SnG27v4KIglPwEZlwjOKqWMf1rJ9A
N+gsydFTPP45vI7Yjr5aH2YU5R1aqpNFOGsjBMziFa6Ul2gLyhVpLE/87y1K
Ze1fPfYfknBtcA==
          "]]}, Annotation[#, "Charting`Private`Tag$7920#1"]& ], 
       TagBox[{
         Directive[
          Opacity[1.], 
          RGBColor[0.880722, 0.611041, 0.142051], 
          AbsoluteThickness[1.6]], 
         LineBox[CompressedData["
1:eJxFxW0w03EcAPCNdZRrjMr9adxE5SlOUlKpuMhDneHk8nRCWk/InXR1WrdJ
nua6nZTnh5R2jGyuMnHsdDnPo1GzMUtj83RndnRZ9cL39+JzH0r8XWqiHg6H
C/7n/wGJypGu+fAz2xN8LFJkmLv39kcrS8paMV84cED8vhwLgyMStB3PsQR4
yuWpTwGWDlftvZydizFgumHroWcYG74SWc1dWa2DjXT0KD8rLmwXsqTsyePB
GYOe3iVrH2FzHkmKx3fCbXKf/qFT3XA3rdwyUi2ENQdPGzfe/gLrbXBMLO36
YA9dXFtoUz/cz3Af7HUYgq2LVBsNS8OwSiuTjruOwnUL7X3EQhFMJL9ZVijG
4Pwb/KQq22/w+lmOIjlLDKe7CXn7eiZgWZMwb4TyHf5NGyu1f/ADdjxnsJXU
LoH9aijXW8ylcAY51mYmSgY7qcONxMHTsJnxiqFwE03oLOUeKJuBb7q3T+4M
lMOci/FVn9fRGpWFyVzxLMwP9dNn+yrgLH9mJW8OTZkKmKhl/oRPHmewMbc5
OMpqaAMvQmv6CuQp9F9wCSEmnWqrhM2k/Bo9IXrHI3qYZ+o8jGuI4cpNF+C0
V9wC0250h2OOIemOCiYFpDk9IaphifOwKFOAbq7wtlXELMLRXA8SeQv9mFlN
l7xbghuV5FJi0DKcU86Mk15CJ1AX7ZpC0PsFgubgCHQu62pvfjw62ePl6q5M
tA1jj79BPXrrxMPd4rfoycXZ0XoOuiiiNfpCC1rnQL3HFKAlI6wKfRH6Q7b2
mmgczfaKta+dQAe+PsI7L0V/uj/wlT6PLnY+xgpRo1PlZWGUZfThoFuyrjU0
AT9WV6RFT/O9aHGbaAGt1sX1D/qFtZFGp0P/BaO4ekM=
          "]]}, Annotation[#, "Charting`Private`Tag$7920#1"]& ]}}, {}}, {
    DisplayFunction -> Identity, Ticks -> {Automatic, Automatic}, 
     AxesOrigin -> {0, 0}, 
     FrameTicks -> {{Automatic, Automatic}, {Automatic, Automatic}}, 
     GridLines -> {None, None}, DisplayFunction -> Identity, 
     PlotRangePadding -> {{
        Scaled[0.02], 
        Scaled[0.02]}, {
        Scaled[0.05], 
        Scaled[0.05]}}, PlotRangeClipping -> True, ImagePadding -> All, 
     DisplayFunction -> Identity, AspectRatio -> 
     NCache[GoldenRatio^(-1), 0.6180339887498948], Axes -> {True, True}, 
     AxesLabel -> {None, None}, AxesOrigin -> {0, 0}, DisplayFunction :> 
     Identity, Frame -> {{False, False}, {False, False}}, 
     FrameLabel -> {{None, None}, {None, None}}, 
     FrameTicks -> {{Automatic, Automatic}, {Automatic, Automatic}}, 
     GridLines -> {None, None}, GridLinesStyle -> Directive[
       GrayLevel[0.5, 0.4]], 
     Method -> {
      "DefaultBoundaryStyle" -> Automatic, 
       "DefaultGraphicsInteraction" -> {
        "Version" -> 1.2, "TrackMousePosition" -> {True, False}, 
         "Effects" -> {
          "Highlight" -> {"ratio" -> 2}, "HighlightPoint" -> {"ratio" -> 2}, 
           "Droplines" -> {
            "freeformCursorMode" -> True, 
             "placement" -> {"x" -> "All", "y" -> "None"}}}}, 
       "DefaultMeshStyle" -> AbsolutePointSize[6], "ScalingFunctions" -> None,
        "CoordinatesToolOptions" -> {"DisplayFunction" -> ({
           (Identity[#]& )[
            Part[#, 1]], 
           (Identity[#]& )[
            Part[#, 2]]}& ), "CopiedValueFunction" -> ({
           (Identity[#]& )[
            Part[#, 1]], 
           (Identity[#]& )[
            Part[#, 2]]}& )}}, 
     PlotRange -> {{0, 1}, {0., 0.9999999795918367}}, PlotRangeClipping -> 
     True, PlotRangePadding -> {{
        Scaled[0.02], 
        Scaled[0.02]}, {
        Scaled[0.02], 
        Scaled[0.02]}}, Ticks -> {Automatic, Automatic}}], 
   FormBox[
    FormBox[
     TemplateBox[{
       RowBox[{"1", "-", 
         TagBox["z", HoldForm]}], 
       TagBox["z", HoldForm]}, "LineLegend", DisplayFunction -> (FormBox[
        StyleBox[
         StyleBox[
          PaneBox[
           TagBox[
            GridBox[{{
               TagBox[
                GridBox[{{
                   GraphicsBox[{{
                    Directive[
                    EdgeForm[
                    Directive[
                    Opacity[0.3], 
                    GrayLevel[0]]], 
                    PointSize[0.5], 
                    Opacity[1.], 
                    RGBColor[0.368417, 0.506779, 0.709798], 
                    AbsoluteThickness[1.6]], {
                    LineBox[{{0, 10}, {20, 10}}]}}, {
                    Directive[
                    EdgeForm[
                    Directive[
                    Opacity[0.3], 
                    GrayLevel[0]]], 
                    PointSize[0.5], 
                    Opacity[1.], 
                    RGBColor[0.368417, 0.506779, 0.709798], 
                    AbsoluteThickness[1.6]], {}}}, AspectRatio -> Full, 
                    ImageSize -> {20, 10}, PlotRangePadding -> None, 
                    ImagePadding -> Automatic, 
                    BaselinePosition -> (Scaled[0.1] -> Baseline)], #}, {
                   GraphicsBox[{{
                    Directive[
                    EdgeForm[
                    Directive[
                    Opacity[0.3], 
                    GrayLevel[0]]], 
                    PointSize[0.5], 
                    Opacity[1.], 
                    RGBColor[0.880722, 0.611041, 0.142051], 
                    AbsoluteThickness[1.6]], {
                    LineBox[{{0, 10}, {20, 10}}]}}, {
                    Directive[
                    EdgeForm[
                    Directive[
                    Opacity[0.3], 
                    GrayLevel[0]]], 
                    PointSize[0.5], 
                    Opacity[1.], 
                    RGBColor[0.880722, 0.611041, 0.142051], 
                    AbsoluteThickness[1.6]], {}}}, AspectRatio -> Full, 
                    ImageSize -> {20, 10}, PlotRangePadding -> None, 
                    ImagePadding -> Automatic, 
                    BaselinePosition -> (Scaled[0.1] -> Baseline)], #2}}, 
                 GridBoxAlignment -> {
                  "Columns" -> {Center, Left}, "Rows" -> {{Baseline}}}, 
                 AutoDelete -> False, 
                 GridBoxDividers -> {
                  "Columns" -> {{False}}, "Rows" -> {{False}}}, 
                 GridBoxItemSize -> {"Columns" -> {{All}}, "Rows" -> {{All}}},
                  GridBoxSpacings -> {
                  "Columns" -> {{0.5}}, "Rows" -> {{0.8}}}], "Grid"]}}, 
             GridBoxAlignment -> {"Columns" -> {{Left}}, "Rows" -> {{Top}}}, 
             AutoDelete -> False, 
             GridBoxItemSize -> {
              "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
             GridBoxSpacings -> {"Columns" -> {{1}}, "Rows" -> {{0}}}], 
            "Grid"], Alignment -> Left, AppearanceElements -> None, 
           ImageMargins -> {{5, 5}, {5, 5}}, ImageSizeAction -> 
           "ResizeToFit"], LineIndent -> 0, StripOnInput -> False], {
         FontFamily -> "Arial"}, Background -> Automatic, StripOnInput -> 
         False], TraditionalForm]& ), 
      InterpretationFunction :> (RowBox[{"LineLegend", "[", 
         RowBox[{
           RowBox[{"{", 
             RowBox[{
               RowBox[{"Directive", "[", 
                 RowBox[{
                   RowBox[{"Opacity", "[", "1.`", "]"}], ",", 
                   
                   TemplateBox[<|
                    "color" -> RGBColor[0.368417, 0.506779, 0.709798]|>, 
                    "RGBColorSwatchTemplate"], ",", 
                   RowBox[{"AbsoluteThickness", "[", "1.6`", "]"}]}], "]"}], 
               ",", 
               RowBox[{"Directive", "[", 
                 RowBox[{
                   RowBox[{"Opacity", "[", "1.`", "]"}], ",", 
                   
                   TemplateBox[<|
                    "color" -> RGBColor[0.880722, 0.611041, 0.142051]|>, 
                    "RGBColorSwatchTemplate"], ",", 
                   RowBox[{"AbsoluteThickness", "[", "1.6`", "]"}]}], "]"}]}],
              "}"}], ",", 
           RowBox[{"{", 
             RowBox[{
               TagBox[#, HoldForm], ",", 
               TagBox[#2, HoldForm]}], "}"}], ",", 
           RowBox[{"LegendMarkers", "\[Rule]", "None"}], ",", 
           RowBox[{"LabelStyle", "\[Rule]", 
             RowBox[{"{", "}"}]}], ",", 
           RowBox[{"LegendLayout", "\[Rule]", "\"Column\""}]}], "]"}]& ), 
      Editable -> True], TraditionalForm], TraditionalForm]},
  "Legended",
  DisplayFunction->(GridBox[{{
      TagBox[
       ItemBox[
        PaneBox[
         TagBox[#, "SkipImageSizeLevel"], Alignment -> {Center, Baseline}, 
         BaselinePosition -> Baseline], DefaultBaseStyle -> "Labeled"], 
       "SkipImageSizeLevel"], 
      ItemBox[#2, DefaultBaseStyle -> "LabeledLabel"]}}, 
    GridBoxAlignment -> {"Columns" -> {{Center}}, "Rows" -> {{Center}}}, 
    AutoDelete -> False, GridBoxItemSize -> Automatic, 
    BaselinePosition -> {1, 1}]& ),
  Editable->True,
  InterpretationFunction->(RowBox[{"Legended", "[", 
     RowBox[{#, ",", 
       RowBox[{"Placed", "[", 
         RowBox[{#2, ",", "After"}], "]"}]}], "]"}]& )]], "Output",
 CellChangeTimes->{
  3.853148304796238*^9, 3.8533207549606857`*^9, 3.8533804896893024`*^9, 
   3.853500787349447*^9, 3.853558972826882*^9, 3.8540887255502253`*^9, 
   3.854090134294422*^9, 3.855221401143709*^9, {3.8552995745037265`*^9, 
   3.8552995831185427`*^9}},
 CellLabel->"Out[22]=",ExpressionUUID->"c467dd42-9058-4a1f-812a-7d05d54e60e8"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", "Bending", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"shapeB", " ", "=", " ", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"2", "*", 
         SuperscriptBox["z", "3"]}], "-", 
        RowBox[{"3", "*", 
         SuperscriptBox["z", "2"]}], "+", "1"}], ",", " ", 
       RowBox[{
        SuperscriptBox["z", "3"], "-", 
        RowBox[{"2", "*", 
         SuperscriptBox["z", "2"]}], "+", "z"}], ",", " ", 
       RowBox[{
        RowBox[{"3", "*", 
         SuperscriptBox["z", "2"]}], "-", 
        RowBox[{"2", "*", 
         SuperscriptBox["z", "3"]}]}], ",", " ", 
       RowBox[{
        SuperscriptBox["z", "3"], "-", 
        SuperscriptBox["z", "2"]}]}], "}"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"shapeB1", " ", "=", " ", 
     RowBox[{"D", "[", 
      RowBox[{"shapeB", ",", " ", 
       RowBox[{"{", 
        RowBox[{"z", ",", "1"}], "}"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"shapeB2", " ", "=", " ", 
     RowBox[{"D", "[", 
      RowBox[{"shapeB", ",", " ", 
       RowBox[{"{", 
        RowBox[{"z", ",", "2"}], "}"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"Plot", "[", 
    RowBox[{"shapeB", ",", " ", 
     RowBox[{"{", 
      RowBox[{"z", ",", "0", ",", "1"}], "}"}], ",", " ", 
     RowBox[{"PlotLegends", "\[Rule]", "\"\<Expressions\>\""}]}], 
    "]"}]}]}]], "Input",
 CellChangeTimes->{
  3.8531483026880164`*^9, {3.853157347978726*^9, 3.8531573495670366`*^9}},
 CellLabel->"In[23]:=",ExpressionUUID->"d50e50f0-292c-4d63-a0bf-9a08d6700752"],

Cell[BoxData[
 TemplateBox[{
   GraphicsBox[{{{{}, {}, 
       TagBox[{
         Directive[
          Opacity[1.], 
          RGBColor[0.368417, 0.506779, 0.709798], 
          AbsoluteThickness[1.6]], 
         LineBox[CompressedData["
1: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
wPmC
          "]]}, Annotation[#, "Charting`Private`Tag$8018#1"]& ], 
       TagBox[{
         Directive[
          Opacity[1.], 
          RGBColor[0.880722, 0.611041, 0.142051], 
          AbsoluteThickness[1.6]], 
         LineBox[CompressedData["
1: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
4Z1UfweTzUasefkjP+JLn/3pmg1slKoNbnxOLCr3fKi9nQ2lLTo/xoj19wc3
tfWwcczscZzMTwqe4UfKWwfZyPZkpW8m5gpIP/82wcbneaqyF4iFt4xGtEyz
IX+JdiqCeLNXTVDzHA5KJRVWpxLHdobafxXhwCQ78XsLcY2Ci2mjBAeMyuLm
n8RzDmzb3CDFQfmSZ8YLxyho35NTrZflQFciZrkcsWv55J91KzhgG4nYaxJH
CXLn8lZx4LXJQoROXLb13QhHjYNu9+K/TIl/e99uYWtxMONckWZLrJnmVsnS
5uCfZ/nPnYiP9hjlMjdxYPtuWuQU8T2llcm1dA62irV/8yIuPDQbWWPAgbB+
zcpLxGMRjVerTTgILVXg+hOrVmV5VplxEK6xdiKI+KBQxNFKSw4Gh+xvXCW+
pe9hXmHDgXfkgjC+P/ma6pXbcTCaEEYLJh5+p6pW5kC+99ikg/8+pX5B6S+u
HMjPjdrC/571qu/zSk9y4GZXP/c8cYj9xx/FHhwMq7vR+e3NfvDwe9F5DoJ+
Pu/j96e35nx14UXyfb3hRQeIly+0/PjZn7Q/JD6OPx5mBpovqascxFpLPeeP
1xW/hQ8Z/3AQqJGqpEWcltEZUnCbg+C7pZLyxK2DlFf+fQ48hQp8FhEvUY1z
/BTFwQrJH3vHyXwZOVyy+BjDgb1O/pPvxBeibeh5Tzn4NRp4rIz4q4j4spxX
HETZOux/QCxq1C/04S0HmwU3BVwi1vcv/ZmVyYHfocuK9sSJIwG1GQUcqC2n
yuX560vtcH56EZn/sMuc36P8/LDp9fsyDv76IGtbT+zOHQl9y+Zg3ML7Sxhx
rFiVd1o9Bz6FA9kuxDUmKc6pzWQ853xS0iPWznXUf91N2t/X7NpO9sfvONb4
i98clDXb5SoRa9andjwX4MJUlHN9kOy/o5K3WEnzubiocq82m7jwqmFqojgX
Uiv2NpsQ3zqR4RqvzIVKwvKu/WR/9+q/Dl2kxoXiSp6KBLGx9LMUby0utH4t
S/hC8sOckohB081caIzJWukQ+yp7eU/u4YLeKxY7Pkj6++tklPM+Lo5PK1Yn
EGuznHKqD3IxOuCjb048HGg188yFi8bkio4Ykq9cW9aHWF7iwv+IiokqyW+F
mWovPgZwYbXWObS4j6yn20plqiFcNDjFizgRN+lJis7e4eK5zkhrZC9ZX9Ej
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
NLUVzpYDq97sJV4x0Ku1aCuW5+WlmdkQW6x0kd+4BTfCDxXfciTWN2IHf9oA
V8PPN+1c+O0/d9itRxfbJ9X2ahzn+7HXImldTDpONZafIhbP8wkM0MZx3Ycj
C32JX6hNH7iyDoZ9tKyGS8TxmkrrS9ZCIf64X8oVYuk2tcrFa8FdsFFo11V+
+84ox3uswY4m7vJ/wvntWfzF9LAqVtyjt9reIw5YkuSi/hd+GyU9V/2XeO23
n0sEVJCedn59aTR/PG4a4PNKKF1dYiKUxB+/nc2TOxQws9HvD94Lfn2Ol5Cd
HOoH2phJL/nt+WLsFCiLOzbvDxu95ffXylxqaincRWRXSqXz42N4582kYMII
6u7I5L/vg4l22hLMqlmeu5bHr18Z1pwggYaWDxv35fPjL2UxtcWRGaE4o0zx
31fa7Z7yB07PDIcWlvDrxyXlhApj13tb84gyvkUj96rMx6rjBYudK/nxRXN6
Wufia2147FwWv5zad95zlp4dMu7E4vDff3jloqRf9IgtR1Yn1PGt9bB96QTd
Y7h40LORH5/gKFk6St/9TDN9ezO/XEH9WeYIXeVgpK/kd365ot6hkgH6HLEZ
emsb33mVF2K76c2fXQTfdfLd7lD4Xxs950Lll8Aevrmxn0Jb6JFrdML39vNt
2sBRqaOfbX1srTjEd8VKiYJauukDwWUjI3zTLF2TS+mqpu4tBaN8r7Cfup9P
FxRgJ94Z53ujV13hW/q3jC1uR6f4Pnqu+GEcPc8tQWvt9P/r9wrH+NMfKCz6
OTv7f5Nfgd7/ALBO6XQ=
          "]]}, Annotation[#, "Charting`Private`Tag$8018#1"]& ], 
       TagBox[{
         Directive[
          Opacity[1.], 
          RGBColor[0.560181, 0.691569, 0.194885], 
          AbsoluteThickness[1.6]], 
         LineBox[CompressedData["
1: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
rZ7+M84s/XkI/g9IADTq
          "]]}, Annotation[#, "Charting`Private`Tag$8018#1"]& ], 
       TagBox[{
         Directive[
          Opacity[1.], 
          RGBColor[0.922526, 0.385626, 0.209179], 
          AbsoluteThickness[1.6]], 
         LineBox[CompressedData["
1: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
irg=
          "]]}, Annotation[#, "Charting`Private`Tag$8018#1"]& ]}}, {}}, {
    DisplayFunction -> Identity, Ticks -> {Automatic, Automatic}, 
     AxesOrigin -> {0, 0}, 
     FrameTicks -> {{Automatic, Automatic}, {Automatic, Automatic}}, 
     GridLines -> {None, None}, DisplayFunction -> Identity, 
     PlotRangePadding -> {{
        Scaled[0.02], 
        Scaled[0.02]}, {
        Scaled[0.05], 
        Scaled[0.05]}}, PlotRangeClipping -> True, ImagePadding -> All, 
     DisplayFunction -> Identity, AspectRatio -> 
     NCache[GoldenRatio^(-1), 0.6180339887498948], Axes -> {True, True}, 
     AxesLabel -> {None, None}, AxesOrigin -> {0, 0}, DisplayFunction :> 
     Identity, Frame -> {{False, False}, {False, False}}, 
     FrameLabel -> {{None, None}, {None, None}}, 
     FrameTicks -> {{Automatic, Automatic}, {Automatic, Automatic}}, 
     GridLines -> {None, None}, GridLinesStyle -> Directive[
       GrayLevel[0.5, 0.4]], 
     Method -> {
      "DefaultBoundaryStyle" -> Automatic, 
       "DefaultGraphicsInteraction" -> {
        "Version" -> 1.2, "TrackMousePosition" -> {True, False}, 
         "Effects" -> {
          "Highlight" -> {"ratio" -> 2}, "HighlightPoint" -> {"ratio" -> 2}, 
           "Droplines" -> {
            "freeformCursorMode" -> True, 
             "placement" -> {"x" -> "All", "y" -> "None"}}}}, 
       "DefaultMeshStyle" -> AbsolutePointSize[6], "ScalingFunctions" -> None,
        "CoordinatesToolOptions" -> {"DisplayFunction" -> ({
           (Identity[#]& )[
            Part[#, 1]], 
           (Identity[#]& )[
            Part[#, 2]]}& ), "CopiedValueFunction" -> ({
           (Identity[#]& )[
            Part[#, 1]], 
           (Identity[#]& )[
            Part[#, 2]]}& )}}, 
     PlotRange -> {{0, 1}, {-0.1481481293526843, 0.9999999999999989}}, 
     PlotRangeClipping -> True, PlotRangePadding -> {{
        Scaled[0.02], 
        Scaled[0.02]}, {
        Scaled[0.02], 
        Scaled[0.02]}}, Ticks -> {Automatic, Automatic}}], 
   FormBox[
    FormBox[
     TemplateBox[{
       RowBox[{"1", "-", 
         RowBox[{"3", " ", 
           SuperscriptBox[
            TagBox["z", HoldForm], "2"]}], "+", 
         RowBox[{"2", " ", 
           SuperscriptBox[
            TagBox["z", HoldForm], "3"]}]}], 
       RowBox[{
         TagBox["z", HoldForm], "-", 
         RowBox[{"2", " ", 
           SuperscriptBox[
            TagBox["z", HoldForm], "2"]}], "+", 
         SuperscriptBox[
          TagBox["z", HoldForm], "3"]}], 
       RowBox[{
         RowBox[{"3", " ", 
           SuperscriptBox[
            TagBox["z", HoldForm], "2"]}], "-", 
         RowBox[{"2", " ", 
           SuperscriptBox[
            TagBox["z", HoldForm], "3"]}]}], 
       RowBox[{
         RowBox[{"-", 
           SuperscriptBox[
            TagBox["z", HoldForm], "2"]}], "+", 
         SuperscriptBox[
          TagBox["z", HoldForm], "3"]}]}, "LineLegend", 
      DisplayFunction -> (FormBox[
        StyleBox[
         StyleBox[
          PaneBox[
           TagBox[
            GridBox[{{
               TagBox[
                GridBox[{{
                   GraphicsBox[{{
                    Directive[
                    EdgeForm[
                    Directive[
                    Opacity[0.3], 
                    GrayLevel[0]]], 
                    PointSize[0.5], 
                    Opacity[1.], 
                    RGBColor[0.368417, 0.506779, 0.709798], 
                    AbsoluteThickness[1.6]], {
                    LineBox[{{0, 10}, {20, 10}}]}}, {
                    Directive[
                    EdgeForm[
                    Directive[
                    Opacity[0.3], 
                    GrayLevel[0]]], 
                    PointSize[0.5], 
                    Opacity[1.], 
                    RGBColor[0.368417, 0.506779, 0.709798], 
                    AbsoluteThickness[1.6]], {}}}, AspectRatio -> Full, 
                    ImageSize -> {20, 10}, PlotRangePadding -> None, 
                    ImagePadding -> Automatic, 
                    BaselinePosition -> (Scaled[0.1] -> Baseline)], #}, {
                   GraphicsBox[{{
                    Directive[
                    EdgeForm[
                    Directive[
                    Opacity[0.3], 
                    GrayLevel[0]]], 
                    PointSize[0.5], 
                    Opacity[1.], 
                    RGBColor[0.880722, 0.611041, 0.142051], 
                    AbsoluteThickness[1.6]], {
                    LineBox[{{0, 10}, {20, 10}}]}}, {
                    Directive[
                    EdgeForm[
                    Directive[
                    Opacity[0.3], 
                    GrayLevel[0]]], 
                    PointSize[0.5], 
                    Opacity[1.], 
                    RGBColor[0.880722, 0.611041, 0.142051], 
                    AbsoluteThickness[1.6]], {}}}, AspectRatio -> Full, 
                    ImageSize -> {20, 10}, PlotRangePadding -> None, 
                    ImagePadding -> Automatic, 
                    BaselinePosition -> (Scaled[0.1] -> Baseline)], #2}, {
                   GraphicsBox[{{
                    Directive[
                    EdgeForm[
                    Directive[
                    Opacity[0.3], 
                    GrayLevel[0]]], 
                    PointSize[0.5], 
                    Opacity[1.], 
                    RGBColor[0.560181, 0.691569, 0.194885], 
                    AbsoluteThickness[1.6]], {
                    LineBox[{{0, 10}, {20, 10}}]}}, {
                    Directive[
                    EdgeForm[
                    Directive[
                    Opacity[0.3], 
                    GrayLevel[0]]], 
                    PointSize[0.5], 
                    Opacity[1.], 
                    RGBColor[0.560181, 0.691569, 0.194885], 
                    AbsoluteThickness[1.6]], {}}}, AspectRatio -> Full, 
                    ImageSize -> {20, 10}, PlotRangePadding -> None, 
                    ImagePadding -> Automatic, 
                    BaselinePosition -> (Scaled[0.1] -> Baseline)], #3}, {
                   GraphicsBox[{{
                    Directive[
                    EdgeForm[
                    Directive[
                    Opacity[0.3], 
                    GrayLevel[0]]], 
                    PointSize[0.5], 
                    Opacity[1.], 
                    RGBColor[0.922526, 0.385626, 0.209179], 
                    AbsoluteThickness[1.6]], {
                    LineBox[{{0, 10}, {20, 10}}]}}, {
                    Directive[
                    EdgeForm[
                    Directive[
                    Opacity[0.3], 
                    GrayLevel[0]]], 
                    PointSize[0.5], 
                    Opacity[1.], 
                    RGBColor[0.922526, 0.385626, 0.209179], 
                    AbsoluteThickness[1.6]], {}}}, AspectRatio -> Full, 
                    ImageSize -> {20, 10}, PlotRangePadding -> None, 
                    ImagePadding -> Automatic, 
                    BaselinePosition -> (Scaled[0.1] -> Baseline)], #4}}, 
                 GridBoxAlignment -> {
                  "Columns" -> {Center, Left}, "Rows" -> {{Baseline}}}, 
                 AutoDelete -> False, 
                 GridBoxDividers -> {
                  "Columns" -> {{False}}, "Rows" -> {{False}}}, 
                 GridBoxItemSize -> {"Columns" -> {{All}}, "Rows" -> {{All}}},
                  GridBoxSpacings -> {
                  "Columns" -> {{0.5}}, "Rows" -> {{0.8}}}], "Grid"]}}, 
             GridBoxAlignment -> {"Columns" -> {{Left}}, "Rows" -> {{Top}}}, 
             AutoDelete -> False, 
             GridBoxItemSize -> {
              "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
             GridBoxSpacings -> {"Columns" -> {{1}}, "Rows" -> {{0}}}], 
            "Grid"], Alignment -> Left, AppearanceElements -> None, 
           ImageMargins -> {{5, 5}, {5, 5}}, ImageSizeAction -> 
           "ResizeToFit"], LineIndent -> 0, StripOnInput -> False], {
         FontFamily -> "Arial"}, Background -> Automatic, StripOnInput -> 
         False], TraditionalForm]& ), 
      InterpretationFunction :> (RowBox[{"LineLegend", "[", 
         RowBox[{
           RowBox[{"{", 
             RowBox[{
               RowBox[{"Directive", "[", 
                 RowBox[{
                   RowBox[{"Opacity", "[", "1.`", "]"}], ",", 
                   
                   TemplateBox[<|
                    "color" -> RGBColor[0.368417, 0.506779, 0.709798]|>, 
                    "RGBColorSwatchTemplate"], ",", 
                   RowBox[{"AbsoluteThickness", "[", "1.6`", "]"}]}], "]"}], 
               ",", 
               RowBox[{"Directive", "[", 
                 RowBox[{
                   RowBox[{"Opacity", "[", "1.`", "]"}], ",", 
                   
                   TemplateBox[<|
                    "color" -> RGBColor[0.880722, 0.611041, 0.142051]|>, 
                    "RGBColorSwatchTemplate"], ",", 
                   RowBox[{"AbsoluteThickness", "[", "1.6`", "]"}]}], "]"}], 
               ",", 
               RowBox[{"Directive", "[", 
                 RowBox[{
                   RowBox[{"Opacity", "[", "1.`", "]"}], ",", 
                   
                   TemplateBox[<|
                    "color" -> RGBColor[0.560181, 0.691569, 0.194885]|>, 
                    "RGBColorSwatchTemplate"], ",", 
                   RowBox[{"AbsoluteThickness", "[", "1.6`", "]"}]}], "]"}], 
               ",", 
               RowBox[{"Directive", "[", 
                 RowBox[{
                   RowBox[{"Opacity", "[", "1.`", "]"}], ",", 
                   
                   TemplateBox[<|
                    "color" -> RGBColor[0.922526, 0.385626, 0.209179]|>, 
                    "RGBColorSwatchTemplate"], ",", 
                   RowBox[{"AbsoluteThickness", "[", "1.6`", "]"}]}], "]"}]}],
              "}"}], ",", 
           RowBox[{"{", 
             RowBox[{
               TagBox[#, HoldForm], ",", 
               TagBox[#2, HoldForm], ",", 
               TagBox[#3, HoldForm], ",", 
               TagBox[#4, HoldForm]}], "}"}], ",", 
           RowBox[{"LegendMarkers", "\[Rule]", "None"}], ",", 
           RowBox[{"LabelStyle", "\[Rule]", 
             RowBox[{"{", "}"}]}], ",", 
           RowBox[{"LegendLayout", "\[Rule]", "\"Column\""}]}], "]"}]& ), 
      Editable -> True], TraditionalForm], TraditionalForm]},
  "Legended",
  DisplayFunction->(GridBox[{{
      TagBox[
       ItemBox[
        PaneBox[
         TagBox[#, "SkipImageSizeLevel"], Alignment -> {Center, Baseline}, 
         BaselinePosition -> Baseline], DefaultBaseStyle -> "Labeled"], 
       "SkipImageSizeLevel"], 
      ItemBox[#2, DefaultBaseStyle -> "LabeledLabel"]}}, 
    GridBoxAlignment -> {"Columns" -> {{Center}}, "Rows" -> {{Center}}}, 
    AutoDelete -> False, GridBoxItemSize -> Automatic, 
    BaselinePosition -> {1, 1}]& ),
  Editable->True,
  InterpretationFunction->(RowBox[{"Legended", "[", 
     RowBox[{#, ",", 
       RowBox[{"Placed", "[", 
         RowBox[{#2, ",", "After"}], "]"}]}], "]"}]& )]], "Output",
 CellChangeTimes->{3.853148307352831*^9, 3.8533207574875517`*^9, 
  3.8533804940499043`*^9, 3.8535007902517724`*^9, 3.853558972888235*^9, 
  3.8540887295544987`*^9, 3.8540901369052315`*^9, 3.855221401206263*^9, 
  3.8552995831734357`*^9},
 CellLabel->"Out[26]=",ExpressionUUID->"8b3a849d-a453-493e-8197-352bdc890b90"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"Combined", " ", "shape", " ", 
    RowBox[{"functions", ":"}]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"psi", " ", "=", " ", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"shapeT", "[", 
        RowBox[{"[", "1", "]"}], "]"}], ",", " ", 
       RowBox[{"shapeB", "[", 
        RowBox[{"[", "1", "]"}], "]"}], ",", " ", 
       RowBox[{"shapeB", "[", 
        RowBox[{"[", "2", "]"}], "]"}], ",", " ", 
       RowBox[{"shapeT", "[", 
        RowBox[{"[", "2", "]"}], "]"}], ",", " ", 
       RowBox[{"shapeB", "[", 
        RowBox[{"[", "3", "]"}], "]"}], ",", " ", 
       RowBox[{"shapeB", "[", 
        RowBox[{"[", "4", "]"}], "]"}]}], "}"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"psi1", " ", "=", " ", 
     RowBox[{"D", "[", 
      RowBox[{"psi", ",", " ", 
       RowBox[{"{", 
        RowBox[{"z", ",", "1"}], "}"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"psi2", " ", "=", " ", 
     RowBox[{"D", "[", 
      RowBox[{"psi", ",", " ", 
       RowBox[{"{", 
        RowBox[{"z", ",", "2"}], "}"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"Selection", " ", 
     RowBox[{"matricies", ":"}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"Torsion", " ", "DOFs"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"ATh", " ", "=", " ", 
     RowBox[{"ConstantArray", "[", 
      RowBox[{"0", ",", 
       RowBox[{"{", 
        RowBox[{"6", ",", "6"}], "}"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"ATh", "[", 
      RowBox[{"[", 
       RowBox[{"1", ",", "1"}], "]"}], "]"}], " ", "=", " ", "1"}], ";", " ", 
    RowBox[{
     RowBox[{"ATh", "[", 
      RowBox[{"[", 
       RowBox[{"4", ",", "4"}], "]"}], "]"}], "=", "1"}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"Bending", " ", "DOFs"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Av", " ", "=", " ", 
     RowBox[{"ConstantArray", "[", 
      RowBox[{"0", ",", 
       RowBox[{"{", 
        RowBox[{"6", ",", "6"}], "}"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"Av", "[", 
      RowBox[{"[", 
       RowBox[{"2", ",", "2"}], "]"}], "]"}], " ", "=", " ", "1"}], ";", " ", 
    RowBox[{
     RowBox[{"Av", "[", 
      RowBox[{"[", 
       RowBox[{"3", ",", "3"}], "]"}], "]"}], "=", "1"}], ";", 
    RowBox[{
     RowBox[{"Av", "[", 
      RowBox[{"[", 
       RowBox[{"5", ",", "5"}], "]"}], "]"}], " ", "=", " ", "1"}], ";", " ", 
    RowBox[{
     RowBox[{"Av", "[", 
      RowBox[{"[", 
       RowBox[{"6", ",", "6"}], "]"}], "]"}], "=", "1"}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", "Torque", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"ATR", " ", "=", " ", 
     RowBox[{"ConstantArray", "[", 
      RowBox[{"0", ",", 
       RowBox[{"{", 
        RowBox[{"6", ",", "6"}], "}"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"ATR", "[", 
      RowBox[{"[", 
       RowBox[{"1", ",", "1"}], "]"}], "]"}], " ", "=", " ", "1"}], ";", " ", 
    RowBox[{
     RowBox[{"ATR", "[", 
      RowBox[{"[", 
       RowBox[{"4", ",", "4"}], "]"}], "]"}], "=", "1"}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"Shear", " ", "force"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"ABV", " ", "=", " ", 
     RowBox[{"ConstantArray", "[", 
      RowBox[{"0", ",", 
       RowBox[{"{", 
        RowBox[{"6", ",", "6"}], "}"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"ABV", "[", 
      RowBox[{"[", 
       RowBox[{"1", ",", "2"}], "]"}], "]"}], " ", "=", " ", "1"}], ";", " ", 
    RowBox[{
     RowBox[{"ABV", "[", 
      RowBox[{"[", 
       RowBox[{"4", ",", "5"}], "]"}], "]"}], "=", "1"}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"Bending", " ", "moment"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"ABM", " ", "=", " ", 
     RowBox[{"ConstantArray", "[", 
      RowBox[{"0", ",", 
       RowBox[{"{", 
        RowBox[{"6", ",", "6"}], "}"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"ABM", "[", 
      RowBox[{"[", 
       RowBox[{"1", ",", "3"}], "]"}], "]"}], " ", "=", " ", "1"}], ";", " ", 
    RowBox[{
     RowBox[{"ABM", "[", 
      RowBox[{"[", 
       RowBox[{"4", ",", "6"}], "]"}], "]"}], "=", "1"}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"ATh", "//", "MatrixForm"}], "\[IndentingNewLine]", 
   RowBox[{"Av", "//", "MatrixForm"}], "\[IndentingNewLine]", 
   RowBox[{"ATR", "//", "MatrixForm"}], "\[IndentingNewLine]", 
   RowBox[{"ABV", " ", "//", "MatrixForm"}], "\[IndentingNewLine]", 
   RowBox[{"ABM", " ", "//", "MatrixForm"}]}]}]], "Input",
 CellChangeTimes->{{3.853156972891651*^9, 3.8531572575698614`*^9}, {
  3.8531572900683355`*^9, 3.853157314879219*^9}, {3.853157404607191*^9, 
  3.8531574082519207`*^9}, {3.8531574601465325`*^9, 3.8531574623870287`*^9}, {
  3.8531577345671005`*^9, 3.8531577633671956`*^9}, {3.8533816739652386`*^9, 
  3.853381737364724*^9}, {3.8533817892998676`*^9, 3.8533817970433636`*^9}, {
  3.853382167519112*^9, 3.8533822261236725`*^9}, {3.8533823682233906`*^9, 
  3.853382386350996*^9}, {3.8533845840710926`*^9, 3.853384590192906*^9}, {
  3.8540901709216347`*^9, 3.854090172921863*^9}},
 CellLabel->"In[27]:=",ExpressionUUID->"339f4d75-43ba-4300-a97b-d66156332e4f"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"1", "0", "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0"},
     {"0", "0", "0", "1", "0", "0"},
     {"0", "0", "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0"}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{{3.853157747228814*^9, 3.8531577641974993`*^9}, 
   3.85332076138986*^9, 3.853380499847399*^9, 3.8533822273187714`*^9, 
   3.853382386990281*^9, 3.853500982815776*^9, 3.853558972920206*^9, 
   3.8540887702637*^9, 3.8540901401609263`*^9, 3.8540901801719933`*^9, 
   3.855221401237454*^9, 3.855299583193824*^9},
 CellLabel->
  "Out[40]//MatrixForm=",ExpressionUUID->"802b7156-f5c7-4343-bb6c-\
63d85874f1da"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"0", "0", "0", "0", "0", "0"},
     {"0", "1", "0", "0", "0", "0"},
     {"0", "0", "1", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0"},
     {"0", "0", "0", "0", "1", "0"},
     {"0", "0", "0", "0", "0", "1"}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{{3.853157747228814*^9, 3.8531577641974993`*^9}, 
   3.85332076138986*^9, 3.853380499847399*^9, 3.8533822273187714`*^9, 
   3.853382386990281*^9, 3.853500982815776*^9, 3.853558972920206*^9, 
   3.8540887702637*^9, 3.8540901401609263`*^9, 3.8540901801719933`*^9, 
   3.855221401237454*^9, 3.8552995832034464`*^9},
 CellLabel->
  "Out[41]//MatrixForm=",ExpressionUUID->"7917c94a-8b82-4b3c-9e8d-\
be765f0d447a"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"1", "0", "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0"},
     {"0", "0", "0", "1", "0", "0"},
     {"0", "0", "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0"}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{{3.853157747228814*^9, 3.8531577641974993`*^9}, 
   3.85332076138986*^9, 3.853380499847399*^9, 3.8533822273187714`*^9, 
   3.853382386990281*^9, 3.853500982815776*^9, 3.853558972920206*^9, 
   3.8540887702637*^9, 3.8540901401609263`*^9, 3.8540901801719933`*^9, 
   3.855221401237454*^9, 3.8552995832034464`*^9},
 CellLabel->
  "Out[42]//MatrixForm=",ExpressionUUID->"46f2fb13-8343-41ad-b98f-\
f0050fc59291"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"0", "1", "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0"},
     {"0", "0", "0", "0", "1", "0"},
     {"0", "0", "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0"}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{{3.853157747228814*^9, 3.8531577641974993`*^9}, 
   3.85332076138986*^9, 3.853380499847399*^9, 3.8533822273187714`*^9, 
   3.853382386990281*^9, 3.853500982815776*^9, 3.853558972920206*^9, 
   3.8540887702637*^9, 3.8540901401609263`*^9, 3.8540901801719933`*^9, 
   3.855221401237454*^9, 3.8552995832034464`*^9},
 CellLabel->
  "Out[43]//MatrixForm=",ExpressionUUID->"dee7a291-0a92-4b89-b737-\
f27263460fc3"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"0", "0", "1", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "1"},
     {"0", "0", "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0"}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{{3.853157747228814*^9, 3.8531577641974993`*^9}, 
   3.85332076138986*^9, 3.853380499847399*^9, 3.8533822273187714`*^9, 
   3.853382386990281*^9, 3.853500982815776*^9, 3.853558972920206*^9, 
   3.8540887702637*^9, 3.8540901401609263`*^9, 3.8540901801719933`*^9, 
   3.855221401237454*^9, 3.8552995832135563`*^9},
 CellLabel->
  "Out[44]//MatrixForm=",ExpressionUUID->"bcd976db-dbd7-4650-bd1c-\
957e2f6e17b8"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Dimensional Scaling Matrices", "Subsection",
 CellChangeTimes->{{3.8531573680389166`*^9, 
  3.8531573868668723`*^9}},ExpressionUUID->"580bb3c2-cabf-4e7d-a618-\
f84a7faa82da"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
   "Dimensional", " ", "scaling", " ", "required", " ", "to", " ", "match", 
    " ", "dimensions", " ", "of", " ", "the", " ", "v", " ", "and", " ", 
    "beta", " ", "DOFs"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"S1", " ", "=", " ", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"1", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0"}], 
          "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "1", ",", "0", ",", "0", ",", "0", ",", "0"}], 
          "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", " ", 
           RowBox[{"L", "[", 
            RowBox[{"[", "i", "]"}], "]"}], ",", "0", ",", "0", ",", "0"}], 
          "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "0", ",", "1", ",", "0", ",", "0"}], 
          "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", "1", ",", "0"}], 
          "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", "0", ",", " ", 
           RowBox[{"L", "[", 
            RowBox[{"[", "i", "]"}], "]"}]}], "}"}]}], "}"}], ",", " ", 
       RowBox[{"{", 
        RowBox[{"i", ",", "n"}], "}"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"S2", " ", "=", " ", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"1", "/", 
            RowBox[{"L", "[", 
             RowBox[{"[", "i", "]"}], "]"}]}], ",", "0", ",", "0", ",", "0", 
           ",", "0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", 
           RowBox[{"1", "/", 
            RowBox[{"L", "[", 
             RowBox[{"[", "i", "]"}], "]"}]}], ",", "0", ",", "0", ",", "0", 
           ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
          "0", ",", "0", ",", " ", "1", ",", "0", ",", "0", ",", "0"}], "}"}],
          ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "0", ",", 
           RowBox[{"1", "/", 
            RowBox[{"L", "[", 
             RowBox[{"[", "i", "]"}], "]"}]}], ",", "0", ",", "0"}], "}"}], 
         ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", 
           RowBox[{"1", "/", 
            RowBox[{"L", "[", 
             RowBox[{"[", "i", "]"}], "]"}]}], ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
          "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", " ", "1"}], 
          "}"}]}], "}"}], ",", " ", 
       RowBox[{"{", 
        RowBox[{"i", ",", "n"}], "}"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"S1", "[", 
     RowBox[{"[", "1", "]"}], "]"}], "//", "MatrixForm"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"S2", "[", 
     RowBox[{"[", "1", "]"}], "]"}], "//", "MatrixForm"}]}]}]], "Input",
 CellChangeTimes->{{3.853157491824944*^9, 3.853157515680941*^9}, {
  3.853157554691196*^9, 3.8531577233286486`*^9}, {3.8552215921148486`*^9, 
  3.855221606627412*^9}},
 CellLabel->"In[45]:=",ExpressionUUID->"6384b430-3ba7-4ed4-941b-d21af3e7b078"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"1", "0", "0", "0", "0", "0"},
     {"0", "1", "0", "0", "0", "0"},
     {"0", "0", "L1", "0", "0", "0"},
     {"0", "0", "0", "1", "0", "0"},
     {"0", "0", "0", "0", "1", "0"},
     {"0", "0", "0", "0", "0", "L1"}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{{3.8531577056083727`*^9, 3.8531577238493586`*^9}, 
   3.853320766386752*^9, 3.8533826645688677`*^9, 3.8535009943688035`*^9, 
   3.853558972944278*^9, 3.854089802931019*^9, 3.8540901436696825`*^9, 
   3.855221401259584*^9, 3.855221609229591*^9, 3.85529958322357*^9},
 CellLabel->
  "Out[47]//MatrixForm=",ExpressionUUID->"b5a75fb1-559d-4be6-b684-\
52c1eb5fc331"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      FractionBox["1", "L1"], "0", "0", "0", "0", "0"},
     {"0", 
      FractionBox["1", "L1"], "0", "0", "0", "0"},
     {"0", "0", "1", "0", "0", "0"},
     {"0", "0", "0", 
      FractionBox["1", "L1"], "0", "0"},
     {"0", "0", "0", "0", 
      FractionBox["1", "L1"], "0"},
     {"0", "0", "0", "0", "0", "1"}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{{3.8531577056083727`*^9, 3.8531577238493586`*^9}, 
   3.853320766386752*^9, 3.8533826645688677`*^9, 3.8535009943688035`*^9, 
   3.853558972944278*^9, 3.854089802931019*^9, 3.8540901436696825`*^9, 
   3.855221401259584*^9, 3.855221609229591*^9, 3.85529958322357*^9},
 CellLabel->
  "Out[48]//MatrixForm=",ExpressionUUID->"b7a42f58-7a1d-4e0d-a7f3-\
9f2172dad12f"]
}, Open  ]]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Stiffness Matrix [KK]", "Section",
 CellChangeTimes->{{3.8531579018704567`*^9, 
  3.853157920354855*^9}},ExpressionUUID->"49ed5daf-d5c0-4691-804c-\
bf69f17eef5f"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", "Torsion", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"nucleusKGJ", " ", "=", " ", 
     RowBox[{
      SubsuperscriptBox["\[Integral]", "0", "1"], 
      RowBox[{
       RowBox[{"Outer", "[", 
        RowBox[{"Times", ",", " ", 
         RowBox[{"ATh", ".", "psi1"}], ",", " ", 
         RowBox[{"psi1", ".", "ATh"}]}], "]"}], 
       RowBox[{"\[DifferentialD]", "z"}]}]}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"Twist", "-", 
     RowBox[{"bend", " ", "coupling"}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"nucleusKK1", " ", "=", " ", 
     RowBox[{
      SubsuperscriptBox["\[Integral]", "0", "1"], 
      RowBox[{
       RowBox[{"Outer", "[", 
        RowBox[{"Times", ",", " ", 
         RowBox[{"ATh", ".", "psi1"}], ",", " ", 
         RowBox[{"psi2", ".", "Av"}]}], "]"}], 
       RowBox[{"\[DifferentialD]", "z"}]}]}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"Bend", "-", 
     RowBox[{"twist", " ", "coupling"}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"nucleusKK2", " ", "=", " ", 
     RowBox[{
      SubsuperscriptBox["\[Integral]", "0", "1"], 
      RowBox[{
       RowBox[{"Outer", "[", 
        RowBox[{"Times", ",", " ", 
         RowBox[{"Av", ".", "psi2"}], ",", " ", 
         RowBox[{"psi1", ".", "ATh"}]}], "]"}], 
       RowBox[{"\[DifferentialD]", "z"}]}]}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", "Bending", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"nucleusKEI", " ", "=", " ", 
     RowBox[{
      SubsuperscriptBox["\[Integral]", "0", "1"], 
      RowBox[{
       RowBox[{"Outer", "[", 
        RowBox[{"Times", ",", " ", 
         RowBox[{"Av", ".", "psi2"}], ",", " ", 
         RowBox[{"psi2", ".", "Av"}]}], "]"}], 
       RowBox[{"\[DifferentialD]", "z"}]}]}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"nucleusKGJ", "//", "MatrixForm"}], "\[IndentingNewLine]", 
   RowBox[{"nucleusKK1", "//", "MatrixForm"}], "\[IndentingNewLine]", 
   RowBox[{"nucleusKK2", "//", "MatrixForm"}], "\[IndentingNewLine]", 
   RowBox[{"nucleusKEI", "//", "MatrixForm"}]}]}]], "Input",
 CellChangeTimes->{{3.853157927540287*^9, 3.8531579712851896`*^9}, {
  3.8531606417896385`*^9, 3.8531608665384884`*^9}, {3.853161144811466*^9, 
  3.853161215210041*^9}, {3.8531613774339037`*^9, 3.8531613793237295`*^9}},
 CellLabel->"In[38]:=",ExpressionUUID->"f4bfefc4-87bf-459e-a121-adbbeeb52a0b"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"1", "0", "0", 
      RowBox[{"-", "1"}], "0", "0"},
     {"0", "0", "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0"},
     {
      RowBox[{"-", "1"}], "0", "0", "1", "0", "0"},
     {"0", "0", "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0"}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{3.853161380193492*^9, 3.853500997174077*^9, 
  3.8535589730377035`*^9},
 CellLabel->
  "Out[42]//MatrixForm=",ExpressionUUID->"35a73a21-dfa8-4809-84c3-\
a52b8ed00e29"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"0", "0", "1", "0", "0", 
      RowBox[{"-", "1"}]},
     {"0", "0", "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0"},
     {"0", "0", 
      RowBox[{"-", "1"}], "0", "0", "1"},
     {"0", "0", "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0"}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{3.853161380193492*^9, 3.853500997174077*^9, 
  3.8535589730417004`*^9},
 CellLabel->
  "Out[43]//MatrixForm=",ExpressionUUID->"266fa656-751a-404a-afd7-\
ebb666e22c2a"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"0", "0", "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0"},
     {"1", "0", "0", 
      RowBox[{"-", "1"}], "0", "0"},
     {"0", "0", "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0"},
     {
      RowBox[{"-", "1"}], "0", "0", "1", "0", "0"}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{3.853161380193492*^9, 3.853500997174077*^9, 
  3.8535589730417004`*^9},
 CellLabel->
  "Out[44]//MatrixForm=",ExpressionUUID->"84d7adbe-fdcf-4aa3-94f6-\
a03eaf58280f"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"0", "0", "0", "0", "0", "0"},
     {"0", "12", "6", "0", 
      RowBox[{"-", "12"}], "6"},
     {"0", "6", "4", "0", 
      RowBox[{"-", "6"}], "2"},
     {"0", "0", "0", "0", "0", "0"},
     {"0", 
      RowBox[{"-", "12"}], 
      RowBox[{"-", "6"}], "0", "12", 
      RowBox[{"-", "6"}]},
     {"0", "6", "2", "0", 
      RowBox[{"-", "6"}], "4"}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{3.853161380193492*^9, 3.853500997174077*^9, 
  3.8535589730457015`*^9},
 CellLabel->
  "Out[45]//MatrixForm=",ExpressionUUID->"c96cf6cc-048c-4e3a-b045-\
b8a3d2c91ce0"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"Element", " ", "stiffness", " ", 
    RowBox[{"matrix", ":"}]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"KKElem", " ", "=", " ", 
     RowBox[{"Table", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"GJ", "[", 
            RowBox[{"[", "i", "]"}], "]"}], "/", 
           RowBox[{"L", "[", 
            RowBox[{"[", "i", "]"}], "]"}]}], ")"}], "*", 
         RowBox[{
          RowBox[{"Transpose", "[", 
           RowBox[{"S1", "[", 
            RowBox[{"[", "i", "]"}], "]"}], "]"}], ".", " ", "nucleusKGJ", 
          ".", 
          RowBox[{"S1", "[", 
           RowBox[{"[", "i", "]"}], "]"}]}]}], "+", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"KBT", "[", 
            RowBox[{"[", "i", "]"}], "]"}], "/", 
           RowBox[{
            RowBox[{"L", "[", 
             RowBox[{"[", "i", "]"}], "]"}], "^", "2"}]}], ")"}], "*", 
         RowBox[{
          RowBox[{"Transpose", "[", 
           RowBox[{"S1", "[", 
            RowBox[{"[", "i", "]"}], "]"}], "]"}], ".", " ", "nucleusKK1", 
          ".", 
          RowBox[{"S1", "[", 
           RowBox[{"[", "i", "]"}], "]"}]}]}], "+", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"KBT", "[", 
            RowBox[{"[", "i", "]"}], "]"}], "/", 
           RowBox[{
            RowBox[{"L", "[", 
             RowBox[{"[", "i", "]"}], "]"}], "^", "2"}]}], ")"}], "*", 
         RowBox[{
          RowBox[{"Transpose", "[", 
           RowBox[{"S1", "[", 
            RowBox[{"[", "i", "]"}], "]"}], "]"}], ".", " ", "nucleusKK2", 
          ".", 
          RowBox[{"S1", "[", 
           RowBox[{"[", "i", "]"}], "]"}]}]}], "+", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"EI", "[", 
            RowBox[{"[", "i", "]"}], "]"}], "/", 
           RowBox[{
            RowBox[{"L", "[", 
             RowBox[{"[", "i", "]"}], "]"}], "^", "3"}]}], ")"}], "*", 
         RowBox[{
          RowBox[{"Transpose", "[", 
           RowBox[{"S1", "[", 
            RowBox[{"[", "i", "]"}], "]"}], "]"}], ".", " ", "nucleusKEI", 
          ".", 
          RowBox[{"S1", "[", 
           RowBox[{"[", "i", "]"}], "]"}]}]}]}], ",", "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{"i", ",", "n"}], "}"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"KKElem", "[", 
     RowBox[{"[", "1", "]"}], "]"}], "//", "MatrixForm"}]}]}]], "Input",
 CellChangeTimes->{{3.853161229844341*^9, 3.853161248381115*^9}, {
   3.853161290410644*^9, 3.8531613648317037`*^9}, {3.853161426346966*^9, 
   3.853161432176824*^9}, {3.853161477589877*^9, 3.8531615148437853`*^9}, 
   3.8531615904846325`*^9, {3.853161657239006*^9, 3.8531617697101545`*^9}, 
   3.853161913796624*^9},
 CellLabel->"In[46]:=",ExpressionUUID->"9f3dc9eb-2fdb-4356-ac3a-f6763e8b79ce"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      FractionBox["GJ1", "L1"], "0", 
      FractionBox["K1", "L1"], 
      RowBox[{"-", 
       FractionBox["GJ1", "L1"]}], "0", 
      RowBox[{"-", 
       FractionBox["K1", "L1"]}]},
     {"0", 
      FractionBox[
       RowBox[{"12", " ", "EI1"}], 
       SuperscriptBox["L1", "3"]], 
      FractionBox[
       RowBox[{"6", " ", "EI1"}], 
       SuperscriptBox["L1", "2"]], "0", 
      RowBox[{"-", 
       FractionBox[
        RowBox[{"12", " ", "EI1"}], 
        SuperscriptBox["L1", "3"]]}], 
      FractionBox[
       RowBox[{"6", " ", "EI1"}], 
       SuperscriptBox["L1", "2"]]},
     {
      FractionBox["K1", "L1"], 
      FractionBox[
       RowBox[{"6", " ", "EI1"}], 
       SuperscriptBox["L1", "2"]], 
      FractionBox[
       RowBox[{"4", " ", "EI1"}], "L1"], 
      RowBox[{"-", 
       FractionBox["K1", "L1"]}], 
      RowBox[{"-", 
       FractionBox[
        RowBox[{"6", " ", "EI1"}], 
        SuperscriptBox["L1", "2"]]}], 
      FractionBox[
       RowBox[{"2", " ", "EI1"}], "L1"]},
     {
      RowBox[{"-", 
       FractionBox["GJ1", "L1"]}], "0", 
      RowBox[{"-", 
       FractionBox["K1", "L1"]}], 
      FractionBox["GJ1", "L1"], "0", 
      FractionBox["K1", "L1"]},
     {"0", 
      RowBox[{"-", 
       FractionBox[
        RowBox[{"12", " ", "EI1"}], 
        SuperscriptBox["L1", "3"]]}], 
      RowBox[{"-", 
       FractionBox[
        RowBox[{"6", " ", "EI1"}], 
        SuperscriptBox["L1", "2"]]}], "0", 
      FractionBox[
       RowBox[{"12", " ", "EI1"}], 
       SuperscriptBox["L1", "3"]], 
      RowBox[{"-", 
       FractionBox[
        RowBox[{"6", " ", "EI1"}], 
        SuperscriptBox["L1", "2"]]}]},
     {
      RowBox[{"-", 
       FractionBox["K1", "L1"]}], 
      FractionBox[
       RowBox[{"6", " ", "EI1"}], 
       SuperscriptBox["L1", "2"]], 
      FractionBox[
       RowBox[{"2", " ", "EI1"}], "L1"], 
      FractionBox["K1", "L1"], 
      RowBox[{"-", 
       FractionBox[
        RowBox[{"6", " ", "EI1"}], 
        SuperscriptBox["L1", "2"]]}], 
      FractionBox[
       RowBox[{"4", " ", "EI1"}], "L1"]}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{3.8531617702771616`*^9, 3.853501000979149*^9, 
  3.8535589730616846`*^9},
 CellLabel->
  "Out[47]//MatrixForm=",ExpressionUUID->"277e2dd3-4405-406b-8475-\
632dec813f79"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"Global", " ", "stiffness", " ", 
    RowBox[{"matrix", ":"}]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"KK", " ", "=", " ", 
     RowBox[{"ConstantArray", "[", 
      RowBox[{"0", ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"3", "*", 
          RowBox[{"(", 
           RowBox[{"n", "+", "1"}], ")"}]}], ",", " ", 
         RowBox[{"3", "*", 
          RowBox[{"(", 
           RowBox[{"n", "+", "1"}], ")"}]}]}], "}"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Do", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"KK", "[", 
        RowBox[{"[", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"3", "*", "i"}], "-", "2"}], ";;", 
           RowBox[{
            RowBox[{"3", "*", "i"}], "+", "3"}]}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{"3", "*", "i"}], "-", "2"}], ";;", 
           RowBox[{
            RowBox[{"3", "*", "i"}], "+", "3"}]}]}], "]"}], "]"}], " ", "=", 
       "  ", 
       RowBox[{
        RowBox[{"KK", "[", 
         RowBox[{"[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"3", "*", "i"}], "-", "2"}], ";;", 
            RowBox[{
             RowBox[{"3", "*", "i"}], "+", "3"}]}], ",", 
           RowBox[{
            RowBox[{
             RowBox[{"3", "*", "i"}], "-", "2"}], ";;", 
            RowBox[{
             RowBox[{"3", "*", "i"}], "+", "3"}]}]}], "]"}], "]"}], "+", 
        RowBox[{"KKElem", "[", 
         RowBox[{"[", "i", "]"}], "]"}]}]}], " ", ",", 
      RowBox[{"{", 
       RowBox[{"i", ",", "n"}], "}"}]}], "]"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"KK", "//", "MatrixForm"}]}]}]], "Input",
 CellChangeTimes->{{3.8531610319170322`*^9, 3.853161049542431*^9}, {
   3.8531619255992284`*^9, 3.85316197249403*^9}, {3.853162027082408*^9, 
   3.853162033222666*^9}, {3.8531624391565003`*^9, 3.853162466398546*^9}, {
   3.853162513600278*^9, 3.853162589887618*^9}, {3.8531626332898397`*^9, 
   3.853162636461113*^9}, 3.853162809569166*^9, {3.8531628929120197`*^9, 
   3.853162897575876*^9}},
 CellLabel->"In[48]:=",ExpressionUUID->"cb8f63be-29a1-4bbf-b4ea-9c6dd7523989"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      FractionBox["GJ1", "L1"], "0", 
      FractionBox["K1", "L1"], 
      RowBox[{"-", 
       FractionBox["GJ1", "L1"]}], "0", 
      RowBox[{"-", 
       FractionBox["K1", "L1"]}], "0", "0", "0", "0", "0", "0"},
     {"0", 
      FractionBox[
       RowBox[{"12", " ", "EI1"}], 
       SuperscriptBox["L1", "3"]], 
      FractionBox[
       RowBox[{"6", " ", "EI1"}], 
       SuperscriptBox["L1", "2"]], "0", 
      RowBox[{"-", 
       FractionBox[
        RowBox[{"12", " ", "EI1"}], 
        SuperscriptBox["L1", "3"]]}], 
      FractionBox[
       RowBox[{"6", " ", "EI1"}], 
       SuperscriptBox["L1", "2"]], "0", "0", "0", "0", "0", "0"},
     {
      FractionBox["K1", "L1"], 
      FractionBox[
       RowBox[{"6", " ", "EI1"}], 
       SuperscriptBox["L1", "2"]], 
      FractionBox[
       RowBox[{"4", " ", "EI1"}], "L1"], 
      RowBox[{"-", 
       FractionBox["K1", "L1"]}], 
      RowBox[{"-", 
       FractionBox[
        RowBox[{"6", " ", "EI1"}], 
        SuperscriptBox["L1", "2"]]}], 
      FractionBox[
       RowBox[{"2", " ", "EI1"}], "L1"], "0", "0", "0", "0", "0", "0"},
     {
      RowBox[{"-", 
       FractionBox["GJ1", "L1"]}], "0", 
      RowBox[{"-", 
       FractionBox["K1", "L1"]}], 
      RowBox[{
       FractionBox["GJ1", "L1"], "+", 
       FractionBox["GJ2", "L2"]}], "0", 
      RowBox[{
       FractionBox["K1", "L1"], "+", 
       FractionBox["K2", "L2"]}], 
      RowBox[{"-", 
       FractionBox["GJ2", "L2"]}], "0", 
      RowBox[{"-", 
       FractionBox["K2", "L2"]}], "0", "0", "0"},
     {"0", 
      RowBox[{"-", 
       FractionBox[
        RowBox[{"12", " ", "EI1"}], 
        SuperscriptBox["L1", "3"]]}], 
      RowBox[{"-", 
       FractionBox[
        RowBox[{"6", " ", "EI1"}], 
        SuperscriptBox["L1", "2"]]}], "0", 
      RowBox[{
       FractionBox[
        RowBox[{"12", " ", "EI1"}], 
        SuperscriptBox["L1", "3"]], "+", 
       FractionBox[
        RowBox[{"12", " ", "EI2"}], 
        SuperscriptBox["L2", "3"]]}], 
      RowBox[{
       RowBox[{"-", 
        FractionBox[
         RowBox[{"6", " ", "EI1"}], 
         SuperscriptBox["L1", "2"]]}], "+", 
       FractionBox[
        RowBox[{"6", " ", "EI2"}], 
        SuperscriptBox["L2", "2"]]}], "0", 
      RowBox[{"-", 
       FractionBox[
        RowBox[{"12", " ", "EI2"}], 
        SuperscriptBox["L2", "3"]]}], 
      FractionBox[
       RowBox[{"6", " ", "EI2"}], 
       SuperscriptBox["L2", "2"]], "0", "0", "0"},
     {
      RowBox[{"-", 
       FractionBox["K1", "L1"]}], 
      FractionBox[
       RowBox[{"6", " ", "EI1"}], 
       SuperscriptBox["L1", "2"]], 
      FractionBox[
       RowBox[{"2", " ", "EI1"}], "L1"], 
      RowBox[{
       FractionBox["K1", "L1"], "+", 
       FractionBox["K2", "L2"]}], 
      RowBox[{
       RowBox[{"-", 
        FractionBox[
         RowBox[{"6", " ", "EI1"}], 
         SuperscriptBox["L1", "2"]]}], "+", 
       FractionBox[
        RowBox[{"6", " ", "EI2"}], 
        SuperscriptBox["L2", "2"]]}], 
      RowBox[{
       FractionBox[
        RowBox[{"4", " ", "EI1"}], "L1"], "+", 
       FractionBox[
        RowBox[{"4", " ", "EI2"}], "L2"]}], 
      RowBox[{"-", 
       FractionBox["K2", "L2"]}], 
      RowBox[{"-", 
       FractionBox[
        RowBox[{"6", " ", "EI2"}], 
        SuperscriptBox["L2", "2"]]}], 
      FractionBox[
       RowBox[{"2", " ", "EI2"}], "L2"], "0", "0", "0"},
     {"0", "0", "0", 
      RowBox[{"-", 
       FractionBox["GJ2", "L2"]}], "0", 
      RowBox[{"-", 
       FractionBox["K2", "L2"]}], 
      RowBox[{
       FractionBox["GJ2", "L2"], "+", 
       FractionBox["GJ3", "L3"]}], "0", 
      RowBox[{
       FractionBox["K2", "L2"], "+", 
       FractionBox["K3", "L3"]}], 
      RowBox[{"-", 
       FractionBox["GJ3", "L3"]}], "0", 
      RowBox[{"-", 
       FractionBox["K3", "L3"]}]},
     {"0", "0", "0", "0", 
      RowBox[{"-", 
       FractionBox[
        RowBox[{"12", " ", "EI2"}], 
        SuperscriptBox["L2", "3"]]}], 
      RowBox[{"-", 
       FractionBox[
        RowBox[{"6", " ", "EI2"}], 
        SuperscriptBox["L2", "2"]]}], "0", 
      RowBox[{
       FractionBox[
        RowBox[{"12", " ", "EI2"}], 
        SuperscriptBox["L2", "3"]], "+", 
       FractionBox[
        RowBox[{"12", " ", "EI3"}], 
        SuperscriptBox["L3", "3"]]}], 
      RowBox[{
       RowBox[{"-", 
        FractionBox[
         RowBox[{"6", " ", "EI2"}], 
         SuperscriptBox["L2", "2"]]}], "+", 
       FractionBox[
        RowBox[{"6", " ", "EI3"}], 
        SuperscriptBox["L3", "2"]]}], "0", 
      RowBox[{"-", 
       FractionBox[
        RowBox[{"12", " ", "EI3"}], 
        SuperscriptBox["L3", "3"]]}], 
      FractionBox[
       RowBox[{"6", " ", "EI3"}], 
       SuperscriptBox["L3", "2"]]},
     {"0", "0", "0", 
      RowBox[{"-", 
       FractionBox["K2", "L2"]}], 
      FractionBox[
       RowBox[{"6", " ", "EI2"}], 
       SuperscriptBox["L2", "2"]], 
      FractionBox[
       RowBox[{"2", " ", "EI2"}], "L2"], 
      RowBox[{
       FractionBox["K2", "L2"], "+", 
       FractionBox["K3", "L3"]}], 
      RowBox[{
       RowBox[{"-", 
        FractionBox[
         RowBox[{"6", " ", "EI2"}], 
         SuperscriptBox["L2", "2"]]}], "+", 
       FractionBox[
        RowBox[{"6", " ", "EI3"}], 
        SuperscriptBox["L3", "2"]]}], 
      RowBox[{
       FractionBox[
        RowBox[{"4", " ", "EI2"}], "L2"], "+", 
       FractionBox[
        RowBox[{"4", " ", "EI3"}], "L3"]}], 
      RowBox[{"-", 
       FractionBox["K3", "L3"]}], 
      RowBox[{"-", 
       FractionBox[
        RowBox[{"6", " ", "EI3"}], 
        SuperscriptBox["L3", "2"]]}], 
      FractionBox[
       RowBox[{"2", " ", "EI3"}], "L3"]},
     {"0", "0", "0", "0", "0", "0", 
      RowBox[{"-", 
       FractionBox["GJ3", "L3"]}], "0", 
      RowBox[{"-", 
       FractionBox["K3", "L3"]}], 
      FractionBox["GJ3", "L3"], "0", 
      FractionBox["K3", "L3"]},
     {"0", "0", "0", "0", "0", "0", "0", 
      RowBox[{"-", 
       FractionBox[
        RowBox[{"12", " ", "EI3"}], 
        SuperscriptBox["L3", "3"]]}], 
      RowBox[{"-", 
       FractionBox[
        RowBox[{"6", " ", "EI3"}], 
        SuperscriptBox["L3", "2"]]}], "0", 
      FractionBox[
       RowBox[{"12", " ", "EI3"}], 
       SuperscriptBox["L3", "3"]], 
      RowBox[{"-", 
       FractionBox[
        RowBox[{"6", " ", "EI3"}], 
        SuperscriptBox["L3", "2"]]}]},
     {"0", "0", "0", "0", "0", "0", 
      RowBox[{"-", 
       FractionBox["K3", "L3"]}], 
      FractionBox[
       RowBox[{"6", " ", "EI3"}], 
       SuperscriptBox["L3", "2"]], 
      FractionBox[
       RowBox[{"2", " ", "EI3"}], "L3"], 
      FractionBox["K3", "L3"], 
      RowBox[{"-", 
       FractionBox[
        RowBox[{"6", " ", "EI3"}], 
        SuperscriptBox["L3", "2"]]}], 
      FractionBox[
       RowBox[{"4", " ", "EI3"}], "L3"]}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{3.8531625959361525`*^9, 3.8531628106486206`*^9, 
  3.8535010040163374`*^9, 3.853558973085374*^9},
 CellLabel->
  "Out[50]//MatrixForm=",ExpressionUUID->"19a98395-18cc-43c9-8cb9-\
5ecdec0a4be1"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Mass Matrix [MM]", "Section",
 CellChangeTimes->{{3.8531579018704567`*^9, 3.853157920354855*^9}, {
  3.8531631387344275`*^9, 
  3.8531631436684375`*^9}},ExpressionUUID->"ca789be7-ef20-4e36-9cc1-\
db15afe1b785"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", "Torsion", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"nucleusMTT", " ", "=", " ", 
     RowBox[{
      SubsuperscriptBox["\[Integral]", "0", "1"], 
      RowBox[{
       RowBox[{"Outer", "[", 
        RowBox[{"Times", ",", " ", 
         RowBox[{"ATh", ".", "psi"}], ",", " ", 
         RowBox[{"psi", ".", "ATh"}]}], "]"}], 
       RowBox[{"\[DifferentialD]", "z"}]}]}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"Twist", "-", 
     RowBox[{"bend", " ", "coupling"}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"nucleusMTB", " ", "=", " ", 
     RowBox[{
      SubsuperscriptBox["\[Integral]", "0", "1"], 
      RowBox[{
       RowBox[{"Outer", "[", 
        RowBox[{"Times", ",", " ", 
         RowBox[{"ATh", ".", "psi"}], ",", " ", 
         RowBox[{"psi", ".", "Av"}]}], "]"}], 
       RowBox[{"\[DifferentialD]", "z"}]}]}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"Bend", "-", 
     RowBox[{"twist", " ", "coupling"}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"nucleusMBT", " ", "=", " ", 
     RowBox[{
      SubsuperscriptBox["\[Integral]", "0", "1"], 
      RowBox[{
       RowBox[{"Outer", "[", 
        RowBox[{"Times", ",", " ", 
         RowBox[{"Av", ".", "psi"}], ",", " ", 
         RowBox[{"psi", ".", "ATh"}]}], "]"}], 
       RowBox[{"\[DifferentialD]", "z"}]}]}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", "Bending", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"nucleusMBB", " ", "=", " ", 
     RowBox[{
      SubsuperscriptBox["\[Integral]", "0", "1"], 
      RowBox[{
       RowBox[{"Outer", "[", 
        RowBox[{"Times", ",", " ", 
         RowBox[{"Av", ".", "psi"}], ",", " ", 
         RowBox[{"psi", ".", "Av"}]}], "]"}], 
       RowBox[{"\[DifferentialD]", "z"}]}]}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"nucleusMTT", "//", "MatrixForm"}], "\[IndentingNewLine]", 
   RowBox[{"nucleusMTB", "//", "MatrixForm"}], "\[IndentingNewLine]", 
   RowBox[{"nucleusMBT", "//", "MatrixForm"}], "\[IndentingNewLine]", 
   RowBox[{"nucleusMBB", "//", "MatrixForm"}]}]}]], "Input",
 CellChangeTimes->{{3.853157927540287*^9, 3.8531579712851896`*^9}, {
  3.8531606417896385`*^9, 3.8531608665384884`*^9}, {3.853161144811466*^9, 
  3.853161215210041*^9}, {3.8531613774339037`*^9, 3.8531613793237295`*^9}, {
  3.853319502751261*^9, 3.8533196753294168`*^9}},
 CellLabel->"In[51]:=",ExpressionUUID->"54e07063-bb02-4fbe-a9c1-fa5809bc1d1e"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      FractionBox["1", "3"], "0", "0", 
      FractionBox["1", "6"], "0", "0"},
     {"0", "0", "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0"},
     {
      FractionBox["1", "6"], "0", "0", 
      FractionBox["1", "3"], "0", "0"},
     {"0", "0", "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0"}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{3.853161380193492*^9, 3.8533209052165613`*^9, 
  3.8533212395081286`*^9, 3.853321286248886*^9, 3.8535016303740444`*^9, 
  3.853558973201322*^9},
 CellLabel->
  "Out[55]//MatrixForm=",ExpressionUUID->"ebaa02f8-6237-4d1e-a211-\
694853054926"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"0", 
      FractionBox["7", "20"], 
      FractionBox["1", "20"], "0", 
      FractionBox["3", "20"], 
      RowBox[{"-", 
       FractionBox["1", "30"]}]},
     {"0", "0", "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0"},
     {"0", 
      FractionBox["3", "20"], 
      FractionBox["1", "30"], "0", 
      FractionBox["7", "20"], 
      RowBox[{"-", 
       FractionBox["1", "20"]}]},
     {"0", "0", "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0"}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{3.853161380193492*^9, 3.8533209052165613`*^9, 
  3.8533212395081286`*^9, 3.853321286248886*^9, 3.8535016303740444`*^9, 
  3.853558973205326*^9},
 CellLabel->
  "Out[56]//MatrixForm=",ExpressionUUID->"51ae9035-336e-47de-be38-\
1eb96fc4c065"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"0", "0", "0", "0", "0", "0"},
     {
      FractionBox["7", "20"], "0", "0", 
      FractionBox["3", "20"], "0", "0"},
     {
      FractionBox["1", "20"], "0", "0", 
      FractionBox["1", "30"], "0", "0"},
     {"0", "0", "0", "0", "0", "0"},
     {
      FractionBox["3", "20"], "0", "0", 
      FractionBox["7", "20"], "0", "0"},
     {
      RowBox[{"-", 
       FractionBox["1", "30"]}], "0", "0", 
      RowBox[{"-", 
       FractionBox["1", "20"]}], "0", "0"}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{3.853161380193492*^9, 3.8533209052165613`*^9, 
  3.8533212395081286`*^9, 3.853321286248886*^9, 3.8535016303740444`*^9, 
  3.8535589732093153`*^9},
 CellLabel->
  "Out[57]//MatrixForm=",ExpressionUUID->"97c7a09f-439e-4756-86ea-\
46386c5afffe"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"0", "0", "0", "0", "0", "0"},
     {"0", 
      FractionBox["13", "35"], 
      FractionBox["11", "210"], "0", 
      FractionBox["9", "70"], 
      RowBox[{"-", 
       FractionBox["13", "420"]}]},
     {"0", 
      FractionBox["11", "210"], 
      FractionBox["1", "105"], "0", 
      FractionBox["13", "420"], 
      RowBox[{"-", 
       FractionBox["1", "140"]}]},
     {"0", "0", "0", "0", "0", "0"},
     {"0", 
      FractionBox["9", "70"], 
      FractionBox["13", "420"], "0", 
      FractionBox["13", "35"], 
      RowBox[{"-", 
       FractionBox["11", "210"]}]},
     {"0", 
      RowBox[{"-", 
       FractionBox["13", "420"]}], 
      RowBox[{"-", 
       FractionBox["1", "140"]}], "0", 
      RowBox[{"-", 
       FractionBox["11", "210"]}], 
      FractionBox["1", "105"]}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{3.853161380193492*^9, 3.8533209052165613`*^9, 
  3.8533212395081286`*^9, 3.853321286248886*^9, 3.8535016303740444`*^9, 
  3.8535589732093153`*^9},
 CellLabel->
  "Out[58]//MatrixForm=",ExpressionUUID->"3ad530d4-5655-4507-9e29-\
368a6bc65661"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"Element", " ", "mass", " ", 
    RowBox[{"matrix", ":"}]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"MMElem", " ", "=", " ", 
     RowBox[{"Table", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"Ip", "[", 
            RowBox[{"[", "i", "]"}], "]"}], "*", 
           RowBox[{"L", "[", 
            RowBox[{"[", "i", "]"}], "]"}]}], ")"}], "*", 
         RowBox[{
          RowBox[{"Transpose", "[", 
           RowBox[{"S1", "[", 
            RowBox[{"[", "i", "]"}], "]"}], "]"}], ".", " ", "nucleusMTT", 
          ".", 
          RowBox[{"S1", "[", 
           RowBox[{"[", "i", "]"}], "]"}]}]}], "+", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"M", "[", 
            RowBox[{"[", "i", "]"}], "]"}], "*", 
           RowBox[{"d", "[", 
            RowBox[{"[", "i", "]"}], "]"}], "*", 
           RowBox[{"L", "[", 
            RowBox[{"[", "i", "]"}], "]"}]}], ")"}], "*", 
         RowBox[{
          RowBox[{"Transpose", "[", 
           RowBox[{"S1", "[", 
            RowBox[{"[", "i", "]"}], "]"}], "]"}], ".", " ", "nucleusMTB", 
          ".", 
          RowBox[{"S1", "[", 
           RowBox[{"[", "i", "]"}], "]"}]}]}], "+", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"M", "[", 
            RowBox[{"[", "i", "]"}], "]"}], "*", 
           RowBox[{"d", "[", 
            RowBox[{"[", "i", "]"}], "]"}], "*", 
           RowBox[{"L", "[", 
            RowBox[{"[", "i", "]"}], "]"}]}], ")"}], "*", 
         RowBox[{
          RowBox[{"Transpose", "[", 
           RowBox[{"S1", "[", 
            RowBox[{"[", "i", "]"}], "]"}], "]"}], ".", " ", "nucleusMBT", 
          ".", 
          RowBox[{"S1", "[", 
           RowBox[{"[", "i", "]"}], "]"}]}]}], "+", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"M", "[", 
            RowBox[{"[", "i", "]"}], "]"}], "*", 
           RowBox[{"L", "[", 
            RowBox[{"[", "i", "]"}], "]"}]}], ")"}], "*", 
         RowBox[{
          RowBox[{"Transpose", "[", 
           RowBox[{"S1", "[", 
            RowBox[{"[", "i", "]"}], "]"}], "]"}], ".", " ", "nucleusMBB", 
          ".", 
          RowBox[{"S1", "[", 
           RowBox[{"[", "i", "]"}], "]"}]}]}]}], ",", "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{"i", ",", "n"}], "}"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"MMElem", "[", 
     RowBox[{"[", "1", "]"}], "]"}], "//", "MatrixForm"}]}]}]], "Input",
 CellChangeTimes->{{3.853161229844341*^9, 3.853161248381115*^9}, {
   3.853161290410644*^9, 3.8531613648317037`*^9}, {3.853161426346966*^9, 
   3.853161432176824*^9}, {3.853161477589877*^9, 3.8531615148437853`*^9}, 
   3.8531615904846325`*^9, {3.853161657239006*^9, 3.8531617697101545`*^9}, 
   3.853161913796624*^9, {3.853320973030608*^9, 3.853321094720787*^9}, {
   3.8533261280745745`*^9, 3.8533261284179926`*^9}},
 CellLabel->"In[59]:=",ExpressionUUID->"db507d2d-0c2b-4397-888e-bc26ed4afc6b"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      FractionBox[
       RowBox[{"L1", " ", "\[Rho]Ip1"}], "3"], 
      FractionBox[
       RowBox[{"7", " ", "d1", " ", "L1", " ", "m1"}], "20"], 
      RowBox[{
       FractionBox["1", "20"], " ", "d1", " ", 
       SuperscriptBox["L1", "2"], " ", "m1"}], 
      FractionBox[
       RowBox[{"L1", " ", "\[Rho]Ip1"}], "6"], 
      FractionBox[
       RowBox[{"3", " ", "d1", " ", "L1", " ", "m1"}], "20"], 
      RowBox[{
       RowBox[{"-", 
        FractionBox["1", "30"]}], " ", "d1", " ", 
       SuperscriptBox["L1", "2"], " ", "m1"}]},
     {
      FractionBox[
       RowBox[{"7", " ", "d1", " ", "L1", " ", "m1"}], "20"], 
      FractionBox[
       RowBox[{"13", " ", "L1", " ", "m1"}], "35"], 
      FractionBox[
       RowBox[{"11", " ", 
        SuperscriptBox["L1", "2"], " ", "m1"}], "210"], 
      FractionBox[
       RowBox[{"3", " ", "d1", " ", "L1", " ", "m1"}], "20"], 
      FractionBox[
       RowBox[{"9", " ", "L1", " ", "m1"}], "70"], 
      RowBox[{"-", 
       FractionBox[
        RowBox[{"13", " ", 
         SuperscriptBox["L1", "2"], " ", "m1"}], "420"]}]},
     {
      RowBox[{
       FractionBox["1", "20"], " ", "d1", " ", 
       SuperscriptBox["L1", "2"], " ", "m1"}], 
      FractionBox[
       RowBox[{"11", " ", 
        SuperscriptBox["L1", "2"], " ", "m1"}], "210"], 
      FractionBox[
       RowBox[{
        SuperscriptBox["L1", "3"], " ", "m1"}], "105"], 
      RowBox[{
       FractionBox["1", "30"], " ", "d1", " ", 
       SuperscriptBox["L1", "2"], " ", "m1"}], 
      FractionBox[
       RowBox[{"13", " ", 
        SuperscriptBox["L1", "2"], " ", "m1"}], "420"], 
      RowBox[{"-", 
       FractionBox[
        RowBox[{
         SuperscriptBox["L1", "3"], " ", "m1"}], "140"]}]},
     {
      FractionBox[
       RowBox[{"L1", " ", "\[Rho]Ip1"}], "6"], 
      FractionBox[
       RowBox[{"3", " ", "d1", " ", "L1", " ", "m1"}], "20"], 
      RowBox[{
       FractionBox["1", "30"], " ", "d1", " ", 
       SuperscriptBox["L1", "2"], " ", "m1"}], 
      FractionBox[
       RowBox[{"L1", " ", "\[Rho]Ip1"}], "3"], 
      FractionBox[
       RowBox[{"7", " ", "d1", " ", "L1", " ", "m1"}], "20"], 
      RowBox[{
       RowBox[{"-", 
        FractionBox["1", "20"]}], " ", "d1", " ", 
       SuperscriptBox["L1", "2"], " ", "m1"}]},
     {
      FractionBox[
       RowBox[{"3", " ", "d1", " ", "L1", " ", "m1"}], "20"], 
      FractionBox[
       RowBox[{"9", " ", "L1", " ", "m1"}], "70"], 
      FractionBox[
       RowBox[{"13", " ", 
        SuperscriptBox["L1", "2"], " ", "m1"}], "420"], 
      FractionBox[
       RowBox[{"7", " ", "d1", " ", "L1", " ", "m1"}], "20"], 
      FractionBox[
       RowBox[{"13", " ", "L1", " ", "m1"}], "35"], 
      RowBox[{"-", 
       FractionBox[
        RowBox[{"11", " ", 
         SuperscriptBox["L1", "2"], " ", "m1"}], "210"]}]},
     {
      RowBox[{
       RowBox[{"-", 
        FractionBox["1", "30"]}], " ", "d1", " ", 
       SuperscriptBox["L1", "2"], " ", "m1"}], 
      RowBox[{"-", 
       FractionBox[
        RowBox[{"13", " ", 
         SuperscriptBox["L1", "2"], " ", "m1"}], "420"]}], 
      RowBox[{"-", 
       FractionBox[
        RowBox[{
         SuperscriptBox["L1", "3"], " ", "m1"}], "140"]}], 
      RowBox[{
       RowBox[{"-", 
        FractionBox["1", "20"]}], " ", "d1", " ", 
       SuperscriptBox["L1", "2"], " ", "m1"}], 
      RowBox[{"-", 
       FractionBox[
        RowBox[{"11", " ", 
         SuperscriptBox["L1", "2"], " ", "m1"}], "210"]}], 
      FractionBox[
       RowBox[{
        SuperscriptBox["L1", "3"], " ", "m1"}], "105"]}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{3.8531617702771616`*^9, 3.8533210954773293`*^9, 
  3.8533212429599123`*^9, 3.853321289048753*^9, 3.85350164025072*^9, 
  3.8535589732292995`*^9},
 CellLabel->
  "Out[60]//MatrixForm=",ExpressionUUID->"ef7d936a-99af-4959-ac02-\
c57cde0b5690"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"Global", " ", "mass", " ", 
    RowBox[{"matrix", ":"}]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"MM", " ", "=", " ", 
     RowBox[{"ConstantArray", "[", 
      RowBox[{"0", ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"3", "*", 
          RowBox[{"(", 
           RowBox[{"n", "+", "1"}], ")"}]}], ",", " ", 
         RowBox[{"3", "*", 
          RowBox[{"(", 
           RowBox[{"n", "+", "1"}], ")"}]}]}], "}"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Do", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"MM", "[", 
        RowBox[{"[", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"3", "*", "i"}], "-", "2"}], ";;", 
           RowBox[{
            RowBox[{"3", "*", "i"}], "+", "3"}]}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{"3", "*", "i"}], "-", "2"}], ";;", 
           RowBox[{
            RowBox[{"3", "*", "i"}], "+", "3"}]}]}], "]"}], "]"}], " ", "=", 
       "  ", 
       RowBox[{
        RowBox[{"MM", "[", 
         RowBox[{"[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"3", "*", "i"}], "-", "2"}], ";;", 
            RowBox[{
             RowBox[{"3", "*", "i"}], "+", "3"}]}], ",", 
           RowBox[{
            RowBox[{
             RowBox[{"3", "*", "i"}], "-", "2"}], ";;", 
            RowBox[{
             RowBox[{"3", "*", "i"}], "+", "3"}]}]}], "]"}], "]"}], "+", 
        RowBox[{"MMElem", "[", 
         RowBox[{"[", "i", "]"}], "]"}]}]}], " ", ",", 
      RowBox[{"{", 
       RowBox[{"i", ",", "n"}], "}"}]}], "]"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"MM", "//", "MatrixForm"}]}]}]], "Input",
 CellChangeTimes->{{3.8531610319170322`*^9, 3.853161049542431*^9}, {
   3.8531619255992284`*^9, 3.85316197249403*^9}, {3.853162027082408*^9, 
   3.853162033222666*^9}, {3.8531624391565003`*^9, 3.853162466398546*^9}, {
   3.853162513600278*^9, 3.853162589887618*^9}, {3.8531626332898397`*^9, 
   3.853162636461113*^9}, 3.853162809569166*^9, {3.8531628929120197`*^9, 
   3.853162897575876*^9}, {3.8533213021808357`*^9, 3.8533213201194935`*^9}},
 CellLabel->"In[61]:=",ExpressionUUID->"bd3c1d81-bbd9-40f1-a5de-99c0fdf0b92c"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      FractionBox[
       RowBox[{"L1", " ", "\[Rho]Ip1"}], "3"], 
      FractionBox[
       RowBox[{"7", " ", "d1", " ", "L1", " ", "m1"}], "20"], 
      RowBox[{
       FractionBox["1", "20"], " ", "d1", " ", 
       SuperscriptBox["L1", "2"], " ", "m1"}], 
      FractionBox[
       RowBox[{"L1", " ", "\[Rho]Ip1"}], "6"], 
      FractionBox[
       RowBox[{"3", " ", "d1", " ", "L1", " ", "m1"}], "20"], 
      RowBox[{
       RowBox[{"-", 
        FractionBox["1", "30"]}], " ", "d1", " ", 
       SuperscriptBox["L1", "2"], " ", "m1"}], "0", "0", "0", "0", "0", "0"},
     {
      FractionBox[
       RowBox[{"7", " ", "d1", " ", "L1", " ", "m1"}], "20"], 
      FractionBox[
       RowBox[{"13", " ", "L1", " ", "m1"}], "35"], 
      FractionBox[
       RowBox[{"11", " ", 
        SuperscriptBox["L1", "2"], " ", "m1"}], "210"], 
      FractionBox[
       RowBox[{"3", " ", "d1", " ", "L1", " ", "m1"}], "20"], 
      FractionBox[
       RowBox[{"9", " ", "L1", " ", "m1"}], "70"], 
      RowBox[{"-", 
       FractionBox[
        RowBox[{"13", " ", 
         SuperscriptBox["L1", "2"], " ", "m1"}], "420"]}], "0", "0", "0", "0",
       "0", "0"},
     {
      RowBox[{
       FractionBox["1", "20"], " ", "d1", " ", 
       SuperscriptBox["L1", "2"], " ", "m1"}], 
      FractionBox[
       RowBox[{"11", " ", 
        SuperscriptBox["L1", "2"], " ", "m1"}], "210"], 
      FractionBox[
       RowBox[{
        SuperscriptBox["L1", "3"], " ", "m1"}], "105"], 
      RowBox[{
       FractionBox["1", "30"], " ", "d1", " ", 
       SuperscriptBox["L1", "2"], " ", "m1"}], 
      FractionBox[
       RowBox[{"13", " ", 
        SuperscriptBox["L1", "2"], " ", "m1"}], "420"], 
      RowBox[{"-", 
       FractionBox[
        RowBox[{
         SuperscriptBox["L1", "3"], " ", "m1"}], "140"]}], "0", "0", "0", "0",
       "0", "0"},
     {
      FractionBox[
       RowBox[{"L1", " ", "\[Rho]Ip1"}], "6"], 
      FractionBox[
       RowBox[{"3", " ", "d1", " ", "L1", " ", "m1"}], "20"], 
      RowBox[{
       FractionBox["1", "30"], " ", "d1", " ", 
       SuperscriptBox["L1", "2"], " ", "m1"}], 
      RowBox[{
       FractionBox[
        RowBox[{"L1", " ", "\[Rho]Ip1"}], "3"], "+", 
       FractionBox[
        RowBox[{"L2", " ", "\[Rho]Ip2"}], "3"]}], 
      RowBox[{
       FractionBox[
        RowBox[{"7", " ", "d1", " ", "L1", " ", "m1"}], "20"], "+", 
       FractionBox[
        RowBox[{"7", " ", "d2", " ", "L2", " ", "m2"}], "20"]}], 
      RowBox[{
       RowBox[{
        RowBox[{"-", 
         FractionBox["1", "20"]}], " ", "d1", " ", 
        SuperscriptBox["L1", "2"], " ", "m1"}], "+", 
       RowBox[{
        FractionBox["1", "20"], " ", "d2", " ", 
        SuperscriptBox["L2", "2"], " ", "m2"}]}], 
      FractionBox[
       RowBox[{"L2", " ", "\[Rho]Ip2"}], "6"], 
      FractionBox[
       RowBox[{"3", " ", "d2", " ", "L2", " ", "m2"}], "20"], 
      RowBox[{
       RowBox[{"-", 
        FractionBox["1", "30"]}], " ", "d2", " ", 
       SuperscriptBox["L2", "2"], " ", "m2"}], "0", "0", "0"},
     {
      FractionBox[
       RowBox[{"3", " ", "d1", " ", "L1", " ", "m1"}], "20"], 
      FractionBox[
       RowBox[{"9", " ", "L1", " ", "m1"}], "70"], 
      FractionBox[
       RowBox[{"13", " ", 
        SuperscriptBox["L1", "2"], " ", "m1"}], "420"], 
      RowBox[{
       FractionBox[
        RowBox[{"7", " ", "d1", " ", "L1", " ", "m1"}], "20"], "+", 
       FractionBox[
        RowBox[{"7", " ", "d2", " ", "L2", " ", "m2"}], "20"]}], 
      RowBox[{
       FractionBox[
        RowBox[{"13", " ", "L1", " ", "m1"}], "35"], "+", 
       FractionBox[
        RowBox[{"13", " ", "L2", " ", "m2"}], "35"]}], 
      RowBox[{
       RowBox[{"-", 
        FractionBox[
         RowBox[{"11", " ", 
          SuperscriptBox["L1", "2"], " ", "m1"}], "210"]}], "+", 
       FractionBox[
        RowBox[{"11", " ", 
         SuperscriptBox["L2", "2"], " ", "m2"}], "210"]}], 
      FractionBox[
       RowBox[{"3", " ", "d2", " ", "L2", " ", "m2"}], "20"], 
      FractionBox[
       RowBox[{"9", " ", "L2", " ", "m2"}], "70"], 
      RowBox[{"-", 
       FractionBox[
        RowBox[{"13", " ", 
         SuperscriptBox["L2", "2"], " ", "m2"}], "420"]}], "0", "0", "0"},
     {
      RowBox[{
       RowBox[{"-", 
        FractionBox["1", "30"]}], " ", "d1", " ", 
       SuperscriptBox["L1", "2"], " ", "m1"}], 
      RowBox[{"-", 
       FractionBox[
        RowBox[{"13", " ", 
         SuperscriptBox["L1", "2"], " ", "m1"}], "420"]}], 
      RowBox[{"-", 
       FractionBox[
        RowBox[{
         SuperscriptBox["L1", "3"], " ", "m1"}], "140"]}], 
      RowBox[{
       RowBox[{
        RowBox[{"-", 
         FractionBox["1", "20"]}], " ", "d1", " ", 
        SuperscriptBox["L1", "2"], " ", "m1"}], "+", 
       RowBox[{
        FractionBox["1", "20"], " ", "d2", " ", 
        SuperscriptBox["L2", "2"], " ", "m2"}]}], 
      RowBox[{
       RowBox[{"-", 
        FractionBox[
         RowBox[{"11", " ", 
          SuperscriptBox["L1", "2"], " ", "m1"}], "210"]}], "+", 
       FractionBox[
        RowBox[{"11", " ", 
         SuperscriptBox["L2", "2"], " ", "m2"}], "210"]}], 
      RowBox[{
       FractionBox[
        RowBox[{
         SuperscriptBox["L1", "3"], " ", "m1"}], "105"], "+", 
       FractionBox[
        RowBox[{
         SuperscriptBox["L2", "3"], " ", "m2"}], "105"]}], 
      RowBox[{
       FractionBox["1", "30"], " ", "d2", " ", 
       SuperscriptBox["L2", "2"], " ", "m2"}], 
      FractionBox[
       RowBox[{"13", " ", 
        SuperscriptBox["L2", "2"], " ", "m2"}], "420"], 
      RowBox[{"-", 
       FractionBox[
        RowBox[{
         SuperscriptBox["L2", "3"], " ", "m2"}], "140"]}], "0", "0", "0"},
     {"0", "0", "0", 
      FractionBox[
       RowBox[{"L2", " ", "\[Rho]Ip2"}], "6"], 
      FractionBox[
       RowBox[{"3", " ", "d2", " ", "L2", " ", "m2"}], "20"], 
      RowBox[{
       FractionBox["1", "30"], " ", "d2", " ", 
       SuperscriptBox["L2", "2"], " ", "m2"}], 
      RowBox[{
       FractionBox[
        RowBox[{"L2", " ", "\[Rho]Ip2"}], "3"], "+", 
       FractionBox[
        RowBox[{"L3", " ", "\[Rho]Ip3"}], "3"]}], 
      RowBox[{
       FractionBox[
        RowBox[{"7", " ", "d2", " ", "L2", " ", "m2"}], "20"], "+", 
       FractionBox[
        RowBox[{"7", " ", "d3", " ", "L3", " ", "m3"}], "20"]}], 
      RowBox[{
       RowBox[{
        RowBox[{"-", 
         FractionBox["1", "20"]}], " ", "d2", " ", 
        SuperscriptBox["L2", "2"], " ", "m2"}], "+", 
       RowBox[{
        FractionBox["1", "20"], " ", "d3", " ", 
        SuperscriptBox["L3", "2"], " ", "m3"}]}], 
      FractionBox[
       RowBox[{"L3", " ", "\[Rho]Ip3"}], "6"], 
      FractionBox[
       RowBox[{"3", " ", "d3", " ", "L3", " ", "m3"}], "20"], 
      RowBox[{
       RowBox[{"-", 
        FractionBox["1", "30"]}], " ", "d3", " ", 
       SuperscriptBox["L3", "2"], " ", "m3"}]},
     {"0", "0", "0", 
      FractionBox[
       RowBox[{"3", " ", "d2", " ", "L2", " ", "m2"}], "20"], 
      FractionBox[
       RowBox[{"9", " ", "L2", " ", "m2"}], "70"], 
      FractionBox[
       RowBox[{"13", " ", 
        SuperscriptBox["L2", "2"], " ", "m2"}], "420"], 
      RowBox[{
       FractionBox[
        RowBox[{"7", " ", "d2", " ", "L2", " ", "m2"}], "20"], "+", 
       FractionBox[
        RowBox[{"7", " ", "d3", " ", "L3", " ", "m3"}], "20"]}], 
      RowBox[{
       FractionBox[
        RowBox[{"13", " ", "L2", " ", "m2"}], "35"], "+", 
       FractionBox[
        RowBox[{"13", " ", "L3", " ", "m3"}], "35"]}], 
      RowBox[{
       RowBox[{"-", 
        FractionBox[
         RowBox[{"11", " ", 
          SuperscriptBox["L2", "2"], " ", "m2"}], "210"]}], "+", 
       FractionBox[
        RowBox[{"11", " ", 
         SuperscriptBox["L3", "2"], " ", "m3"}], "210"]}], 
      FractionBox[
       RowBox[{"3", " ", "d3", " ", "L3", " ", "m3"}], "20"], 
      FractionBox[
       RowBox[{"9", " ", "L3", " ", "m3"}], "70"], 
      RowBox[{"-", 
       FractionBox[
        RowBox[{"13", " ", 
         SuperscriptBox["L3", "2"], " ", "m3"}], "420"]}]},
     {"0", "0", "0", 
      RowBox[{
       RowBox[{"-", 
        FractionBox["1", "30"]}], " ", "d2", " ", 
       SuperscriptBox["L2", "2"], " ", "m2"}], 
      RowBox[{"-", 
       FractionBox[
        RowBox[{"13", " ", 
         SuperscriptBox["L2", "2"], " ", "m2"}], "420"]}], 
      RowBox[{"-", 
       FractionBox[
        RowBox[{
         SuperscriptBox["L2", "3"], " ", "m2"}], "140"]}], 
      RowBox[{
       RowBox[{
        RowBox[{"-", 
         FractionBox["1", "20"]}], " ", "d2", " ", 
        SuperscriptBox["L2", "2"], " ", "m2"}], "+", 
       RowBox[{
        FractionBox["1", "20"], " ", "d3", " ", 
        SuperscriptBox["L3", "2"], " ", "m3"}]}], 
      RowBox[{
       RowBox[{"-", 
        FractionBox[
         RowBox[{"11", " ", 
          SuperscriptBox["L2", "2"], " ", "m2"}], "210"]}], "+", 
       FractionBox[
        RowBox[{"11", " ", 
         SuperscriptBox["L3", "2"], " ", "m3"}], "210"]}], 
      RowBox[{
       FractionBox[
        RowBox[{
         SuperscriptBox["L2", "3"], " ", "m2"}], "105"], "+", 
       FractionBox[
        RowBox[{
         SuperscriptBox["L3", "3"], " ", "m3"}], "105"]}], 
      RowBox[{
       FractionBox["1", "30"], " ", "d3", " ", 
       SuperscriptBox["L3", "2"], " ", "m3"}], 
      FractionBox[
       RowBox[{"13", " ", 
        SuperscriptBox["L3", "2"], " ", "m3"}], "420"], 
      RowBox[{"-", 
       FractionBox[
        RowBox[{
         SuperscriptBox["L3", "3"], " ", "m3"}], "140"]}]},
     {"0", "0", "0", "0", "0", "0", 
      FractionBox[
       RowBox[{"L3", " ", "\[Rho]Ip3"}], "6"], 
      FractionBox[
       RowBox[{"3", " ", "d3", " ", "L3", " ", "m3"}], "20"], 
      RowBox[{
       FractionBox["1", "30"], " ", "d3", " ", 
       SuperscriptBox["L3", "2"], " ", "m3"}], 
      FractionBox[
       RowBox[{"L3", " ", "\[Rho]Ip3"}], "3"], 
      FractionBox[
       RowBox[{"7", " ", "d3", " ", "L3", " ", "m3"}], "20"], 
      RowBox[{
       RowBox[{"-", 
        FractionBox["1", "20"]}], " ", "d3", " ", 
       SuperscriptBox["L3", "2"], " ", "m3"}]},
     {"0", "0", "0", "0", "0", "0", 
      FractionBox[
       RowBox[{"3", " ", "d3", " ", "L3", " ", "m3"}], "20"], 
      FractionBox[
       RowBox[{"9", " ", "L3", " ", "m3"}], "70"], 
      FractionBox[
       RowBox[{"13", " ", 
        SuperscriptBox["L3", "2"], " ", "m3"}], "420"], 
      FractionBox[
       RowBox[{"7", " ", "d3", " ", "L3", " ", "m3"}], "20"], 
      FractionBox[
       RowBox[{"13", " ", "L3", " ", "m3"}], "35"], 
      RowBox[{"-", 
       FractionBox[
        RowBox[{"11", " ", 
         SuperscriptBox["L3", "2"], " ", "m3"}], "210"]}]},
     {"0", "0", "0", "0", "0", "0", 
      RowBox[{
       RowBox[{"-", 
        FractionBox["1", "30"]}], " ", "d3", " ", 
       SuperscriptBox["L3", "2"], " ", "m3"}], 
      RowBox[{"-", 
       FractionBox[
        RowBox[{"13", " ", 
         SuperscriptBox["L3", "2"], " ", "m3"}], "420"]}], 
      RowBox[{"-", 
       FractionBox[
        RowBox[{
         SuperscriptBox["L3", "3"], " ", "m3"}], "140"]}], 
      RowBox[{
       RowBox[{"-", 
        FractionBox["1", "20"]}], " ", "d3", " ", 
       SuperscriptBox["L3", "2"], " ", "m3"}], 
      RowBox[{"-", 
       FractionBox[
        RowBox[{"11", " ", 
         SuperscriptBox["L3", "2"], " ", "m3"}], "210"]}], 
      FractionBox[
       RowBox[{
        SuperscriptBox["L3", "3"], " ", "m3"}], "105"]}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{3.8531625959361525`*^9, 3.8531628106486206`*^9, 
  3.853321320656988*^9, 3.853501643219702*^9, 3.8535589732498264`*^9},
 CellLabel->
  "Out[63]//MatrixForm=",ExpressionUUID->"6dcd53a4-833d-4d14-803e-\
d99eed82b62b"]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["Aerodynamic Mass Matrix [MMae]", "Section",
 CellChangeTimes->{{3.8531579018704567`*^9, 3.853157920354855*^9}, {
   3.8531631387344275`*^9, 3.8531631436684375`*^9}, {3.853321354899456*^9, 
   3.853321365908455*^9}, {3.8540875439518657`*^9, 3.8540875742964177`*^9}, 
   3.8540899518003464`*^9, {3.8552358257755575`*^9, 3.855235854186878*^9}, {
   3.855235887106062*^9, 3.8552358947834215`*^9}, {3.855288949555648*^9, 
   3.8552889534505835`*^9}},ExpressionUUID->"41427f96-fd3b-4d74-9bb2-\
863783ca6611"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"F", " ", "=", " ", 
     RowBox[{
      RowBox[{
       RowBox[{"BB", ".", "y_ddot"}], " ", "is", " ", "the", " ", "applied", 
       " ", "aerodynamic", " ", "load", " ", "due", " ", "to", " ", 
       "structural", " ", "deformations", "\[IndentingNewLine]", "F"}], " ", 
      "=", " ", 
      RowBox[{
       RowBox[{
        RowBox[{"{", 
         RowBox[{"r", ",", " ", "f", ",", " ", "q"}], "}"}], " ", "..."}], 
       " ", "aerodynamic", " ", "torque"}]}]}], ",", " ", 
    RowBox[{"shear", " ", "force"}], ",", " ", 
    RowBox[{"bending", " ", "moment"}], ",", " ", "respectively", ",", " ", 
    RowBox[{"all", " ", "per", " ", "unit", " ", "length"}], ",", " ", 
    RowBox[{
     RowBox[{
     "due", " ", "to", " ", "acceleration", " ", "of", " ", "DOFs", 
      "\[IndentingNewLine]", "y"}], "=", " ", 
     RowBox[{
      RowBox[{
       RowBox[{"{", 
        RowBox[{"\[Theta]", ",", " ", "v", ",", " ", "\[Beta]"}], "}"}], " ", 
       "..."}], " ", "torsional", " ", "twist"}]}], ",", " ", 
    RowBox[{"out", "-", "of", "-", "plane", "-", "deflection"}], ",", " ", 
    RowBox[{
     RowBox[{"derivative", " ", "of", " ", "the", " ", "out"}], "-", "of", 
     "-", 
     RowBox[{
     "plane", " ", "dflection", " ", "in", " ", "spanwise", " ", "diection", 
      " ", 
      RowBox[{"(", 
       RowBox[{"dv", "/", "dx"}], ")"}]}]}], ",", " ", 
    RowBox[{
     RowBox[{"respectively", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"note", ":", " ", "\[IndentingNewLine]", 
       RowBox[{">", " ", "q"}]}]}], " ", "=", " ", 
     RowBox[{
      RowBox[{
      "0", " ", "since", " ", "aerodynamic", " ", "forces", " ", "do", " ", 
       "not", " ", "induce", " ", "pure", " ", "bending", " ", "moment"}], 
      "\[IndentingNewLine]", ">", " ", 
      RowBox[{
      "aerodynmic", " ", "forces", " ", "do", " ", "not", " ", "depend", " ", 
       "on", " ", 
       RowBox[{
       "\[Beta]", ".", "\[IndentingNewLine]", "\[IndentingNewLine]", 
        "Hence"}], " ", "FF", " ", "has", " ", "zero", " ", "last", " ", 
       "row", " ", "and", " ", 
       RowBox[{"column", "."}]}]}]}]}], "\[IndentingNewLine]", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "matrix", " ", "of", " ", "aerodynamic", " ", "loads", " ", "due", " ", 
    "to", " ", "structural", " ", "displacement"}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"BBaero", " ", "=", " ", 
     RowBox[{"ConstantArray", "[", 
      RowBox[{"0", ",", 
       RowBox[{"{", 
        RowBox[{"3", ",", "3"}], "}"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"BBaero", "[", 
      RowBox[{"[", 
       RowBox[{"1", ",", "1"}], "]"}], "]"}], "=", " ", "B11"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"BBaero", "[", 
      RowBox[{"[", 
       RowBox[{"1", ",", "2"}], "]"}], "]"}], " ", "=", " ", "B12"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"BBaero", "[", 
      RowBox[{"[", 
       RowBox[{"2", ",", "1"}], "]"}], "]"}], " ", "=", " ", "B21"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"BBaero", "[", 
      RowBox[{"[", 
       RowBox[{"2", ",", "2"}], "]"}], "]"}], " ", "=", " ", "B22"}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"Selection", " ", "matrix"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"AAE", " ", "=", " ", 
     RowBox[{"ConstantArray", "[", 
      RowBox[{"0", ",", 
       RowBox[{"{", 
        RowBox[{"3", ",", "6"}], "}"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"AAE", "[", 
      RowBox[{"[", 
       RowBox[{"1", ",", "1"}], "]"}], "]"}], " ", "=", " ", 
     RowBox[{"psi", "[", 
      RowBox[{"[", "1", "]"}], "]"}]}], ";", " ", 
    RowBox[{
     RowBox[{"AAE", "[", 
      RowBox[{"[", 
       RowBox[{"1", ",", "4"}], "]"}], "]"}], " ", "=", " ", 
     RowBox[{"psi", "[", 
      RowBox[{"[", "4", "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"AAE", "[", 
      RowBox[{"[", 
       RowBox[{"2", ",", "2"}], "]"}], "]"}], " ", "=", " ", 
     RowBox[{"psi", "[", 
      RowBox[{"[", "2", "]"}], "]"}]}], ";", " ", 
    RowBox[{
     RowBox[{"AAE", "[", 
      RowBox[{"[", 
       RowBox[{"2", ",", "3"}], "]"}], "]"}], " ", "=", " ", 
     RowBox[{"psi", "[", 
      RowBox[{"[", "3", "]"}], "]"}]}], ";", 
    RowBox[{
     RowBox[{"AAE", "[", 
      RowBox[{"[", 
       RowBox[{"2", ",", "5"}], "]"}], "]"}], " ", "=", " ", 
     RowBox[{"psi", "[", 
      RowBox[{"[", "5", "]"}], "]"}]}], ";", " ", 
    RowBox[{
     RowBox[{"AAE", "[", 
      RowBox[{"[", 
       RowBox[{"2", ",", "6"}], "]"}], "]"}], " ", "=", " ", 
     RowBox[{"psi", "[", 
      RowBox[{"[", "6", "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"AAE", "[", 
      RowBox[{"[", 
       RowBox[{"3", ",", "2"}], "]"}], "]"}], " ", "=", " ", 
     RowBox[{"psi1", "[", 
      RowBox[{"[", "2", "]"}], "]"}]}], ";", " ", 
    RowBox[{
     RowBox[{"AAE", "[", 
      RowBox[{"[", 
       RowBox[{"3", ",", "3"}], "]"}], "]"}], " ", "=", " ", 
     RowBox[{"psi1", "[", 
      RowBox[{"[", "3", "]"}], "]"}]}], ";", 
    RowBox[{
     RowBox[{"AAE", "[", 
      RowBox[{"[", 
       RowBox[{"3", ",", "5"}], "]"}], "]"}], " ", "=", " ", 
     RowBox[{"psi1", "[", 
      RowBox[{"[", "5", "]"}], "]"}]}], ";", " ", 
    RowBox[{
     RowBox[{"AAE", "[", 
      RowBox[{"[", 
       RowBox[{"3", ",", "6"}], "]"}], "]"}], " ", "=", " ", 
     RowBox[{"psi", "[", 
      RowBox[{"[", "6", "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"Aerodynamic", " ", "stiffness", " ", "matrix"}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"nucleusBB", " ", "=", " ", 
     RowBox[{
      SubsuperscriptBox["\[Integral]", "0", "1"], 
      RowBox[{
       RowBox[{
        RowBox[{"Transpose", "[", "AAE", "]"}], ".", "BBaero", ".", "AAE"}], 
       RowBox[{"\[DifferentialD]", "z"}]}]}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"BBaero", "//", "MatrixForm"}], "\[IndentingNewLine]", 
   RowBox[{"AAE", "//", "MatrixForm"}], "\[IndentingNewLine]", 
   RowBox[{"nucleusBB", "//", "MatrixForm"}]}]}]], "Input",
 CellChangeTimes->{{3.853157927540287*^9, 3.8531579712851896`*^9}, {
   3.8531606417896385`*^9, 3.8531608665384884`*^9}, {3.853161144811466*^9, 
   3.853161215210041*^9}, {3.8531613774339037`*^9, 3.8531613793237295`*^9}, {
   3.853319502751261*^9, 3.8533196753294168`*^9}, {3.853325905367114*^9, 
   3.853326000917409*^9}, 3.8533815696576166`*^9, {3.8533816225061693`*^9, 
   3.853381623523614*^9}, {3.8533822562887535`*^9, 3.853382267935441*^9}, {
   3.8533823605534935`*^9, 3.8533823622573633`*^9}, {3.8533837419964933`*^9, 
   3.8533839192815914`*^9}, {3.8533839977608128`*^9, 
   3.8533840971483183`*^9}, {3.8533841481613765`*^9, 3.853384166524573*^9}, {
   3.8552356685178137`*^9, 3.8552357107695303`*^9}, {3.8552359336471777`*^9, 
   3.8552364364476175`*^9}, {3.8552368394300427`*^9, 
   3.8552368396902065`*^9}, {3.855236938143876*^9, 3.855237176106011*^9}, {
   3.8552379038810544`*^9, 3.855237919730572*^9}, {3.855238070691308*^9, 
   3.8552380786210165`*^9}, {3.855238133430924*^9, 3.8552381644405217`*^9}, {
   3.855238216520012*^9, 3.8552382547693844`*^9}, 3.8552386264401813`*^9, 
   3.8552386737497396`*^9, {3.8552396526924877`*^9, 3.85523967556417*^9}, {
   3.855239806302086*^9, 3.8552398116832457`*^9}, {3.855240805901494*^9, 
   3.855240886934605*^9}, {3.8552409657774973`*^9, 3.855241056444127*^9}, {
   3.85528882793454*^9, 3.855288877251585*^9}, {3.8552889797887583`*^9, 
   3.855289005460843*^9}, {3.855299402548148*^9, 3.8552994773152647`*^9}},
 CellLabel->"In[49]:=",ExpressionUUID->"81aaaa0b-f022-4a56-b29a-24c362c2cd01"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"B11", "B12", "0"},
     {"B21", "B22", "0"},
     {"0", "0", "0"}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{{3.855238186690151*^9, 3.8552382229094667`*^9}, 
   3.855238255589301*^9, {3.8552386514698095`*^9, 3.855238674499674*^9}, {
   3.8552396620274334`*^9, 3.8552396765670714`*^9}, 3.8552398132271156`*^9, 
   3.8552408888426256`*^9, {3.8552409741546707`*^9, 3.855241057484248*^9}, 
   3.8552995994234653`*^9},
 CellLabel->
  "Out[59]//MatrixForm=",ExpressionUUID->"c879d2f5-f785-47b8-b6bf-\
bbcad5658568"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      RowBox[{"1", "-", "z"}], "0", "0", "z", "0", "0"},
     {"0", 
      RowBox[{"1", "-", 
       RowBox[{"3", " ", 
        SuperscriptBox["z", "2"]}], "+", 
       RowBox[{"2", " ", 
        SuperscriptBox["z", "3"]}]}], 
      RowBox[{"z", "-", 
       RowBox[{"2", " ", 
        SuperscriptBox["z", "2"]}], "+", 
       SuperscriptBox["z", "3"]}], "0", 
      RowBox[{
       RowBox[{"3", " ", 
        SuperscriptBox["z", "2"]}], "-", 
       RowBox[{"2", " ", 
        SuperscriptBox["z", "3"]}]}], 
      RowBox[{
       RowBox[{"-", 
        SuperscriptBox["z", "2"]}], "+", 
       SuperscriptBox["z", "3"]}]},
     {"0", 
      RowBox[{
       RowBox[{
        RowBox[{"-", "6"}], " ", "z"}], "+", 
       RowBox[{"6", " ", 
        SuperscriptBox["z", "2"]}]}], 
      RowBox[{"1", "-", 
       RowBox[{"4", " ", "z"}], "+", 
       RowBox[{"3", " ", 
        SuperscriptBox["z", "2"]}]}], "0", 
      RowBox[{
       RowBox[{"6", " ", "z"}], "-", 
       RowBox[{"6", " ", 
        SuperscriptBox["z", "2"]}]}], 
      RowBox[{
       RowBox[{"-", 
        SuperscriptBox["z", "2"]}], "+", 
       SuperscriptBox["z", "3"]}]}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{{3.855238186690151*^9, 3.8552382229094667`*^9}, 
   3.855238255589301*^9, {3.8552386514698095`*^9, 3.855238674499674*^9}, {
   3.8552396620274334`*^9, 3.8552396765670714`*^9}, 3.8552398132271156`*^9, 
   3.8552408888426256`*^9, {3.8552409741546707`*^9, 3.855241057484248*^9}, 
   3.8552995994234653`*^9},
 CellLabel->
  "Out[60]//MatrixForm=",ExpressionUUID->"4f98a9ea-5ad3-4b81-9cbe-\
ce68b9265b41"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      FractionBox["B11", "3"], 
      FractionBox[
       RowBox[{"7", " ", "B12"}], "20"], 
      FractionBox["B12", "20"], 
      FractionBox["B11", "6"], 
      FractionBox[
       RowBox[{"3", " ", "B12"}], "20"], 
      RowBox[{"-", 
       FractionBox["B12", "30"]}]},
     {
      FractionBox[
       RowBox[{"7", " ", "B21"}], "20"], 
      FractionBox[
       RowBox[{"13", " ", "B22"}], "35"], 
      FractionBox[
       RowBox[{"11", " ", "B22"}], "210"], 
      FractionBox[
       RowBox[{"3", " ", "B21"}], "20"], 
      FractionBox[
       RowBox[{"9", " ", "B22"}], "70"], 
      RowBox[{"-", 
       FractionBox[
        RowBox[{"13", " ", "B22"}], "420"]}]},
     {
      FractionBox["B21", "20"], 
      FractionBox[
       RowBox[{"11", " ", "B22"}], "210"], 
      FractionBox["B22", "105"], 
      FractionBox["B21", "30"], 
      FractionBox[
       RowBox[{"13", " ", "B22"}], "420"], 
      RowBox[{"-", 
       FractionBox["B22", "140"]}]},
     {
      FractionBox["B11", "6"], 
      FractionBox[
       RowBox[{"3", " ", "B12"}], "20"], 
      FractionBox["B12", "30"], 
      FractionBox["B11", "3"], 
      FractionBox[
       RowBox[{"7", " ", "B12"}], "20"], 
      RowBox[{"-", 
       FractionBox["B12", "20"]}]},
     {
      FractionBox[
       RowBox[{"3", " ", "B21"}], "20"], 
      FractionBox[
       RowBox[{"9", " ", "B22"}], "70"], 
      FractionBox[
       RowBox[{"13", " ", "B22"}], "420"], 
      FractionBox[
       RowBox[{"7", " ", "B21"}], "20"], 
      FractionBox[
       RowBox[{"13", " ", "B22"}], "35"], 
      RowBox[{"-", 
       FractionBox[
        RowBox[{"11", " ", "B22"}], "210"]}]},
     {
      RowBox[{"-", 
       FractionBox["B21", "30"]}], 
      RowBox[{"-", 
       FractionBox[
        RowBox[{"13", " ", "B22"}], "420"]}], 
      RowBox[{"-", 
       FractionBox["B22", "140"]}], 
      RowBox[{"-", 
       FractionBox["B21", "20"]}], 
      RowBox[{"-", 
       FractionBox[
        RowBox[{"11", " ", "B22"}], "210"]}], 
      FractionBox["B22", "105"]}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{{3.855238186690151*^9, 3.8552382229094667`*^9}, 
   3.855238255589301*^9, {3.8552386514698095`*^9, 3.855238674499674*^9}, {
   3.8552396620274334`*^9, 3.8552396765670714`*^9}, 3.8552398132271156`*^9, 
   3.8552408888426256`*^9, {3.8552409741546707`*^9, 3.855241057484248*^9}, 
   3.8552995994234653`*^9},
 CellLabel->
  "Out[61]//MatrixForm=",ExpressionUUID->"8adccc46-a212-471b-bd59-\
0e5617b62344"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"Element", " ", "matrix", " ", "for", " ", "virtual", " ", 
    RowBox[{"work", ":"}]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"BBElem", " ", "=", " ", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"L", "[", 
         RowBox[{"[", "i", "]"}], "]"}], "*", 
        RowBox[{
         RowBox[{"Transpose", "[", 
          RowBox[{"S1", "[", 
           RowBox[{"[", "i", "]"}], "]"}], "]"}], ".", " ", "nucleusBB", ".", 
         RowBox[{"S1", "[", 
          RowBox[{"[", "i", "]"}], "]"}]}]}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "n"}], "}"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"BBElem", "[", 
     RowBox[{"[", "1", "]"}], "]"}], "//", "MatrixForm"}]}]}]], "Input",
 CellChangeTimes->{{3.853161229844341*^9, 3.853161248381115*^9}, {
   3.853161290410644*^9, 3.8531613648317037`*^9}, {3.853161426346966*^9, 
   3.853161432176824*^9}, {3.853161477589877*^9, 3.8531615148437853`*^9}, 
   3.8531615904846325`*^9, {3.853161657239006*^9, 3.8531617697101545`*^9}, 
   3.853161913796624*^9, {3.853320973030608*^9, 3.853321094720787*^9}, {
   3.853326008878501*^9, 3.8533261225563602`*^9}, {3.8533826255393353`*^9, 
   3.853382645440727*^9}, {3.8533827353958683`*^9, 3.8533827517038083`*^9}, {
   3.853382925536919*^9, 3.853382930403367*^9}, {3.85408997039858*^9, 
   3.854089974408881*^9}, {3.8552379651197324`*^9, 3.855237981289532*^9}, {
   3.855238052173264*^9, 3.855238058035369*^9}, {3.855238170410451*^9, 
   3.8552381721504993`*^9}, {3.855238525080803*^9, 3.855238526251401*^9}, 
   3.855239504376459*^9, {3.855299488516838*^9, 3.8552994938683987`*^9}},
 CellLabel->"In[62]:=",ExpressionUUID->"66a99d73-94cb-4368-8bed-0377d17bf6f6"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      FractionBox[
       RowBox[{"B11", " ", "L1"}], "3"], 
      FractionBox[
       RowBox[{"7", " ", "B12", " ", "L1"}], "20"], 
      FractionBox[
       RowBox[{"B12", " ", 
        SuperscriptBox["L1", "2"]}], "20"], 
      FractionBox[
       RowBox[{"B11", " ", "L1"}], "6"], 
      FractionBox[
       RowBox[{"3", " ", "B12", " ", "L1"}], "20"], 
      RowBox[{"-", 
       FractionBox[
        RowBox[{"B12", " ", 
         SuperscriptBox["L1", "2"]}], "30"]}]},
     {
      FractionBox[
       RowBox[{"7", " ", "B21", " ", "L1"}], "20"], 
      FractionBox[
       RowBox[{"13", " ", "B22", " ", "L1"}], "35"], 
      FractionBox[
       RowBox[{"11", " ", "B22", " ", 
        SuperscriptBox["L1", "2"]}], "210"], 
      FractionBox[
       RowBox[{"3", " ", "B21", " ", "L1"}], "20"], 
      FractionBox[
       RowBox[{"9", " ", "B22", " ", "L1"}], "70"], 
      RowBox[{"-", 
       FractionBox[
        RowBox[{"13", " ", "B22", " ", 
         SuperscriptBox["L1", "2"]}], "420"]}]},
     {
      FractionBox[
       RowBox[{"B21", " ", 
        SuperscriptBox["L1", "2"]}], "20"], 
      FractionBox[
       RowBox[{"11", " ", "B22", " ", 
        SuperscriptBox["L1", "2"]}], "210"], 
      FractionBox[
       RowBox[{"B22", " ", 
        SuperscriptBox["L1", "3"]}], "105"], 
      FractionBox[
       RowBox[{"B21", " ", 
        SuperscriptBox["L1", "2"]}], "30"], 
      FractionBox[
       RowBox[{"13", " ", "B22", " ", 
        SuperscriptBox["L1", "2"]}], "420"], 
      RowBox[{"-", 
       FractionBox[
        RowBox[{"B22", " ", 
         SuperscriptBox["L1", "3"]}], "140"]}]},
     {
      FractionBox[
       RowBox[{"B11", " ", "L1"}], "6"], 
      FractionBox[
       RowBox[{"3", " ", "B12", " ", "L1"}], "20"], 
      FractionBox[
       RowBox[{"B12", " ", 
        SuperscriptBox["L1", "2"]}], "30"], 
      FractionBox[
       RowBox[{"B11", " ", "L1"}], "3"], 
      FractionBox[
       RowBox[{"7", " ", "B12", " ", "L1"}], "20"], 
      RowBox[{"-", 
       FractionBox[
        RowBox[{"B12", " ", 
         SuperscriptBox["L1", "2"]}], "20"]}]},
     {
      FractionBox[
       RowBox[{"3", " ", "B21", " ", "L1"}], "20"], 
      FractionBox[
       RowBox[{"9", " ", "B22", " ", "L1"}], "70"], 
      FractionBox[
       RowBox[{"13", " ", "B22", " ", 
        SuperscriptBox["L1", "2"]}], "420"], 
      FractionBox[
       RowBox[{"7", " ", "B21", " ", "L1"}], "20"], 
      FractionBox[
       RowBox[{"13", " ", "B22", " ", "L1"}], "35"], 
      RowBox[{"-", 
       FractionBox[
        RowBox[{"11", " ", "B22", " ", 
         SuperscriptBox["L1", "2"]}], "210"]}]},
     {
      RowBox[{"-", 
       FractionBox[
        RowBox[{"B21", " ", 
         SuperscriptBox["L1", "2"]}], "30"]}], 
      RowBox[{"-", 
       FractionBox[
        RowBox[{"13", " ", "B22", " ", 
         SuperscriptBox["L1", "2"]}], "420"]}], 
      RowBox[{"-", 
       FractionBox[
        RowBox[{"B22", " ", 
         SuperscriptBox["L1", "3"]}], "140"]}], 
      RowBox[{"-", 
       FractionBox[
        RowBox[{"B21", " ", 
         SuperscriptBox["L1", "2"]}], "20"]}], 
      RowBox[{"-", 
       FractionBox[
        RowBox[{"11", " ", "B22", " ", 
         SuperscriptBox["L1", "2"]}], "210"]}], 
      FractionBox[
       RowBox[{"B22", " ", 
        SuperscriptBox["L1", "3"]}], "105"]}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{
  3.8531617702771616`*^9, 3.8533210954773293`*^9, 3.8533212429599123`*^9, 
   3.853321289048753*^9, {3.853382655664691*^9, 3.853382673773075*^9}, 
   3.853382753147375*^9, 3.853382931473474*^9, 3.8533841865642505`*^9, 
   3.853558973321582*^9, 3.8540899929329042`*^9, 3.8540901935554037`*^9, {
   3.855238513366938*^9, 3.855238527136832*^9}, 3.8552410618916225`*^9, 
   3.855299661142968*^9},
 CellLabel->
  "Out[63]//MatrixForm=",ExpressionUUID->"7d18c487-c40e-4edd-8653-\
018ac561c156"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"Global", " ", "aerodynamic", " ", "mass", " ", 
    RowBox[{"matrix", ":"}]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"BB", " ", "=", " ", 
     RowBox[{"ConstantArray", "[", 
      RowBox[{"0", ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"3", "*", 
          RowBox[{"(", 
           RowBox[{"n", "+", "1"}], ")"}]}], ",", " ", 
         RowBox[{"3", "*", 
          RowBox[{"(", 
           RowBox[{"n", "+", "1"}], ")"}]}]}], "}"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Do", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"BB", "[", 
        RowBox[{"[", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"3", "*", "i"}], "-", "2"}], ";;", 
           RowBox[{
            RowBox[{"3", "*", "i"}], "+", "3"}]}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{"3", "*", "i"}], "-", "2"}], ";;", 
           RowBox[{
            RowBox[{"3", "*", "i"}], "+", "3"}]}]}], "]"}], "]"}], " ", "=", 
       "  ", 
       RowBox[{
        RowBox[{"BB", "[", 
         RowBox[{"[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"3", "*", "i"}], "-", "2"}], ";;", 
            RowBox[{
             RowBox[{"3", "*", "i"}], "+", "3"}]}], ",", 
           RowBox[{
            RowBox[{
             RowBox[{"3", "*", "i"}], "-", "2"}], ";;", 
            RowBox[{
             RowBox[{"3", "*", "i"}], "+", "3"}]}]}], "]"}], "]"}], "+", 
        RowBox[{"BBElem", "[", 
         RowBox[{"[", "i", "]"}], "]"}]}]}], " ", ",", 
      RowBox[{"{", 
       RowBox[{"i", ",", "n"}], "}"}]}], "]"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"BB", "//", "MatrixForm"}]}]}]], "Input",
 CellChangeTimes->{{3.8531610319170322`*^9, 3.853161049542431*^9}, {
   3.8531619255992284`*^9, 3.85316197249403*^9}, {3.853162027082408*^9, 
   3.853162033222666*^9}, {3.8531624391565003`*^9, 3.853162466398546*^9}, {
   3.853162513600278*^9, 3.853162589887618*^9}, {3.8531626332898397`*^9, 
   3.853162636461113*^9}, 3.853162809569166*^9, {3.8531628929120197`*^9, 
   3.853162897575876*^9}, {3.8533213021808357`*^9, 3.8533213201194935`*^9}, {
   3.853384230799572*^9, 3.853384250870369*^9}, {3.8540899760485344`*^9, 
   3.854089982517408*^9}, {3.855238005443534*^9, 3.855238063861264*^9}, {
   3.855238543424553*^9, 3.855238543590503*^9}, {3.855299539705959*^9, 
   3.855299558773571*^9}},
 CellLabel->"In[64]:=",ExpressionUUID->"7771bd65-3b40-4ae9-bebb-ff5c26eea1d7"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      FractionBox[
       RowBox[{"B11", " ", "L1"}], "3"], 
      FractionBox[
       RowBox[{"7", " ", "B12", " ", "L1"}], "20"], 
      FractionBox[
       RowBox[{"B12", " ", 
        SuperscriptBox["L1", "2"]}], "20"], 
      FractionBox[
       RowBox[{"B11", " ", "L1"}], "6"], 
      FractionBox[
       RowBox[{"3", " ", "B12", " ", "L1"}], "20"], 
      RowBox[{"-", 
       FractionBox[
        RowBox[{"B12", " ", 
         SuperscriptBox["L1", "2"]}], "30"]}], "0", "0", "0", "0", "0", "0"},
     {
      FractionBox[
       RowBox[{"7", " ", "B21", " ", "L1"}], "20"], 
      FractionBox[
       RowBox[{"13", " ", "B22", " ", "L1"}], "35"], 
      FractionBox[
       RowBox[{"11", " ", "B22", " ", 
        SuperscriptBox["L1", "2"]}], "210"], 
      FractionBox[
       RowBox[{"3", " ", "B21", " ", "L1"}], "20"], 
      FractionBox[
       RowBox[{"9", " ", "B22", " ", "L1"}], "70"], 
      RowBox[{"-", 
       FractionBox[
        RowBox[{"13", " ", "B22", " ", 
         SuperscriptBox["L1", "2"]}], "420"]}], "0", "0", "0", "0", "0", "0"},
     {
      FractionBox[
       RowBox[{"B21", " ", 
        SuperscriptBox["L1", "2"]}], "20"], 
      FractionBox[
       RowBox[{"11", " ", "B22", " ", 
        SuperscriptBox["L1", "2"]}], "210"], 
      FractionBox[
       RowBox[{"B22", " ", 
        SuperscriptBox["L1", "3"]}], "105"], 
      FractionBox[
       RowBox[{"B21", " ", 
        SuperscriptBox["L1", "2"]}], "30"], 
      FractionBox[
       RowBox[{"13", " ", "B22", " ", 
        SuperscriptBox["L1", "2"]}], "420"], 
      RowBox[{"-", 
       FractionBox[
        RowBox[{"B22", " ", 
         SuperscriptBox["L1", "3"]}], "140"]}], "0", "0", "0", "0", "0", "0"},
     {
      FractionBox[
       RowBox[{"B11", " ", "L1"}], "6"], 
      FractionBox[
       RowBox[{"3", " ", "B12", " ", "L1"}], "20"], 
      FractionBox[
       RowBox[{"B12", " ", 
        SuperscriptBox["L1", "2"]}], "30"], 
      RowBox[{
       FractionBox[
        RowBox[{"B11", " ", "L1"}], "3"], "+", 
       FractionBox[
        RowBox[{"B11", " ", "L2"}], "3"]}], 
      RowBox[{
       FractionBox[
        RowBox[{"7", " ", "B12", " ", "L1"}], "20"], "+", 
       FractionBox[
        RowBox[{"7", " ", "B12", " ", "L2"}], "20"]}], 
      RowBox[{
       RowBox[{"-", 
        FractionBox[
         RowBox[{"B12", " ", 
          SuperscriptBox["L1", "2"]}], "20"]}], "+", 
       FractionBox[
        RowBox[{"B12", " ", 
         SuperscriptBox["L2", "2"]}], "20"]}], 
      FractionBox[
       RowBox[{"B11", " ", "L2"}], "6"], 
      FractionBox[
       RowBox[{"3", " ", "B12", " ", "L2"}], "20"], 
      RowBox[{"-", 
       FractionBox[
        RowBox[{"B12", " ", 
         SuperscriptBox["L2", "2"]}], "30"]}], "0", "0", "0"},
     {
      FractionBox[
       RowBox[{"3", " ", "B21", " ", "L1"}], "20"], 
      FractionBox[
       RowBox[{"9", " ", "B22", " ", "L1"}], "70"], 
      FractionBox[
       RowBox[{"13", " ", "B22", " ", 
        SuperscriptBox["L1", "2"]}], "420"], 
      RowBox[{
       FractionBox[
        RowBox[{"7", " ", "B21", " ", "L1"}], "20"], "+", 
       FractionBox[
        RowBox[{"7", " ", "B21", " ", "L2"}], "20"]}], 
      RowBox[{
       FractionBox[
        RowBox[{"13", " ", "B22", " ", "L1"}], "35"], "+", 
       FractionBox[
        RowBox[{"13", " ", "B22", " ", "L2"}], "35"]}], 
      RowBox[{
       RowBox[{"-", 
        FractionBox[
         RowBox[{"11", " ", "B22", " ", 
          SuperscriptBox["L1", "2"]}], "210"]}], "+", 
       FractionBox[
        RowBox[{"11", " ", "B22", " ", 
         SuperscriptBox["L2", "2"]}], "210"]}], 
      FractionBox[
       RowBox[{"3", " ", "B21", " ", "L2"}], "20"], 
      FractionBox[
       RowBox[{"9", " ", "B22", " ", "L2"}], "70"], 
      RowBox[{"-", 
       FractionBox[
        RowBox[{"13", " ", "B22", " ", 
         SuperscriptBox["L2", "2"]}], "420"]}], "0", "0", "0"},
     {
      RowBox[{"-", 
       FractionBox[
        RowBox[{"B21", " ", 
         SuperscriptBox["L1", "2"]}], "30"]}], 
      RowBox[{"-", 
       FractionBox[
        RowBox[{"13", " ", "B22", " ", 
         SuperscriptBox["L1", "2"]}], "420"]}], 
      RowBox[{"-", 
       FractionBox[
        RowBox[{"B22", " ", 
         SuperscriptBox["L1", "3"]}], "140"]}], 
      RowBox[{
       RowBox[{"-", 
        FractionBox[
         RowBox[{"B21", " ", 
          SuperscriptBox["L1", "2"]}], "20"]}], "+", 
       FractionBox[
        RowBox[{"B21", " ", 
         SuperscriptBox["L2", "2"]}], "20"]}], 
      RowBox[{
       RowBox[{"-", 
        FractionBox[
         RowBox[{"11", " ", "B22", " ", 
          SuperscriptBox["L1", "2"]}], "210"]}], "+", 
       FractionBox[
        RowBox[{"11", " ", "B22", " ", 
         SuperscriptBox["L2", "2"]}], "210"]}], 
      RowBox[{
       FractionBox[
        RowBox[{"B22", " ", 
         SuperscriptBox["L1", "3"]}], "105"], "+", 
       FractionBox[
        RowBox[{"B22", " ", 
         SuperscriptBox["L2", "3"]}], "105"]}], 
      FractionBox[
       RowBox[{"B21", " ", 
        SuperscriptBox["L2", "2"]}], "30"], 
      FractionBox[
       RowBox[{"13", " ", "B22", " ", 
        SuperscriptBox["L2", "2"]}], "420"], 
      RowBox[{"-", 
       FractionBox[
        RowBox[{"B22", " ", 
         SuperscriptBox["L2", "3"]}], "140"]}], "0", "0", "0"},
     {"0", "0", "0", 
      FractionBox[
       RowBox[{"B11", " ", "L2"}], "6"], 
      FractionBox[
       RowBox[{"3", " ", "B12", " ", "L2"}], "20"], 
      FractionBox[
       RowBox[{"B12", " ", 
        SuperscriptBox["L2", "2"]}], "30"], 
      RowBox[{
       FractionBox[
        RowBox[{"B11", " ", "L2"}], "3"], "+", 
       FractionBox[
        RowBox[{"B11", " ", "L3"}], "3"]}], 
      RowBox[{
       FractionBox[
        RowBox[{"7", " ", "B12", " ", "L2"}], "20"], "+", 
       FractionBox[
        RowBox[{"7", " ", "B12", " ", "L3"}], "20"]}], 
      RowBox[{
       RowBox[{"-", 
        FractionBox[
         RowBox[{"B12", " ", 
          SuperscriptBox["L2", "2"]}], "20"]}], "+", 
       FractionBox[
        RowBox[{"B12", " ", 
         SuperscriptBox["L3", "2"]}], "20"]}], 
      FractionBox[
       RowBox[{"B11", " ", "L3"}], "6"], 
      FractionBox[
       RowBox[{"3", " ", "B12", " ", "L3"}], "20"], 
      RowBox[{"-", 
       FractionBox[
        RowBox[{"B12", " ", 
         SuperscriptBox["L3", "2"]}], "30"]}]},
     {"0", "0", "0", 
      FractionBox[
       RowBox[{"3", " ", "B21", " ", "L2"}], "20"], 
      FractionBox[
       RowBox[{"9", " ", "B22", " ", "L2"}], "70"], 
      FractionBox[
       RowBox[{"13", " ", "B22", " ", 
        SuperscriptBox["L2", "2"]}], "420"], 
      RowBox[{
       FractionBox[
        RowBox[{"7", " ", "B21", " ", "L2"}], "20"], "+", 
       FractionBox[
        RowBox[{"7", " ", "B21", " ", "L3"}], "20"]}], 
      RowBox[{
       FractionBox[
        RowBox[{"13", " ", "B22", " ", "L2"}], "35"], "+", 
       FractionBox[
        RowBox[{"13", " ", "B22", " ", "L3"}], "35"]}], 
      RowBox[{
       RowBox[{"-", 
        FractionBox[
         RowBox[{"11", " ", "B22", " ", 
          SuperscriptBox["L2", "2"]}], "210"]}], "+", 
       FractionBox[
        RowBox[{"11", " ", "B22", " ", 
         SuperscriptBox["L3", "2"]}], "210"]}], 
      FractionBox[
       RowBox[{"3", " ", "B21", " ", "L3"}], "20"], 
      FractionBox[
       RowBox[{"9", " ", "B22", " ", "L3"}], "70"], 
      RowBox[{"-", 
       FractionBox[
        RowBox[{"13", " ", "B22", " ", 
         SuperscriptBox["L3", "2"]}], "420"]}]},
     {"0", "0", "0", 
      RowBox[{"-", 
       FractionBox[
        RowBox[{"B21", " ", 
         SuperscriptBox["L2", "2"]}], "30"]}], 
      RowBox[{"-", 
       FractionBox[
        RowBox[{"13", " ", "B22", " ", 
         SuperscriptBox["L2", "2"]}], "420"]}], 
      RowBox[{"-", 
       FractionBox[
        RowBox[{"B22", " ", 
         SuperscriptBox["L2", "3"]}], "140"]}], 
      RowBox[{
       RowBox[{"-", 
        FractionBox[
         RowBox[{"B21", " ", 
          SuperscriptBox["L2", "2"]}], "20"]}], "+", 
       FractionBox[
        RowBox[{"B21", " ", 
         SuperscriptBox["L3", "2"]}], "20"]}], 
      RowBox[{
       RowBox[{"-", 
        FractionBox[
         RowBox[{"11", " ", "B22", " ", 
          SuperscriptBox["L2", "2"]}], "210"]}], "+", 
       FractionBox[
        RowBox[{"11", " ", "B22", " ", 
         SuperscriptBox["L3", "2"]}], "210"]}], 
      RowBox[{
       FractionBox[
        RowBox[{"B22", " ", 
         SuperscriptBox["L2", "3"]}], "105"], "+", 
       FractionBox[
        RowBox[{"B22", " ", 
         SuperscriptBox["L3", "3"]}], "105"]}], 
      FractionBox[
       RowBox[{"B21", " ", 
        SuperscriptBox["L3", "2"]}], "30"], 
      FractionBox[
       RowBox[{"13", " ", "B22", " ", 
        SuperscriptBox["L3", "2"]}], "420"], 
      RowBox[{"-", 
       FractionBox[
        RowBox[{"B22", " ", 
         SuperscriptBox["L3", "3"]}], "140"]}]},
     {"0", "0", "0", "0", "0", "0", 
      FractionBox[
       RowBox[{"B11", " ", "L3"}], "6"], 
      FractionBox[
       RowBox[{"3", " ", "B12", " ", "L3"}], "20"], 
      FractionBox[
       RowBox[{"B12", " ", 
        SuperscriptBox["L3", "2"]}], "30"], 
      FractionBox[
       RowBox[{"B11", " ", "L3"}], "3"], 
      FractionBox[
       RowBox[{"7", " ", "B12", " ", "L3"}], "20"], 
      RowBox[{"-", 
       FractionBox[
        RowBox[{"B12", " ", 
         SuperscriptBox["L3", "2"]}], "20"]}]},
     {"0", "0", "0", "0", "0", "0", 
      FractionBox[
       RowBox[{"3", " ", "B21", " ", "L3"}], "20"], 
      FractionBox[
       RowBox[{"9", " ", "B22", " ", "L3"}], "70"], 
      FractionBox[
       RowBox[{"13", " ", "B22", " ", 
        SuperscriptBox["L3", "2"]}], "420"], 
      FractionBox[
       RowBox[{"7", " ", "B21", " ", "L3"}], "20"], 
      FractionBox[
       RowBox[{"13", " ", "B22", " ", "L3"}], "35"], 
      RowBox[{"-", 
       FractionBox[
        RowBox[{"11", " ", "B22", " ", 
         SuperscriptBox["L3", "2"]}], "210"]}]},
     {"0", "0", "0", "0", "0", "0", 
      RowBox[{"-", 
       FractionBox[
        RowBox[{"B21", " ", 
         SuperscriptBox["L3", "2"]}], "30"]}], 
      RowBox[{"-", 
       FractionBox[
        RowBox[{"13", " ", "B22", " ", 
         SuperscriptBox["L3", "2"]}], "420"]}], 
      RowBox[{"-", 
       FractionBox[
        RowBox[{"B22", " ", 
         SuperscriptBox["L3", "3"]}], "140"]}], 
      RowBox[{"-", 
       FractionBox[
        RowBox[{"B21", " ", 
         SuperscriptBox["L3", "2"]}], "20"]}], 
      RowBox[{"-", 
       FractionBox[
        RowBox[{"11", " ", "B22", " ", 
         SuperscriptBox["L3", "2"]}], "210"]}], 
      FractionBox[
       RowBox[{"B22", " ", 
        SuperscriptBox["L3", "3"]}], "105"]}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{
  3.8531625959361525`*^9, 3.8531628106486206`*^9, 3.853321320656988*^9, 
   3.8533842512456656`*^9, 3.8535589733431253`*^9, 3.854089995858659*^9, 
   3.8540901971195664`*^9, {3.8552385381745963`*^9, 3.8552385443945894`*^9}, 
   3.8552996708129935`*^9},
 CellLabel->
  "Out[66]//MatrixForm=",ExpressionUUID->"12870d47-8846-434b-b411-\
b2a8cc30b73a"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Aerodynamic Damping Matrix [CCae]", "Section",
 CellChangeTimes->{{3.8531579018704567`*^9, 3.853157920354855*^9}, {
   3.8531631387344275`*^9, 3.8531631436684375`*^9}, {3.853321354899456*^9, 
   3.853321365908455*^9}, {3.8540875439518657`*^9, 3.8540875742964177`*^9}, 
   3.8540899518003464`*^9, {3.8552358257755575`*^9, 3.855235854186878*^9}, {
   3.855235887106062*^9, 3.8552358947834215`*^9}, {3.855288949555648*^9, 
   3.8552889534505835`*^9}, {3.8552997123676186`*^9, 
   3.855299720732577*^9}},ExpressionUUID->"8e1db90c-4305-4e3c-a654-\
fc29d0462de0"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"F", " ", "=", " ", 
     RowBox[{
      RowBox[{
       RowBox[{"DD", ".", "y_dot"}], " ", "is", " ", "the", " ", "applied", 
       " ", "aerodynamic", " ", "load", " ", "due", " ", "to", " ", "the", 
       " ", "rate", " ", "of", " ", "structural", " ", "deformations", 
       "\[IndentingNewLine]", "F"}], " ", "=", " ", 
      RowBox[{
       RowBox[{
        RowBox[{"{", 
         RowBox[{"r", ",", " ", "f", ",", " ", "q"}], "}"}], " ", "..."}], 
       " ", "aerodynamic", " ", "torque"}]}]}], ",", " ", 
    RowBox[{"shear", " ", "force"}], ",", " ", 
    RowBox[{"bending", " ", "moment"}], ",", " ", "respectively", ",", " ", 
    RowBox[{"all", " ", "per", " ", "unit", " ", "length"}], ",", " ", 
    RowBox[{
     RowBox[{
     "due", " ", "to", " ", "rate", " ", "of", " ", "DOFs", 
      "\[IndentingNewLine]", "y"}], "=", " ", 
     RowBox[{
      RowBox[{
       RowBox[{"{", 
        RowBox[{"\[Theta]", ",", " ", "v", ",", " ", "\[Beta]"}], "}"}], " ", 
       "..."}], " ", "torsional", " ", "twist"}]}], ",", " ", 
    RowBox[{"out", "-", "of", "-", "plane", "-", "deflection"}], ",", " ", 
    RowBox[{
     RowBox[{"derivative", " ", "of", " ", "the", " ", "out"}], "-", "of", 
     "-", 
     RowBox[{
     "plane", " ", "dflection", " ", "in", " ", "spanwise", " ", "diection", 
      " ", 
      RowBox[{"(", 
       RowBox[{"dv", "/", "dx"}], ")"}]}]}], ",", " ", 
    RowBox[{
     RowBox[{"respectively", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"note", ":", " ", "\[IndentingNewLine]", 
       RowBox[{">", " ", "q"}]}]}], " ", "=", " ", 
     RowBox[{
      RowBox[{
      "0", " ", "since", " ", "aerodynamic", " ", "forces", " ", "do", " ", 
       "not", " ", "induce", " ", "pure", " ", "bending", " ", "moment"}], 
      "\[IndentingNewLine]", ">", " ", 
      RowBox[{
      "aerodynmic", " ", "forces", " ", "do", " ", "not", " ", "depend", " ", 
       "on", " ", 
       RowBox[{
       "\[Beta]", ".", "\[IndentingNewLine]", "\[IndentingNewLine]", 
        "Hence"}], " ", "FF", " ", "has", " ", "zero", " ", "last", " ", 
       "row", " ", "and", " ", 
       RowBox[{"column", "."}]}]}]}]}], "\[IndentingNewLine]", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "matrix", " ", "of", " ", "aerodynamic", " ", "loads", " ", "due", " ", 
    "to", " ", "structural", " ", "displacement"}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"DDaero", " ", "=", " ", 
     RowBox[{"ConstantArray", "[", 
      RowBox[{"0", ",", 
       RowBox[{"{", 
        RowBox[{"3", ",", "3"}], "}"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"DDaero", "[", 
      RowBox[{"[", 
       RowBox[{"1", ",", "1"}], "]"}], "]"}], "=", " ", "D11"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"DDaero", "[", 
      RowBox[{"[", 
       RowBox[{"1", ",", "2"}], "]"}], "]"}], " ", "=", " ", "D12"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"DDaero", "[", 
      RowBox[{"[", 
       RowBox[{"2", ",", "1"}], "]"}], "]"}], " ", "=", " ", "D21"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"DDaero", "[", 
      RowBox[{"[", 
       RowBox[{"2", ",", "2"}], "]"}], "]"}], " ", "=", " ", "D22"}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"Selection", " ", "matrix"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"AAE", " ", "=", " ", 
     RowBox[{"ConstantArray", "[", 
      RowBox[{"0", ",", 
       RowBox[{"{", 
        RowBox[{"3", ",", "6"}], "}"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"AAE", "[", 
      RowBox[{"[", 
       RowBox[{"1", ",", "1"}], "]"}], "]"}], " ", "=", " ", 
     RowBox[{"psi", "[", 
      RowBox[{"[", "1", "]"}], "]"}]}], ";", " ", 
    RowBox[{
     RowBox[{"AAE", "[", 
      RowBox[{"[", 
       RowBox[{"1", ",", "4"}], "]"}], "]"}], " ", "=", " ", 
     RowBox[{"psi", "[", 
      RowBox[{"[", "4", "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"AAE", "[", 
      RowBox[{"[", 
       RowBox[{"2", ",", "2"}], "]"}], "]"}], " ", "=", " ", 
     RowBox[{"psi", "[", 
      RowBox[{"[", "2", "]"}], "]"}]}], ";", " ", 
    RowBox[{
     RowBox[{"AAE", "[", 
      RowBox[{"[", 
       RowBox[{"2", ",", "3"}], "]"}], "]"}], " ", "=", " ", 
     RowBox[{"psi", "[", 
      RowBox[{"[", "3", "]"}], "]"}]}], ";", 
    RowBox[{
     RowBox[{"AAE", "[", 
      RowBox[{"[", 
       RowBox[{"2", ",", "5"}], "]"}], "]"}], " ", "=", " ", 
     RowBox[{"psi", "[", 
      RowBox[{"[", "5", "]"}], "]"}]}], ";", " ", 
    RowBox[{
     RowBox[{"AAE", "[", 
      RowBox[{"[", 
       RowBox[{"2", ",", "6"}], "]"}], "]"}], " ", "=", " ", 
     RowBox[{"psi", "[", 
      RowBox[{"[", "6", "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"AAE", "[", 
      RowBox[{"[", 
       RowBox[{"3", ",", "2"}], "]"}], "]"}], " ", "=", " ", 
     RowBox[{"psi1", "[", 
      RowBox[{"[", "2", "]"}], "]"}]}], ";", " ", 
    RowBox[{
     RowBox[{"AAE", "[", 
      RowBox[{"[", 
       RowBox[{"3", ",", "3"}], "]"}], "]"}], " ", "=", " ", 
     RowBox[{"psi1", "[", 
      RowBox[{"[", "3", "]"}], "]"}]}], ";", 
    RowBox[{
     RowBox[{"AAE", "[", 
      RowBox[{"[", 
       RowBox[{"3", ",", "5"}], "]"}], "]"}], " ", "=", " ", 
     RowBox[{"psi1", "[", 
      RowBox[{"[", "5", "]"}], "]"}]}], ";", " ", 
    RowBox[{
     RowBox[{"AAE", "[", 
      RowBox[{"[", 
       RowBox[{"3", ",", "6"}], "]"}], "]"}], " ", "=", " ", 
     RowBox[{"psi", "[", 
      RowBox[{"[", "6", "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"Aerodynamic", " ", "stiffness", " ", "matrix"}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"nucleusDD", " ", "=", " ", 
     RowBox[{
      SubsuperscriptBox["\[Integral]", "0", "1"], 
      RowBox[{
       RowBox[{
        RowBox[{"Transpose", "[", "AAE", "]"}], ".", "DDaero", ".", "AAE"}], 
       RowBox[{"\[DifferentialD]", "z"}]}]}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"DDaero", "//", "MatrixForm"}], "\[IndentingNewLine]", 
   RowBox[{"AAE", "//", "MatrixForm"}], "\[IndentingNewLine]", 
   RowBox[{"nucleusDD", "//", "MatrixForm"}]}]}]], "Input",
 CellChangeTimes->{{3.853157927540287*^9, 3.8531579712851896`*^9}, {
   3.8531606417896385`*^9, 3.8531608665384884`*^9}, {3.853161144811466*^9, 
   3.853161215210041*^9}, {3.8531613774339037`*^9, 3.8531613793237295`*^9}, {
   3.853319502751261*^9, 3.8533196753294168`*^9}, {3.853325905367114*^9, 
   3.853326000917409*^9}, 3.8533815696576166`*^9, {3.8533816225061693`*^9, 
   3.853381623523614*^9}, {3.8533822562887535`*^9, 3.853382267935441*^9}, {
   3.8533823605534935`*^9, 3.8533823622573633`*^9}, {3.8533837419964933`*^9, 
   3.8533839192815914`*^9}, {3.8533839977608128`*^9, 
   3.8533840971483183`*^9}, {3.8533841481613765`*^9, 3.853384166524573*^9}, {
   3.8552356685178137`*^9, 3.8552357107695303`*^9}, {3.8552359336471777`*^9, 
   3.8552364364476175`*^9}, {3.8552368394300427`*^9, 
   3.8552368396902065`*^9}, {3.855236938143876*^9, 3.855237176106011*^9}, {
   3.8552379038810544`*^9, 3.855237919730572*^9}, {3.855238070691308*^9, 
   3.8552380786210165`*^9}, {3.855238133430924*^9, 3.8552381644405217`*^9}, {
   3.855238216520012*^9, 3.8552382547693844`*^9}, 3.8552386264401813`*^9, 
   3.8552386737497396`*^9, {3.8552396526924877`*^9, 3.85523967556417*^9}, {
   3.855239806302086*^9, 3.8552398116832457`*^9}, {3.855240805901494*^9, 
   3.855240886934605*^9}, {3.8552409657774973`*^9, 3.855241056444127*^9}, {
   3.85528882793454*^9, 3.855288877251585*^9}, {3.8552889797887583`*^9, 
   3.855289005460843*^9}, {3.855299402548148*^9, 3.8552994773152647`*^9}, {
   3.8552997493817415`*^9, 3.8552998148512907`*^9}},
 CellLabel->"In[67]:=",ExpressionUUID->"880eb7e2-b2d8-4c0e-9588-0dceb74e83e1"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"D11", "D12", "0"},
     {"D21", "D22", "0"},
     {"0", "0", "0"}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{{3.855238186690151*^9, 3.8552382229094667`*^9}, 
   3.855238255589301*^9, {3.8552386514698095`*^9, 3.855238674499674*^9}, {
   3.8552396620274334`*^9, 3.8552396765670714`*^9}, 3.8552398132271156`*^9, 
   3.8552408888426256`*^9, {3.8552409741546707`*^9, 3.855241057484248*^9}, 
   3.8552995994234653`*^9, 3.85529988599081*^9},
 CellLabel->
  "Out[77]//MatrixForm=",ExpressionUUID->"950b9764-64da-4fbb-b1a5-\
2bbce6c4ed1b"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      RowBox[{"1", "-", "z"}], "0", "0", "z", "0", "0"},
     {"0", 
      RowBox[{"1", "-", 
       RowBox[{"3", " ", 
        SuperscriptBox["z", "2"]}], "+", 
       RowBox[{"2", " ", 
        SuperscriptBox["z", "3"]}]}], 
      RowBox[{"z", "-", 
       RowBox[{"2", " ", 
        SuperscriptBox["z", "2"]}], "+", 
       SuperscriptBox["z", "3"]}], "0", 
      RowBox[{
       RowBox[{"3", " ", 
        SuperscriptBox["z", "2"]}], "-", 
       RowBox[{"2", " ", 
        SuperscriptBox["z", "3"]}]}], 
      RowBox[{
       RowBox[{"-", 
        SuperscriptBox["z", "2"]}], "+", 
       SuperscriptBox["z", "3"]}]},
     {"0", 
      RowBox[{
       RowBox[{
        RowBox[{"-", "6"}], " ", "z"}], "+", 
       RowBox[{"6", " ", 
        SuperscriptBox["z", "2"]}]}], 
      RowBox[{"1", "-", 
       RowBox[{"4", " ", "z"}], "+", 
       RowBox[{"3", " ", 
        SuperscriptBox["z", "2"]}]}], "0", 
      RowBox[{
       RowBox[{"6", " ", "z"}], "-", 
       RowBox[{"6", " ", 
        SuperscriptBox["z", "2"]}]}], 
      RowBox[{
       RowBox[{"-", 
        SuperscriptBox["z", "2"]}], "+", 
       SuperscriptBox["z", "3"]}]}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{{3.855238186690151*^9, 3.8552382229094667`*^9}, 
   3.855238255589301*^9, {3.8552386514698095`*^9, 3.855238674499674*^9}, {
   3.8552396620274334`*^9, 3.8552396765670714`*^9}, 3.8552398132271156`*^9, 
   3.8552408888426256`*^9, {3.8552409741546707`*^9, 3.855241057484248*^9}, 
   3.8552995994234653`*^9, 3.855299886000518*^9},
 CellLabel->
  "Out[78]//MatrixForm=",ExpressionUUID->"072b9952-ff21-438e-8cb3-\
b4ff26438df2"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      FractionBox["D11", "3"], 
      FractionBox[
       RowBox[{"7", " ", "D12"}], "20"], 
      FractionBox["D12", "20"], 
      FractionBox["D11", "6"], 
      FractionBox[
       RowBox[{"3", " ", "D12"}], "20"], 
      RowBox[{"-", 
       FractionBox["D12", "30"]}]},
     {
      FractionBox[
       RowBox[{"7", " ", "D21"}], "20"], 
      FractionBox[
       RowBox[{"13", " ", "D22"}], "35"], 
      FractionBox[
       RowBox[{"11", " ", "D22"}], "210"], 
      FractionBox[
       RowBox[{"3", " ", "D21"}], "20"], 
      FractionBox[
       RowBox[{"9", " ", "D22"}], "70"], 
      RowBox[{"-", 
       FractionBox[
        RowBox[{"13", " ", "D22"}], "420"]}]},
     {
      FractionBox["D21", "20"], 
      FractionBox[
       RowBox[{"11", " ", "D22"}], "210"], 
      FractionBox["D22", "105"], 
      FractionBox["D21", "30"], 
      FractionBox[
       RowBox[{"13", " ", "D22"}], "420"], 
      RowBox[{"-", 
       FractionBox["D22", "140"]}]},
     {
      FractionBox["D11", "6"], 
      FractionBox[
       RowBox[{"3", " ", "D12"}], "20"], 
      FractionBox["D12", "30"], 
      FractionBox["D11", "3"], 
      FractionBox[
       RowBox[{"7", " ", "D12"}], "20"], 
      RowBox[{"-", 
       FractionBox["D12", "20"]}]},
     {
      FractionBox[
       RowBox[{"3", " ", "D21"}], "20"], 
      FractionBox[
       RowBox[{"9", " ", "D22"}], "70"], 
      FractionBox[
       RowBox[{"13", " ", "D22"}], "420"], 
      FractionBox[
       RowBox[{"7", " ", "D21"}], "20"], 
      FractionBox[
       RowBox[{"13", " ", "D22"}], "35"], 
      RowBox[{"-", 
       FractionBox[
        RowBox[{"11", " ", "D22"}], "210"]}]},
     {
      RowBox[{"-", 
       FractionBox["D21", "30"]}], 
      RowBox[{"-", 
       FractionBox[
        RowBox[{"13", " ", "D22"}], "420"]}], 
      RowBox[{"-", 
       FractionBox["D22", "140"]}], 
      RowBox[{"-", 
       FractionBox["D21", "20"]}], 
      RowBox[{"-", 
       FractionBox[
        RowBox[{"11", " ", "D22"}], "210"]}], 
      FractionBox["D22", "105"]}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{{3.855238186690151*^9, 3.8552382229094667`*^9}, 
   3.855238255589301*^9, {3.8552386514698095`*^9, 3.855238674499674*^9}, {
   3.8552396620274334`*^9, 3.8552396765670714`*^9}, 3.8552398132271156`*^9, 
   3.8552408888426256`*^9, {3.8552409741546707`*^9, 3.855241057484248*^9}, 
   3.8552995994234653`*^9, 3.855299886000518*^9},
 CellLabel->
  "Out[79]//MatrixForm=",ExpressionUUID->"0f11422b-3c31-4923-a625-\
4aedbd6cda5e"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"Element", " ", "matrix", " ", "for", " ", "virtual", " ", 
    RowBox[{"work", ":"}]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"DDElem", " ", "=", " ", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"L", "[", 
         RowBox[{"[", "i", "]"}], "]"}], "*", 
        RowBox[{
         RowBox[{"Transpose", "[", 
          RowBox[{"S1", "[", 
           RowBox[{"[", "i", "]"}], "]"}], "]"}], ".", " ", "nucleusDD", ".", 
         RowBox[{"S1", "[", 
          RowBox[{"[", "i", "]"}], "]"}]}]}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "n"}], "}"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"DDElem", "[", 
     RowBox[{"[", "1", "]"}], "]"}], "//", "MatrixForm"}]}]}]], "Input",
 CellChangeTimes->{{3.853161229844341*^9, 3.853161248381115*^9}, {
   3.853161290410644*^9, 3.8531613648317037`*^9}, {3.853161426346966*^9, 
   3.853161432176824*^9}, {3.853161477589877*^9, 3.8531615148437853`*^9}, 
   3.8531615904846325`*^9, {3.853161657239006*^9, 3.8531617697101545`*^9}, 
   3.853161913796624*^9, {3.853320973030608*^9, 3.853321094720787*^9}, {
   3.853326008878501*^9, 3.8533261225563602`*^9}, {3.8533826255393353`*^9, 
   3.853382645440727*^9}, {3.8533827353958683`*^9, 3.8533827517038083`*^9}, {
   3.853382925536919*^9, 3.853382930403367*^9}, {3.85408997039858*^9, 
   3.854089974408881*^9}, {3.8552379651197324`*^9, 3.855237981289532*^9}, {
   3.855238052173264*^9, 3.855238058035369*^9}, {3.855238170410451*^9, 
   3.8552381721504993`*^9}, {3.855238525080803*^9, 3.855238526251401*^9}, 
   3.855239504376459*^9, {3.855299488516838*^9, 3.8552994938683987`*^9}, {
   3.855299821591254*^9, 3.8552998289509964`*^9}},
 CellLabel->"In[80]:=",ExpressionUUID->"cf1cedfd-7add-4256-b99d-49d43724eca6"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      FractionBox[
       RowBox[{"D11", " ", "L1"}], "3"], 
      FractionBox[
       RowBox[{"7", " ", "D12", " ", "L1"}], "20"], 
      FractionBox[
       RowBox[{"D12", " ", 
        SuperscriptBox["L1", "2"]}], "20"], 
      FractionBox[
       RowBox[{"D11", " ", "L1"}], "6"], 
      FractionBox[
       RowBox[{"3", " ", "D12", " ", "L1"}], "20"], 
      RowBox[{"-", 
       FractionBox[
        RowBox[{"D12", " ", 
         SuperscriptBox["L1", "2"]}], "30"]}]},
     {
      FractionBox[
       RowBox[{"7", " ", "D21", " ", "L1"}], "20"], 
      FractionBox[
       RowBox[{"13", " ", "D22", " ", "L1"}], "35"], 
      FractionBox[
       RowBox[{"11", " ", "D22", " ", 
        SuperscriptBox["L1", "2"]}], "210"], 
      FractionBox[
       RowBox[{"3", " ", "D21", " ", "L1"}], "20"], 
      FractionBox[
       RowBox[{"9", " ", "D22", " ", "L1"}], "70"], 
      RowBox[{"-", 
       FractionBox[
        RowBox[{"13", " ", "D22", " ", 
         SuperscriptBox["L1", "2"]}], "420"]}]},
     {
      FractionBox[
       RowBox[{"D21", " ", 
        SuperscriptBox["L1", "2"]}], "20"], 
      FractionBox[
       RowBox[{"11", " ", "D22", " ", 
        SuperscriptBox["L1", "2"]}], "210"], 
      FractionBox[
       RowBox[{"D22", " ", 
        SuperscriptBox["L1", "3"]}], "105"], 
      FractionBox[
       RowBox[{"D21", " ", 
        SuperscriptBox["L1", "2"]}], "30"], 
      FractionBox[
       RowBox[{"13", " ", "D22", " ", 
        SuperscriptBox["L1", "2"]}], "420"], 
      RowBox[{"-", 
       FractionBox[
        RowBox[{"D22", " ", 
         SuperscriptBox["L1", "3"]}], "140"]}]},
     {
      FractionBox[
       RowBox[{"D11", " ", "L1"}], "6"], 
      FractionBox[
       RowBox[{"3", " ", "D12", " ", "L1"}], "20"], 
      FractionBox[
       RowBox[{"D12", " ", 
        SuperscriptBox["L1", "2"]}], "30"], 
      FractionBox[
       RowBox[{"D11", " ", "L1"}], "3"], 
      FractionBox[
       RowBox[{"7", " ", "D12", " ", "L1"}], "20"], 
      RowBox[{"-", 
       FractionBox[
        RowBox[{"D12", " ", 
         SuperscriptBox["L1", "2"]}], "20"]}]},
     {
      FractionBox[
       RowBox[{"3", " ", "D21", " ", "L1"}], "20"], 
      FractionBox[
       RowBox[{"9", " ", "D22", " ", "L1"}], "70"], 
      FractionBox[
       RowBox[{"13", " ", "D22", " ", 
        SuperscriptBox["L1", "2"]}], "420"], 
      FractionBox[
       RowBox[{"7", " ", "D21", " ", "L1"}], "20"], 
      FractionBox[
       RowBox[{"13", " ", "D22", " ", "L1"}], "35"], 
      RowBox[{"-", 
       FractionBox[
        RowBox[{"11", " ", "D22", " ", 
         SuperscriptBox["L1", "2"]}], "210"]}]},
     {
      RowBox[{"-", 
       FractionBox[
        RowBox[{"D21", " ", 
         SuperscriptBox["L1", "2"]}], "30"]}], 
      RowBox[{"-", 
       FractionBox[
        RowBox[{"13", " ", "D22", " ", 
         SuperscriptBox["L1", "2"]}], "420"]}], 
      RowBox[{"-", 
       FractionBox[
        RowBox[{"D22", " ", 
         SuperscriptBox["L1", "3"]}], "140"]}], 
      RowBox[{"-", 
       FractionBox[
        RowBox[{"D21", " ", 
         SuperscriptBox["L1", "2"]}], "20"]}], 
      RowBox[{"-", 
       FractionBox[
        RowBox[{"11", " ", "D22", " ", 
         SuperscriptBox["L1", "2"]}], "210"]}], 
      FractionBox[
       RowBox[{"D22", " ", 
        SuperscriptBox["L1", "3"]}], "105"]}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{
  3.8531617702771616`*^9, 3.8533210954773293`*^9, 3.8533212429599123`*^9, 
   3.853321289048753*^9, {3.853382655664691*^9, 3.853382673773075*^9}, 
   3.853382753147375*^9, 3.853382931473474*^9, 3.8533841865642505`*^9, 
   3.853558973321582*^9, 3.8540899929329042`*^9, 3.8540901935554037`*^9, {
   3.855238513366938*^9, 3.855238527136832*^9}, 3.8552410618916225`*^9, 
   3.855299661142968*^9, 3.8552998898604307`*^9},
 CellLabel->
  "Out[81]//MatrixForm=",ExpressionUUID->"5c0a3d20-708d-40dd-8113-\
42200a2c5aae"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"Global", " ", "aerodynamic", " ", "mass", " ", 
    RowBox[{"matrix", ":"}]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"DD", " ", "=", " ", 
     RowBox[{"ConstantArray", "[", 
      RowBox[{"0", ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"3", "*", 
          RowBox[{"(", 
           RowBox[{"n", "+", "1"}], ")"}]}], ",", " ", 
         RowBox[{"3", "*", 
          RowBox[{"(", 
           RowBox[{"n", "+", "1"}], ")"}]}]}], "}"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Do", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"DD", "[", 
        RowBox[{"[", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"3", "*", "i"}], "-", "2"}], ";;", 
           RowBox[{
            RowBox[{"3", "*", "i"}], "+", "3"}]}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{"3", "*", "i"}], "-", "2"}], ";;", 
           RowBox[{
            RowBox[{"3", "*", "i"}], "+", "3"}]}]}], "]"}], "]"}], " ", "=", 
       "  ", 
       RowBox[{
        RowBox[{"DD", "[", 
         RowBox[{"[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"3", "*", "i"}], "-", "2"}], ";;", 
            RowBox[{
             RowBox[{"3", "*", "i"}], "+", "3"}]}], ",", 
           RowBox[{
            RowBox[{
             RowBox[{"3", "*", "i"}], "-", "2"}], ";;", 
            RowBox[{
             RowBox[{"3", "*", "i"}], "+", "3"}]}]}], "]"}], "]"}], "+", 
        RowBox[{"DDElem", "[", 
         RowBox[{"[", "i", "]"}], "]"}]}]}], " ", ",", 
      RowBox[{"{", 
       RowBox[{"i", ",", "n"}], "}"}]}], "]"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"DD", "//", "MatrixForm"}]}]}]], "Input",
 CellChangeTimes->{{3.8531610319170322`*^9, 3.853161049542431*^9}, {
   3.8531619255992284`*^9, 3.85316197249403*^9}, {3.853162027082408*^9, 
   3.853162033222666*^9}, {3.8531624391565003`*^9, 3.853162466398546*^9}, {
   3.853162513600278*^9, 3.853162589887618*^9}, {3.8531626332898397`*^9, 
   3.853162636461113*^9}, 3.853162809569166*^9, {3.8531628929120197`*^9, 
   3.853162897575876*^9}, {3.8533213021808357`*^9, 3.8533213201194935`*^9}, {
   3.853384230799572*^9, 3.853384250870369*^9}, {3.8540899760485344`*^9, 
   3.854089982517408*^9}, {3.855238005443534*^9, 3.855238063861264*^9}, {
   3.855238543424553*^9, 3.855238543590503*^9}, {3.855299539705959*^9, 
   3.855299558773571*^9}, {3.855299834361402*^9, 3.8552998501811066`*^9}},
 CellLabel->"In[82]:=",ExpressionUUID->"2efb00a0-855c-4736-bea0-2e6d7c791f12"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      FractionBox[
       RowBox[{"D11", " ", "L1"}], "3"], 
      FractionBox[
       RowBox[{"7", " ", "D12", " ", "L1"}], "20"], 
      FractionBox[
       RowBox[{"D12", " ", 
        SuperscriptBox["L1", "2"]}], "20"], 
      FractionBox[
       RowBox[{"D11", " ", "L1"}], "6"], 
      FractionBox[
       RowBox[{"3", " ", "D12", " ", "L1"}], "20"], 
      RowBox[{"-", 
       FractionBox[
        RowBox[{"D12", " ", 
         SuperscriptBox["L1", "2"]}], "30"]}], "0", "0", "0", "0", "0", "0"},
     {
      FractionBox[
       RowBox[{"7", " ", "D21", " ", "L1"}], "20"], 
      FractionBox[
       RowBox[{"13", " ", "D22", " ", "L1"}], "35"], 
      FractionBox[
       RowBox[{"11", " ", "D22", " ", 
        SuperscriptBox["L1", "2"]}], "210"], 
      FractionBox[
       RowBox[{"3", " ", "D21", " ", "L1"}], "20"], 
      FractionBox[
       RowBox[{"9", " ", "D22", " ", "L1"}], "70"], 
      RowBox[{"-", 
       FractionBox[
        RowBox[{"13", " ", "D22", " ", 
         SuperscriptBox["L1", "2"]}], "420"]}], "0", "0", "0", "0", "0", "0"},
     {
      FractionBox[
       RowBox[{"D21", " ", 
        SuperscriptBox["L1", "2"]}], "20"], 
      FractionBox[
       RowBox[{"11", " ", "D22", " ", 
        SuperscriptBox["L1", "2"]}], "210"], 
      FractionBox[
       RowBox[{"D22", " ", 
        SuperscriptBox["L1", "3"]}], "105"], 
      FractionBox[
       RowBox[{"D21", " ", 
        SuperscriptBox["L1", "2"]}], "30"], 
      FractionBox[
       RowBox[{"13", " ", "D22", " ", 
        SuperscriptBox["L1", "2"]}], "420"], 
      RowBox[{"-", 
       FractionBox[
        RowBox[{"D22", " ", 
         SuperscriptBox["L1", "3"]}], "140"]}], "0", "0", "0", "0", "0", "0"},
     {
      FractionBox[
       RowBox[{"D11", " ", "L1"}], "6"], 
      FractionBox[
       RowBox[{"3", " ", "D12", " ", "L1"}], "20"], 
      FractionBox[
       RowBox[{"D12", " ", 
        SuperscriptBox["L1", "2"]}], "30"], 
      RowBox[{
       FractionBox[
        RowBox[{"D11", " ", "L1"}], "3"], "+", 
       FractionBox[
        RowBox[{"D11", " ", "L2"}], "3"]}], 
      RowBox[{
       FractionBox[
        RowBox[{"7", " ", "D12", " ", "L1"}], "20"], "+", 
       FractionBox[
        RowBox[{"7", " ", "D12", " ", "L2"}], "20"]}], 
      RowBox[{
       RowBox[{"-", 
        FractionBox[
         RowBox[{"D12", " ", 
          SuperscriptBox["L1", "2"]}], "20"]}], "+", 
       FractionBox[
        RowBox[{"D12", " ", 
         SuperscriptBox["L2", "2"]}], "20"]}], 
      FractionBox[
       RowBox[{"D11", " ", "L2"}], "6"], 
      FractionBox[
       RowBox[{"3", " ", "D12", " ", "L2"}], "20"], 
      RowBox[{"-", 
       FractionBox[
        RowBox[{"D12", " ", 
         SuperscriptBox["L2", "2"]}], "30"]}], "0", "0", "0"},
     {
      FractionBox[
       RowBox[{"3", " ", "D21", " ", "L1"}], "20"], 
      FractionBox[
       RowBox[{"9", " ", "D22", " ", "L1"}], "70"], 
      FractionBox[
       RowBox[{"13", " ", "D22", " ", 
        SuperscriptBox["L1", "2"]}], "420"], 
      RowBox[{
       FractionBox[
        RowBox[{"7", " ", "D21", " ", "L1"}], "20"], "+", 
       FractionBox[
        RowBox[{"7", " ", "D21", " ", "L2"}], "20"]}], 
      RowBox[{
       FractionBox[
        RowBox[{"13", " ", "D22", " ", "L1"}], "35"], "+", 
       FractionBox[
        RowBox[{"13", " ", "D22", " ", "L2"}], "35"]}], 
      RowBox[{
       RowBox[{"-", 
        FractionBox[
         RowBox[{"11", " ", "D22", " ", 
          SuperscriptBox["L1", "2"]}], "210"]}], "+", 
       FractionBox[
        RowBox[{"11", " ", "D22", " ", 
         SuperscriptBox["L2", "2"]}], "210"]}], 
      FractionBox[
       RowBox[{"3", " ", "D21", " ", "L2"}], "20"], 
      FractionBox[
       RowBox[{"9", " ", "D22", " ", "L2"}], "70"], 
      RowBox[{"-", 
       FractionBox[
        RowBox[{"13", " ", "D22", " ", 
         SuperscriptBox["L2", "2"]}], "420"]}], "0", "0", "0"},
     {
      RowBox[{"-", 
       FractionBox[
        RowBox[{"D21", " ", 
         SuperscriptBox["L1", "2"]}], "30"]}], 
      RowBox[{"-", 
       FractionBox[
        RowBox[{"13", " ", "D22", " ", 
         SuperscriptBox["L1", "2"]}], "420"]}], 
      RowBox[{"-", 
       FractionBox[
        RowBox[{"D22", " ", 
         SuperscriptBox["L1", "3"]}], "140"]}], 
      RowBox[{
       RowBox[{"-", 
        FractionBox[
         RowBox[{"D21", " ", 
          SuperscriptBox["L1", "2"]}], "20"]}], "+", 
       FractionBox[
        RowBox[{"D21", " ", 
         SuperscriptBox["L2", "2"]}], "20"]}], 
      RowBox[{
       RowBox[{"-", 
        FractionBox[
         RowBox[{"11", " ", "D22", " ", 
          SuperscriptBox["L1", "2"]}], "210"]}], "+", 
       FractionBox[
        RowBox[{"11", " ", "D22", " ", 
         SuperscriptBox["L2", "2"]}], "210"]}], 
      RowBox[{
       FractionBox[
        RowBox[{"D22", " ", 
         SuperscriptBox["L1", "3"]}], "105"], "+", 
       FractionBox[
        RowBox[{"D22", " ", 
         SuperscriptBox["L2", "3"]}], "105"]}], 
      FractionBox[
       RowBox[{"D21", " ", 
        SuperscriptBox["L2", "2"]}], "30"], 
      FractionBox[
       RowBox[{"13", " ", "D22", " ", 
        SuperscriptBox["L2", "2"]}], "420"], 
      RowBox[{"-", 
       FractionBox[
        RowBox[{"D22", " ", 
         SuperscriptBox["L2", "3"]}], "140"]}], "0", "0", "0"},
     {"0", "0", "0", 
      FractionBox[
       RowBox[{"D11", " ", "L2"}], "6"], 
      FractionBox[
       RowBox[{"3", " ", "D12", " ", "L2"}], "20"], 
      FractionBox[
       RowBox[{"D12", " ", 
        SuperscriptBox["L2", "2"]}], "30"], 
      RowBox[{
       FractionBox[
        RowBox[{"D11", " ", "L2"}], "3"], "+", 
       FractionBox[
        RowBox[{"D11", " ", "L3"}], "3"]}], 
      RowBox[{
       FractionBox[
        RowBox[{"7", " ", "D12", " ", "L2"}], "20"], "+", 
       FractionBox[
        RowBox[{"7", " ", "D12", " ", "L3"}], "20"]}], 
      RowBox[{
       RowBox[{"-", 
        FractionBox[
         RowBox[{"D12", " ", 
          SuperscriptBox["L2", "2"]}], "20"]}], "+", 
       FractionBox[
        RowBox[{"D12", " ", 
         SuperscriptBox["L3", "2"]}], "20"]}], 
      FractionBox[
       RowBox[{"D11", " ", "L3"}], "6"], 
      FractionBox[
       RowBox[{"3", " ", "D12", " ", "L3"}], "20"], 
      RowBox[{"-", 
       FractionBox[
        RowBox[{"D12", " ", 
         SuperscriptBox["L3", "2"]}], "30"]}]},
     {"0", "0", "0", 
      FractionBox[
       RowBox[{"3", " ", "D21", " ", "L2"}], "20"], 
      FractionBox[
       RowBox[{"9", " ", "D22", " ", "L2"}], "70"], 
      FractionBox[
       RowBox[{"13", " ", "D22", " ", 
        SuperscriptBox["L2", "2"]}], "420"], 
      RowBox[{
       FractionBox[
        RowBox[{"7", " ", "D21", " ", "L2"}], "20"], "+", 
       FractionBox[
        RowBox[{"7", " ", "D21", " ", "L3"}], "20"]}], 
      RowBox[{
       FractionBox[
        RowBox[{"13", " ", "D22", " ", "L2"}], "35"], "+", 
       FractionBox[
        RowBox[{"13", " ", "D22", " ", "L3"}], "35"]}], 
      RowBox[{
       RowBox[{"-", 
        FractionBox[
         RowBox[{"11", " ", "D22", " ", 
          SuperscriptBox["L2", "2"]}], "210"]}], "+", 
       FractionBox[
        RowBox[{"11", " ", "D22", " ", 
         SuperscriptBox["L3", "2"]}], "210"]}], 
      FractionBox[
       RowBox[{"3", " ", "D21", " ", "L3"}], "20"], 
      FractionBox[
       RowBox[{"9", " ", "D22", " ", "L3"}], "70"], 
      RowBox[{"-", 
       FractionBox[
        RowBox[{"13", " ", "D22", " ", 
         SuperscriptBox["L3", "2"]}], "420"]}]},
     {"0", "0", "0", 
      RowBox[{"-", 
       FractionBox[
        RowBox[{"D21", " ", 
         SuperscriptBox["L2", "2"]}], "30"]}], 
      RowBox[{"-", 
       FractionBox[
        RowBox[{"13", " ", "D22", " ", 
         SuperscriptBox["L2", "2"]}], "420"]}], 
      RowBox[{"-", 
       FractionBox[
        RowBox[{"D22", " ", 
         SuperscriptBox["L2", "3"]}], "140"]}], 
      RowBox[{
       RowBox[{"-", 
        FractionBox[
         RowBox[{"D21", " ", 
          SuperscriptBox["L2", "2"]}], "20"]}], "+", 
       FractionBox[
        RowBox[{"D21", " ", 
         SuperscriptBox["L3", "2"]}], "20"]}], 
      RowBox[{
       RowBox[{"-", 
        FractionBox[
         RowBox[{"11", " ", "D22", " ", 
          SuperscriptBox["L2", "2"]}], "210"]}], "+", 
       FractionBox[
        RowBox[{"11", " ", "D22", " ", 
         SuperscriptBox["L3", "2"]}], "210"]}], 
      RowBox[{
       FractionBox[
        RowBox[{"D22", " ", 
         SuperscriptBox["L2", "3"]}], "105"], "+", 
       FractionBox[
        RowBox[{"D22", " ", 
         SuperscriptBox["L3", "3"]}], "105"]}], 
      FractionBox[
       RowBox[{"D21", " ", 
        SuperscriptBox["L3", "2"]}], "30"], 
      FractionBox[
       RowBox[{"13", " ", "D22", " ", 
        SuperscriptBox["L3", "2"]}], "420"], 
      RowBox[{"-", 
       FractionBox[
        RowBox[{"D22", " ", 
         SuperscriptBox["L3", "3"]}], "140"]}]},
     {"0", "0", "0", "0", "0", "0", 
      FractionBox[
       RowBox[{"D11", " ", "L3"}], "6"], 
      FractionBox[
       RowBox[{"3", " ", "D12", " ", "L3"}], "20"], 
      FractionBox[
       RowBox[{"D12", " ", 
        SuperscriptBox["L3", "2"]}], "30"], 
      FractionBox[
       RowBox[{"D11", " ", "L3"}], "3"], 
      FractionBox[
       RowBox[{"7", " ", "D12", " ", "L3"}], "20"], 
      RowBox[{"-", 
       FractionBox[
        RowBox[{"D12", " ", 
         SuperscriptBox["L3", "2"]}], "20"]}]},
     {"0", "0", "0", "0", "0", "0", 
      FractionBox[
       RowBox[{"3", " ", "D21", " ", "L3"}], "20"], 
      FractionBox[
       RowBox[{"9", " ", "D22", " ", "L3"}], "70"], 
      FractionBox[
       RowBox[{"13", " ", "D22", " ", 
        SuperscriptBox["L3", "2"]}], "420"], 
      FractionBox[
       RowBox[{"7", " ", "D21", " ", "L3"}], "20"], 
      FractionBox[
       RowBox[{"13", " ", "D22", " ", "L3"}], "35"], 
      RowBox[{"-", 
       FractionBox[
        RowBox[{"11", " ", "D22", " ", 
         SuperscriptBox["L3", "2"]}], "210"]}]},
     {"0", "0", "0", "0", "0", "0", 
      RowBox[{"-", 
       FractionBox[
        RowBox[{"D21", " ", 
         SuperscriptBox["L3", "2"]}], "30"]}], 
      RowBox[{"-", 
       FractionBox[
        RowBox[{"13", " ", "D22", " ", 
         SuperscriptBox["L3", "2"]}], "420"]}], 
      RowBox[{"-", 
       FractionBox[
        RowBox[{"D22", " ", 
         SuperscriptBox["L3", "3"]}], "140"]}], 
      RowBox[{"-", 
       FractionBox[
        RowBox[{"D21", " ", 
         SuperscriptBox["L3", "2"]}], "20"]}], 
      RowBox[{"-", 
       FractionBox[
        RowBox[{"11", " ", "D22", " ", 
         SuperscriptBox["L3", "2"]}], "210"]}], 
      FractionBox[
       RowBox[{"D22", " ", 
        SuperscriptBox["L3", "3"]}], "105"]}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{
  3.8531625959361525`*^9, 3.8531628106486206`*^9, 3.853321320656988*^9, 
   3.8533842512456656`*^9, 3.8535589733431253`*^9, 3.854089995858659*^9, 
   3.8540901971195664`*^9, {3.8552385381745963`*^9, 3.8552385443945894`*^9}, 
   3.8552996708129935`*^9, 3.8552998934104996`*^9},
 CellLabel->
  "Out[84]//MatrixForm=",ExpressionUUID->"ac8b2129-77fc-4af9-8b08-\
132188cec24f"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Aerodynamic Stiffness Matrix [KKae]", "Section",
 CellChangeTimes->{{3.8531579018704567`*^9, 3.853157920354855*^9}, {
   3.8531631387344275`*^9, 3.8531631436684375`*^9}, {3.853321354899456*^9, 
   3.853321365908455*^9}, {3.8540875439518657`*^9, 3.8540875742964177`*^9}, 
   3.8540899518003464`*^9, {3.8552358257755575`*^9, 3.855235854186878*^9}, {
   3.855235887106062*^9, 3.8552358947834215`*^9}, {3.855288937098035*^9, 
   3.8552889428411465`*^9}},ExpressionUUID->"b8adf825-69d3-459f-9c6a-\
6be2a6b04b47"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"F", " ", "=", " ", 
     RowBox[{
      RowBox[{
       RowBox[{"FF", ".", "y"}], " ", "is", " ", "the", " ", "applied", " ", 
       "aerodynamic", " ", "load", " ", "due", " ", "to", " ", "structural", 
       " ", "deformations", "\[IndentingNewLine]", "F"}], " ", "=", " ", 
      RowBox[{
       RowBox[{
        RowBox[{"{", 
         RowBox[{"r", ",", " ", "f", ",", " ", "q"}], "}"}], " ", "..."}], 
       " ", "aerodynamic", " ", "torque"}]}]}], ",", " ", 
    RowBox[{"shear", " ", "force"}], ",", " ", 
    RowBox[{"bending", " ", "moment"}], ",", " ", "respectively", ",", " ", 
    RowBox[{
     RowBox[{
     "all", " ", "per", " ", "unit", " ", "length", "\[IndentingNewLine]", 
      "y"}], "=", " ", 
     RowBox[{
      RowBox[{
       RowBox[{"{", 
        RowBox[{"\[Theta]", ",", " ", "v", ",", " ", "\[Beta]"}], "}"}], " ", 
       "..."}], " ", "torsional", " ", "twist"}]}], ",", " ", 
    RowBox[{"out", "-", "of", "-", "plane", "-", "deflection"}], ",", " ", 
    RowBox[{
     RowBox[{"derivative", " ", "of", " ", "the", " ", "out"}], "-", "of", 
     "-", 
     RowBox[{
     "plane", " ", "dflection", " ", "in", " ", "spanwise", " ", "diection", 
      " ", 
      RowBox[{"(", 
       RowBox[{"dv", "/", "dx"}], ")"}]}]}], ",", " ", 
    RowBox[{
     RowBox[{"respectively", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"note", ":", " ", "\[IndentingNewLine]", 
       RowBox[{">", " ", "q"}]}]}], " ", "=", " ", 
     RowBox[{
      RowBox[{
      "0", " ", "since", " ", "aerodynamic", " ", "forces", " ", "do", " ", 
       "not", " ", "induce", " ", "pure", " ", "bending", " ", "moment"}], 
      "\[IndentingNewLine]", ">", " ", 
      RowBox[{
      "aerodynmic", " ", "forces", " ", "do", " ", "not", " ", "depend", " ", 
       "on", " ", 
       RowBox[{
       "\[Beta]", ".", "\[IndentingNewLine]", "\[IndentingNewLine]", 
        "Hence"}], " ", "FF", " ", "has", " ", "zero", " ", "last", " ", 
       "row", " ", "and", " ", 
       RowBox[{"column", "."}]}]}]}]}], "\[IndentingNewLine]", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "matrix", " ", "of", " ", "aerodynamic", " ", "loads", " ", "due", " ", 
    "to", " ", "structural", " ", "displacement"}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"FFaero", " ", "=", " ", 
     RowBox[{"ConstantArray", "[", 
      RowBox[{"0", ",", 
       RowBox[{"{", 
        RowBox[{"3", ",", "3"}], "}"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"FFaero", "[", 
      RowBox[{"[", 
       RowBox[{"1", ",", "1"}], "]"}], "]"}], "=", " ", "F11"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"FFaero", "[", 
      RowBox[{"[", 
       RowBox[{"1", ",", "2"}], "]"}], "]"}], " ", "=", " ", "F12"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"FFaero", "[", 
      RowBox[{"[", 
       RowBox[{"2", ",", "1"}], "]"}], "]"}], " ", "=", " ", "F21"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"FFaero", "[", 
      RowBox[{"[", 
       RowBox[{"2", ",", "2"}], "]"}], "]"}], " ", "=", " ", "F22"}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"Selection", " ", "matrix"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"AAE", " ", "=", " ", 
     RowBox[{"ConstantArray", "[", 
      RowBox[{"0", ",", 
       RowBox[{"{", 
        RowBox[{"3", ",", "6"}], "}"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"AAE", "[", 
      RowBox[{"[", 
       RowBox[{"1", ",", "1"}], "]"}], "]"}], " ", "=", " ", 
     RowBox[{"psi", "[", 
      RowBox[{"[", "1", "]"}], "]"}]}], ";", " ", 
    RowBox[{
     RowBox[{"AAE", "[", 
      RowBox[{"[", 
       RowBox[{"1", ",", "4"}], "]"}], "]"}], " ", "=", " ", 
     RowBox[{"psi", "[", 
      RowBox[{"[", "4", "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"AAE", "[", 
      RowBox[{"[", 
       RowBox[{"2", ",", "2"}], "]"}], "]"}], " ", "=", " ", 
     RowBox[{"psi", "[", 
      RowBox[{"[", "2", "]"}], "]"}]}], ";", " ", 
    RowBox[{
     RowBox[{"AAE", "[", 
      RowBox[{"[", 
       RowBox[{"2", ",", "3"}], "]"}], "]"}], " ", "=", " ", 
     RowBox[{"psi", "[", 
      RowBox[{"[", "3", "]"}], "]"}]}], ";", 
    RowBox[{
     RowBox[{"AAE", "[", 
      RowBox[{"[", 
       RowBox[{"2", ",", "5"}], "]"}], "]"}], " ", "=", " ", 
     RowBox[{"psi", "[", 
      RowBox[{"[", "5", "]"}], "]"}]}], ";", " ", 
    RowBox[{
     RowBox[{"AAE", "[", 
      RowBox[{"[", 
       RowBox[{"2", ",", "6"}], "]"}], "]"}], " ", "=", " ", 
     RowBox[{"psi", "[", 
      RowBox[{"[", "6", "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"AAE", "[", 
      RowBox[{"[", 
       RowBox[{"3", ",", "2"}], "]"}], "]"}], " ", "=", " ", 
     RowBox[{"psi1", "[", 
      RowBox[{"[", "2", "]"}], "]"}]}], ";", " ", 
    RowBox[{
     RowBox[{"AAE", "[", 
      RowBox[{"[", 
       RowBox[{"3", ",", "3"}], "]"}], "]"}], " ", "=", " ", 
     RowBox[{"psi1", "[", 
      RowBox[{"[", "3", "]"}], "]"}]}], ";", 
    RowBox[{
     RowBox[{"AAE", "[", 
      RowBox[{"[", 
       RowBox[{"3", ",", "5"}], "]"}], "]"}], " ", "=", " ", 
     RowBox[{"psi1", "[", 
      RowBox[{"[", "5", "]"}], "]"}]}], ";", " ", 
    RowBox[{
     RowBox[{"AAE", "[", 
      RowBox[{"[", 
       RowBox[{"3", ",", "6"}], "]"}], "]"}], " ", "=", " ", 
     RowBox[{"psi", "[", 
      RowBox[{"[", "6", "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"Aerodynamic", " ", "stiffness", " ", "matrix"}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"nucleusFF", " ", "=", " ", 
     RowBox[{
      SubsuperscriptBox["\[Integral]", "0", "1"], 
      RowBox[{
       RowBox[{
        RowBox[{"Transpose", "[", "AAE", "]"}], ".", "FFaero", ".", "AAE"}], 
       RowBox[{"\[DifferentialD]", "z"}]}]}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"FFaero", "//", "MatrixForm"}], "\[IndentingNewLine]", 
   RowBox[{"AAE", "//", "MatrixForm"}], "\[IndentingNewLine]", 
   RowBox[{"nucleusFF", "//", "MatrixForm"}]}]}]], "Input",
 CellChangeTimes->{{3.853157927540287*^9, 3.8531579712851896`*^9}, {
   3.8531606417896385`*^9, 3.8531608665384884`*^9}, {3.853161144811466*^9, 
   3.853161215210041*^9}, {3.8531613774339037`*^9, 3.8531613793237295`*^9}, {
   3.853319502751261*^9, 3.8533196753294168`*^9}, {3.853325905367114*^9, 
   3.853326000917409*^9}, 3.8533815696576166`*^9, {3.8533816225061693`*^9, 
   3.853381623523614*^9}, {3.8533822562887535`*^9, 3.853382267935441*^9}, {
   3.8533823605534935`*^9, 3.8533823622573633`*^9}, {3.8533837419964933`*^9, 
   3.8533839192815914`*^9}, {3.8533839977608128`*^9, 
   3.8533840971483183`*^9}, {3.8533841481613765`*^9, 3.853384166524573*^9}, {
   3.8552356685178137`*^9, 3.8552357107695303`*^9}, {3.8552359336471777`*^9, 
   3.8552364364476175`*^9}, {3.8552368394300427`*^9, 
   3.8552368396902065`*^9}, {3.855236938143876*^9, 3.855237176106011*^9}, {
   3.8552379038810544`*^9, 3.855237919730572*^9}, {3.855238070691308*^9, 
   3.8552380786210165`*^9}, {3.855238133430924*^9, 3.8552381644405217`*^9}, {
   3.855238216520012*^9, 3.8552382547693844`*^9}, 3.8552386264401813`*^9, 
   3.8552386737497396`*^9, {3.8552396526924877`*^9, 3.85523967556417*^9}, {
   3.855239806302086*^9, 3.8552398116832457`*^9}, {3.855240805901494*^9, 
   3.855240886934605*^9}, {3.8552409657774973`*^9, 3.855241056444127*^9}, {
   3.85528882793454*^9, 
   3.855288877251585*^9}},ExpressionUUID->"968df1c9-b0fa-4e82-91a5-\
fd3d6bb1d3f4"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"F11", "F12", "0"},
     {"F21", "F22", "0"},
     {"0", "0", "0"}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{{3.855238186690151*^9, 3.8552382229094667`*^9}, 
   3.855238255589301*^9, {3.8552386514698095`*^9, 3.855238674499674*^9}, {
   3.8552396620274334`*^9, 3.8552396765670714`*^9}, 3.8552398132271156`*^9, 
   3.8552408888426256`*^9, {3.8552409741546707`*^9, 3.855241057484248*^9}},
 CellLabel->
  "Out[257]//MatrixForm=",ExpressionUUID->"af1813dd-4b01-46d4-a187-\
89a0da7cf7a6"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      RowBox[{"1", "-", "z"}], "0", "0", "z", "0", "0"},
     {"0", 
      RowBox[{"1", "-", 
       RowBox[{"3", " ", 
        SuperscriptBox["z", "2"]}], "+", 
       RowBox[{"2", " ", 
        SuperscriptBox["z", "3"]}]}], 
      RowBox[{"z", "-", 
       RowBox[{"2", " ", 
        SuperscriptBox["z", "2"]}], "+", 
       SuperscriptBox["z", "3"]}], "0", 
      RowBox[{
       RowBox[{"3", " ", 
        SuperscriptBox["z", "2"]}], "-", 
       RowBox[{"2", " ", 
        SuperscriptBox["z", "3"]}]}], 
      RowBox[{
       RowBox[{"-", 
        SuperscriptBox["z", "2"]}], "+", 
       SuperscriptBox["z", "3"]}]},
     {"0", 
      RowBox[{
       RowBox[{
        RowBox[{"-", "6"}], " ", "z"}], "+", 
       RowBox[{"6", " ", 
        SuperscriptBox["z", "2"]}]}], 
      RowBox[{"1", "-", 
       RowBox[{"4", " ", "z"}], "+", 
       RowBox[{"3", " ", 
        SuperscriptBox["z", "2"]}]}], "0", 
      RowBox[{
       RowBox[{"6", " ", "z"}], "-", 
       RowBox[{"6", " ", 
        SuperscriptBox["z", "2"]}]}], 
      RowBox[{
       RowBox[{"-", 
        SuperscriptBox["z", "2"]}], "+", 
       SuperscriptBox["z", "3"]}]}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{{3.855238186690151*^9, 3.8552382229094667`*^9}, 
   3.855238255589301*^9, {3.8552386514698095`*^9, 3.855238674499674*^9}, {
   3.8552396620274334`*^9, 3.8552396765670714`*^9}, 3.8552398132271156`*^9, 
   3.8552408888426256`*^9, {3.8552409741546707`*^9, 3.855241057484248*^9}},
 CellLabel->
  "Out[258]//MatrixForm=",ExpressionUUID->"b912db09-0330-4104-ba36-\
3201b0397537"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      FractionBox["F11", "3"], 
      FractionBox[
       RowBox[{"7", " ", "F12"}], "20"], 
      FractionBox["F12", "20"], 
      FractionBox["F11", "6"], 
      FractionBox[
       RowBox[{"3", " ", "F12"}], "20"], 
      RowBox[{"-", 
       FractionBox["F12", "30"]}]},
     {
      FractionBox[
       RowBox[{"7", " ", "F21"}], "20"], 
      FractionBox[
       RowBox[{"13", " ", "F22"}], "35"], 
      FractionBox[
       RowBox[{"11", " ", "F22"}], "210"], 
      FractionBox[
       RowBox[{"3", " ", "F21"}], "20"], 
      FractionBox[
       RowBox[{"9", " ", "F22"}], "70"], 
      RowBox[{"-", 
       FractionBox[
        RowBox[{"13", " ", "F22"}], "420"]}]},
     {
      FractionBox["F21", "20"], 
      FractionBox[
       RowBox[{"11", " ", "F22"}], "210"], 
      FractionBox["F22", "105"], 
      FractionBox["F21", "30"], 
      FractionBox[
       RowBox[{"13", " ", "F22"}], "420"], 
      RowBox[{"-", 
       FractionBox["F22", "140"]}]},
     {
      FractionBox["F11", "6"], 
      FractionBox[
       RowBox[{"3", " ", "F12"}], "20"], 
      FractionBox["F12", "30"], 
      FractionBox["F11", "3"], 
      FractionBox[
       RowBox[{"7", " ", "F12"}], "20"], 
      RowBox[{"-", 
       FractionBox["F12", "20"]}]},
     {
      FractionBox[
       RowBox[{"3", " ", "F21"}], "20"], 
      FractionBox[
       RowBox[{"9", " ", "F22"}], "70"], 
      FractionBox[
       RowBox[{"13", " ", "F22"}], "420"], 
      FractionBox[
       RowBox[{"7", " ", "F21"}], "20"], 
      FractionBox[
       RowBox[{"13", " ", "F22"}], "35"], 
      RowBox[{"-", 
       FractionBox[
        RowBox[{"11", " ", "F22"}], "210"]}]},
     {
      RowBox[{"-", 
       FractionBox["F21", "30"]}], 
      RowBox[{"-", 
       FractionBox[
        RowBox[{"13", " ", "F22"}], "420"]}], 
      RowBox[{"-", 
       FractionBox["F22", "140"]}], 
      RowBox[{"-", 
       FractionBox["F21", "20"]}], 
      RowBox[{"-", 
       FractionBox[
        RowBox[{"11", " ", "F22"}], "210"]}], 
      FractionBox["F22", "105"]}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{{3.855238186690151*^9, 3.8552382229094667`*^9}, 
   3.855238255589301*^9, {3.8552386514698095`*^9, 3.855238674499674*^9}, {
   3.8552396620274334`*^9, 3.8552396765670714`*^9}, 3.8552398132271156`*^9, 
   3.8552408888426256`*^9, {3.8552409741546707`*^9, 3.855241057484248*^9}},
 CellLabel->
  "Out[259]//MatrixForm=",ExpressionUUID->"76c176ac-fbf3-4c82-9cd1-\
a744bd8e2748"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"Element", " ", "matrix", " ", "for", " ", "virtual", " ", 
    RowBox[{"work", ":"}]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"FFElem", " ", "=", " ", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"L", "[", 
         RowBox[{"[", "i", "]"}], "]"}], "*", 
        RowBox[{
         RowBox[{"Transpose", "[", 
          RowBox[{"S1", "[", 
           RowBox[{"[", "i", "]"}], "]"}], "]"}], ".", " ", "nucleusFF", ".", 
         RowBox[{"S1", "[", 
          RowBox[{"[", "i", "]"}], "]"}]}]}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "n"}], "}"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"FFElem", "[", 
     RowBox[{"[", "1", "]"}], "]"}], "//", "MatrixForm"}]}]}]], "Input",
 CellChangeTimes->{{3.853161229844341*^9, 3.853161248381115*^9}, {
   3.853161290410644*^9, 3.8531613648317037`*^9}, {3.853161426346966*^9, 
   3.853161432176824*^9}, {3.853161477589877*^9, 3.8531615148437853`*^9}, 
   3.8531615904846325`*^9, {3.853161657239006*^9, 3.8531617697101545`*^9}, 
   3.853161913796624*^9, {3.853320973030608*^9, 3.853321094720787*^9}, {
   3.853326008878501*^9, 3.8533261225563602`*^9}, {3.8533826255393353`*^9, 
   3.853382645440727*^9}, {3.8533827353958683`*^9, 3.8533827517038083`*^9}, {
   3.853382925536919*^9, 3.853382930403367*^9}, {3.85408997039858*^9, 
   3.854089974408881*^9}, {3.8552379651197324`*^9, 3.855237981289532*^9}, {
   3.855238052173264*^9, 3.855238058035369*^9}, {3.855238170410451*^9, 
   3.8552381721504993`*^9}, {3.855238525080803*^9, 3.855238526251401*^9}, 
   3.855239504376459*^9},
 CellLabel->
  "In[260]:=",ExpressionUUID->"2ff633da-12cb-45b1-85b6-cd86955c2df0"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      FractionBox[
       RowBox[{"F11", " ", "L1"}], "3"], 
      FractionBox[
       RowBox[{"7", " ", "F12", " ", "L1"}], "20"], 
      FractionBox[
       RowBox[{"F12", " ", 
        SuperscriptBox["L1", "2"]}], "20"], 
      FractionBox[
       RowBox[{"F11", " ", "L1"}], "6"], 
      FractionBox[
       RowBox[{"3", " ", "F12", " ", "L1"}], "20"], 
      RowBox[{"-", 
       FractionBox[
        RowBox[{"F12", " ", 
         SuperscriptBox["L1", "2"]}], "30"]}]},
     {
      FractionBox[
       RowBox[{"7", " ", "F21", " ", "L1"}], "20"], 
      FractionBox[
       RowBox[{"13", " ", "F22", " ", "L1"}], "35"], 
      FractionBox[
       RowBox[{"11", " ", "F22", " ", 
        SuperscriptBox["L1", "2"]}], "210"], 
      FractionBox[
       RowBox[{"3", " ", "F21", " ", "L1"}], "20"], 
      FractionBox[
       RowBox[{"9", " ", "F22", " ", "L1"}], "70"], 
      RowBox[{"-", 
       FractionBox[
        RowBox[{"13", " ", "F22", " ", 
         SuperscriptBox["L1", "2"]}], "420"]}]},
     {
      FractionBox[
       RowBox[{"F21", " ", 
        SuperscriptBox["L1", "2"]}], "20"], 
      FractionBox[
       RowBox[{"11", " ", "F22", " ", 
        SuperscriptBox["L1", "2"]}], "210"], 
      FractionBox[
       RowBox[{"F22", " ", 
        SuperscriptBox["L1", "3"]}], "105"], 
      FractionBox[
       RowBox[{"F21", " ", 
        SuperscriptBox["L1", "2"]}], "30"], 
      FractionBox[
       RowBox[{"13", " ", "F22", " ", 
        SuperscriptBox["L1", "2"]}], "420"], 
      RowBox[{"-", 
       FractionBox[
        RowBox[{"F22", " ", 
         SuperscriptBox["L1", "3"]}], "140"]}]},
     {
      FractionBox[
       RowBox[{"F11", " ", "L1"}], "6"], 
      FractionBox[
       RowBox[{"3", " ", "F12", " ", "L1"}], "20"], 
      FractionBox[
       RowBox[{"F12", " ", 
        SuperscriptBox["L1", "2"]}], "30"], 
      FractionBox[
       RowBox[{"F11", " ", "L1"}], "3"], 
      FractionBox[
       RowBox[{"7", " ", "F12", " ", "L1"}], "20"], 
      RowBox[{"-", 
       FractionBox[
        RowBox[{"F12", " ", 
         SuperscriptBox["L1", "2"]}], "20"]}]},
     {
      FractionBox[
       RowBox[{"3", " ", "F21", " ", "L1"}], "20"], 
      FractionBox[
       RowBox[{"9", " ", "F22", " ", "L1"}], "70"], 
      FractionBox[
       RowBox[{"13", " ", "F22", " ", 
        SuperscriptBox["L1", "2"]}], "420"], 
      FractionBox[
       RowBox[{"7", " ", "F21", " ", "L1"}], "20"], 
      FractionBox[
       RowBox[{"13", " ", "F22", " ", "L1"}], "35"], 
      RowBox[{"-", 
       FractionBox[
        RowBox[{"11", " ", "F22", " ", 
         SuperscriptBox["L1", "2"]}], "210"]}]},
     {
      RowBox[{"-", 
       FractionBox[
        RowBox[{"F21", " ", 
         SuperscriptBox["L1", "2"]}], "30"]}], 
      RowBox[{"-", 
       FractionBox[
        RowBox[{"13", " ", "F22", " ", 
         SuperscriptBox["L1", "2"]}], "420"]}], 
      RowBox[{"-", 
       FractionBox[
        RowBox[{"F22", " ", 
         SuperscriptBox["L1", "3"]}], "140"]}], 
      RowBox[{"-", 
       FractionBox[
        RowBox[{"F21", " ", 
         SuperscriptBox["L1", "2"]}], "20"]}], 
      RowBox[{"-", 
       FractionBox[
        RowBox[{"11", " ", "F22", " ", 
         SuperscriptBox["L1", "2"]}], "210"]}], 
      FractionBox[
       RowBox[{"F22", " ", 
        SuperscriptBox["L1", "3"]}], "105"]}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{
  3.8531617702771616`*^9, 3.8533210954773293`*^9, 3.8533212429599123`*^9, 
   3.853321289048753*^9, {3.853382655664691*^9, 3.853382673773075*^9}, 
   3.853382753147375*^9, 3.853382931473474*^9, 3.8533841865642505`*^9, 
   3.853558973321582*^9, 3.8540899929329042`*^9, 3.8540901935554037`*^9, {
   3.855238513366938*^9, 3.855238527136832*^9}, 3.8552410618916225`*^9},
 CellLabel->
  "Out[261]//MatrixForm=",ExpressionUUID->"183ffb1c-ca20-4578-9238-\
24d09ebba3fd"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"Global", " ", "aerodynamic", " ", "stiffness", " ", 
    RowBox[{"matrix", ":"}]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"FF", " ", "=", " ", 
     RowBox[{"ConstantArray", "[", 
      RowBox[{"0", ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"3", "*", 
          RowBox[{"(", 
           RowBox[{"n", "+", "1"}], ")"}]}], ",", " ", 
         RowBox[{"3", "*", 
          RowBox[{"(", 
           RowBox[{"n", "+", "1"}], ")"}]}]}], "}"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Do", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"FF", "[", 
        RowBox[{"[", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"3", "*", "i"}], "-", "2"}], ";;", 
           RowBox[{
            RowBox[{"3", "*", "i"}], "+", "3"}]}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{"3", "*", "i"}], "-", "2"}], ";;", 
           RowBox[{
            RowBox[{"3", "*", "i"}], "+", "3"}]}]}], "]"}], "]"}], " ", "=", 
       "  ", 
       RowBox[{
        RowBox[{"FF", "[", 
         RowBox[{"[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"3", "*", "i"}], "-", "2"}], ";;", 
            RowBox[{
             RowBox[{"3", "*", "i"}], "+", "3"}]}], ",", 
           RowBox[{
            RowBox[{
             RowBox[{"3", "*", "i"}], "-", "2"}], ";;", 
            RowBox[{
             RowBox[{"3", "*", "i"}], "+", "3"}]}]}], "]"}], "]"}], "+", 
        RowBox[{"FFElem", "[", 
         RowBox[{"[", "i", "]"}], "]"}]}]}], " ", ",", 
      RowBox[{"{", 
       RowBox[{"i", ",", "n"}], "}"}]}], "]"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"FF", "//", "MatrixForm"}]}]}]], "Input",
 CellChangeTimes->{{3.8531610319170322`*^9, 3.853161049542431*^9}, {
   3.8531619255992284`*^9, 3.85316197249403*^9}, {3.853162027082408*^9, 
   3.853162033222666*^9}, {3.8531624391565003`*^9, 3.853162466398546*^9}, {
   3.853162513600278*^9, 3.853162589887618*^9}, {3.8531626332898397`*^9, 
   3.853162636461113*^9}, 3.853162809569166*^9, {3.8531628929120197`*^9, 
   3.853162897575876*^9}, {3.8533213021808357`*^9, 3.8533213201194935`*^9}, {
   3.853384230799572*^9, 3.853384250870369*^9}, {3.8540899760485344`*^9, 
   3.854089982517408*^9}, {3.855238005443534*^9, 3.855238063861264*^9}, {
   3.855238543424553*^9, 3.855238543590503*^9}},
 CellLabel->"In[99]:=",ExpressionUUID->"cf4c5512-6ba8-4841-bfaf-1429c8de97cc"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      FractionBox[
       RowBox[{"F11", " ", "L1"}], "3"], 
      FractionBox[
       RowBox[{"7", " ", "F12", " ", "L1"}], "20"], 
      FractionBox[
       RowBox[{"F12", " ", 
        SuperscriptBox["L1", "2"]}], "20"], 
      FractionBox[
       RowBox[{"F11", " ", "L1"}], "6"], 
      FractionBox[
       RowBox[{"3", " ", "F12", " ", "L1"}], "20"], 
      RowBox[{"-", 
       FractionBox[
        RowBox[{"F12", " ", 
         SuperscriptBox["L1", "2"]}], "30"]}], "0", "0", "0", "0", "0", "0"},
     {
      FractionBox[
       RowBox[{"7", " ", "F21", " ", "L1"}], "20"], 
      FractionBox[
       RowBox[{"13", " ", "F22", " ", "L1"}], "35"], 
      FractionBox[
       RowBox[{"11", " ", "F22", " ", 
        SuperscriptBox["L1", "2"]}], "210"], 
      FractionBox[
       RowBox[{"3", " ", "F21", " ", "L1"}], "20"], 
      FractionBox[
       RowBox[{"9", " ", "F22", " ", "L1"}], "70"], 
      RowBox[{"-", 
       FractionBox[
        RowBox[{"13", " ", "F22", " ", 
         SuperscriptBox["L1", "2"]}], "420"]}], "0", "0", "0", "0", "0", "0"},
     {
      FractionBox[
       RowBox[{"F21", " ", 
        SuperscriptBox["L1", "2"]}], "20"], 
      FractionBox[
       RowBox[{"11", " ", "F22", " ", 
        SuperscriptBox["L1", "2"]}], "210"], 
      FractionBox[
       RowBox[{"F22", " ", 
        SuperscriptBox["L1", "3"]}], "105"], 
      FractionBox[
       RowBox[{"F21", " ", 
        SuperscriptBox["L1", "2"]}], "30"], 
      FractionBox[
       RowBox[{"13", " ", "F22", " ", 
        SuperscriptBox["L1", "2"]}], "420"], 
      RowBox[{"-", 
       FractionBox[
        RowBox[{"F22", " ", 
         SuperscriptBox["L1", "3"]}], "140"]}], "0", "0", "0", "0", "0", "0"},
     {
      FractionBox[
       RowBox[{"F11", " ", "L1"}], "6"], 
      FractionBox[
       RowBox[{"3", " ", "F12", " ", "L1"}], "20"], 
      FractionBox[
       RowBox[{"F12", " ", 
        SuperscriptBox["L1", "2"]}], "30"], 
      RowBox[{
       FractionBox[
        RowBox[{"F11", " ", "L1"}], "3"], "+", 
       FractionBox[
        RowBox[{"F11", " ", "L2"}], "3"]}], 
      RowBox[{
       FractionBox[
        RowBox[{"7", " ", "F12", " ", "L1"}], "20"], "+", 
       FractionBox[
        RowBox[{"7", " ", "F12", " ", "L2"}], "20"]}], 
      RowBox[{
       RowBox[{"-", 
        FractionBox[
         RowBox[{"F12", " ", 
          SuperscriptBox["L1", "2"]}], "20"]}], "+", 
       FractionBox[
        RowBox[{"F12", " ", 
         SuperscriptBox["L2", "2"]}], "20"]}], 
      FractionBox[
       RowBox[{"F11", " ", "L2"}], "6"], 
      FractionBox[
       RowBox[{"3", " ", "F12", " ", "L2"}], "20"], 
      RowBox[{"-", 
       FractionBox[
        RowBox[{"F12", " ", 
         SuperscriptBox["L2", "2"]}], "30"]}], "0", "0", "0"},
     {
      FractionBox[
       RowBox[{"3", " ", "F21", " ", "L1"}], "20"], 
      FractionBox[
       RowBox[{"9", " ", "F22", " ", "L1"}], "70"], 
      FractionBox[
       RowBox[{"13", " ", "F22", " ", 
        SuperscriptBox["L1", "2"]}], "420"], 
      RowBox[{
       FractionBox[
        RowBox[{"7", " ", "F21", " ", "L1"}], "20"], "+", 
       FractionBox[
        RowBox[{"7", " ", "F21", " ", "L2"}], "20"]}], 
      RowBox[{
       FractionBox[
        RowBox[{"13", " ", "F22", " ", "L1"}], "35"], "+", 
       FractionBox[
        RowBox[{"13", " ", "F22", " ", "L2"}], "35"]}], 
      RowBox[{
       RowBox[{"-", 
        FractionBox[
         RowBox[{"11", " ", "F22", " ", 
          SuperscriptBox["L1", "2"]}], "210"]}], "+", 
       FractionBox[
        RowBox[{"11", " ", "F22", " ", 
         SuperscriptBox["L2", "2"]}], "210"]}], 
      FractionBox[
       RowBox[{"3", " ", "F21", " ", "L2"}], "20"], 
      FractionBox[
       RowBox[{"9", " ", "F22", " ", "L2"}], "70"], 
      RowBox[{"-", 
       FractionBox[
        RowBox[{"13", " ", "F22", " ", 
         SuperscriptBox["L2", "2"]}], "420"]}], "0", "0", "0"},
     {
      RowBox[{"-", 
       FractionBox[
        RowBox[{"F21", " ", 
         SuperscriptBox["L1", "2"]}], "30"]}], 
      RowBox[{"-", 
       FractionBox[
        RowBox[{"13", " ", "F22", " ", 
         SuperscriptBox["L1", "2"]}], "420"]}], 
      RowBox[{"-", 
       FractionBox[
        RowBox[{"F22", " ", 
         SuperscriptBox["L1", "3"]}], "140"]}], 
      RowBox[{
       RowBox[{"-", 
        FractionBox[
         RowBox[{"F21", " ", 
          SuperscriptBox["L1", "2"]}], "20"]}], "+", 
       FractionBox[
        RowBox[{"F21", " ", 
         SuperscriptBox["L2", "2"]}], "20"]}], 
      RowBox[{
       RowBox[{"-", 
        FractionBox[
         RowBox[{"11", " ", "F22", " ", 
          SuperscriptBox["L1", "2"]}], "210"]}], "+", 
       FractionBox[
        RowBox[{"11", " ", "F22", " ", 
         SuperscriptBox["L2", "2"]}], "210"]}], 
      RowBox[{
       FractionBox[
        RowBox[{"F22", " ", 
         SuperscriptBox["L1", "3"]}], "105"], "+", 
       FractionBox[
        RowBox[{"F22", " ", 
         SuperscriptBox["L2", "3"]}], "105"]}], 
      FractionBox[
       RowBox[{"F21", " ", 
        SuperscriptBox["L2", "2"]}], "30"], 
      FractionBox[
       RowBox[{"13", " ", "F22", " ", 
        SuperscriptBox["L2", "2"]}], "420"], 
      RowBox[{"-", 
       FractionBox[
        RowBox[{"F22", " ", 
         SuperscriptBox["L2", "3"]}], "140"]}], "0", "0", "0"},
     {"0", "0", "0", 
      FractionBox[
       RowBox[{"F11", " ", "L2"}], "6"], 
      FractionBox[
       RowBox[{"3", " ", "F12", " ", "L2"}], "20"], 
      FractionBox[
       RowBox[{"F12", " ", 
        SuperscriptBox["L2", "2"]}], "30"], 
      RowBox[{
       FractionBox[
        RowBox[{"F11", " ", "L2"}], "3"], "+", 
       FractionBox[
        RowBox[{"F11", " ", "L3"}], "3"]}], 
      RowBox[{
       FractionBox[
        RowBox[{"7", " ", "F12", " ", "L2"}], "20"], "+", 
       FractionBox[
        RowBox[{"7", " ", "F12", " ", "L3"}], "20"]}], 
      RowBox[{
       RowBox[{"-", 
        FractionBox[
         RowBox[{"F12", " ", 
          SuperscriptBox["L2", "2"]}], "20"]}], "+", 
       FractionBox[
        RowBox[{"F12", " ", 
         SuperscriptBox["L3", "2"]}], "20"]}], 
      FractionBox[
       RowBox[{"F11", " ", "L3"}], "6"], 
      FractionBox[
       RowBox[{"3", " ", "F12", " ", "L3"}], "20"], 
      RowBox[{"-", 
       FractionBox[
        RowBox[{"F12", " ", 
         SuperscriptBox["L3", "2"]}], "30"]}]},
     {"0", "0", "0", 
      FractionBox[
       RowBox[{"3", " ", "F21", " ", "L2"}], "20"], 
      FractionBox[
       RowBox[{"9", " ", "F22", " ", "L2"}], "70"], 
      FractionBox[
       RowBox[{"13", " ", "F22", " ", 
        SuperscriptBox["L2", "2"]}], "420"], 
      RowBox[{
       FractionBox[
        RowBox[{"7", " ", "F21", " ", "L2"}], "20"], "+", 
       FractionBox[
        RowBox[{"7", " ", "F21", " ", "L3"}], "20"]}], 
      RowBox[{
       FractionBox[
        RowBox[{"13", " ", "F22", " ", "L2"}], "35"], "+", 
       FractionBox[
        RowBox[{"13", " ", "F22", " ", "L3"}], "35"]}], 
      RowBox[{
       RowBox[{"-", 
        FractionBox[
         RowBox[{"11", " ", "F22", " ", 
          SuperscriptBox["L2", "2"]}], "210"]}], "+", 
       FractionBox[
        RowBox[{"11", " ", "F22", " ", 
         SuperscriptBox["L3", "2"]}], "210"]}], 
      FractionBox[
       RowBox[{"3", " ", "F21", " ", "L3"}], "20"], 
      FractionBox[
       RowBox[{"9", " ", "F22", " ", "L3"}], "70"], 
      RowBox[{"-", 
       FractionBox[
        RowBox[{"13", " ", "F22", " ", 
         SuperscriptBox["L3", "2"]}], "420"]}]},
     {"0", "0", "0", 
      RowBox[{"-", 
       FractionBox[
        RowBox[{"F21", " ", 
         SuperscriptBox["L2", "2"]}], "30"]}], 
      RowBox[{"-", 
       FractionBox[
        RowBox[{"13", " ", "F22", " ", 
         SuperscriptBox["L2", "2"]}], "420"]}], 
      RowBox[{"-", 
       FractionBox[
        RowBox[{"F22", " ", 
         SuperscriptBox["L2", "3"]}], "140"]}], 
      RowBox[{
       RowBox[{"-", 
        FractionBox[
         RowBox[{"F21", " ", 
          SuperscriptBox["L2", "2"]}], "20"]}], "+", 
       FractionBox[
        RowBox[{"F21", " ", 
         SuperscriptBox["L3", "2"]}], "20"]}], 
      RowBox[{
       RowBox[{"-", 
        FractionBox[
         RowBox[{"11", " ", "F22", " ", 
          SuperscriptBox["L2", "2"]}], "210"]}], "+", 
       FractionBox[
        RowBox[{"11", " ", "F22", " ", 
         SuperscriptBox["L3", "2"]}], "210"]}], 
      RowBox[{
       FractionBox[
        RowBox[{"F22", " ", 
         SuperscriptBox["L2", "3"]}], "105"], "+", 
       FractionBox[
        RowBox[{"F22", " ", 
         SuperscriptBox["L3", "3"]}], "105"]}], 
      FractionBox[
       RowBox[{"F21", " ", 
        SuperscriptBox["L3", "2"]}], "30"], 
      FractionBox[
       RowBox[{"13", " ", "F22", " ", 
        SuperscriptBox["L3", "2"]}], "420"], 
      RowBox[{"-", 
       FractionBox[
        RowBox[{"F22", " ", 
         SuperscriptBox["L3", "3"]}], "140"]}]},
     {"0", "0", "0", "0", "0", "0", 
      FractionBox[
       RowBox[{"F11", " ", "L3"}], "6"], 
      FractionBox[
       RowBox[{"3", " ", "F12", " ", "L3"}], "20"], 
      FractionBox[
       RowBox[{"F12", " ", 
        SuperscriptBox["L3", "2"]}], "30"], 
      FractionBox[
       RowBox[{"F11", " ", "L3"}], "3"], 
      FractionBox[
       RowBox[{"7", " ", "F12", " ", "L3"}], "20"], 
      RowBox[{"-", 
       FractionBox[
        RowBox[{"F12", " ", 
         SuperscriptBox["L3", "2"]}], "20"]}]},
     {"0", "0", "0", "0", "0", "0", 
      FractionBox[
       RowBox[{"3", " ", "F21", " ", "L3"}], "20"], 
      FractionBox[
       RowBox[{"9", " ", "F22", " ", "L3"}], "70"], 
      FractionBox[
       RowBox[{"13", " ", "F22", " ", 
        SuperscriptBox["L3", "2"]}], "420"], 
      FractionBox[
       RowBox[{"7", " ", "F21", " ", "L3"}], "20"], 
      FractionBox[
       RowBox[{"13", " ", "F22", " ", "L3"}], "35"], 
      RowBox[{"-", 
       FractionBox[
        RowBox[{"11", " ", "F22", " ", 
         SuperscriptBox["L3", "2"]}], "210"]}]},
     {"0", "0", "0", "0", "0", "0", 
      RowBox[{"-", 
       FractionBox[
        RowBox[{"F21", " ", 
         SuperscriptBox["L3", "2"]}], "30"]}], 
      RowBox[{"-", 
       FractionBox[
        RowBox[{"13", " ", "F22", " ", 
         SuperscriptBox["L3", "2"]}], "420"]}], 
      RowBox[{"-", 
       FractionBox[
        RowBox[{"F22", " ", 
         SuperscriptBox["L3", "3"]}], "140"]}], 
      RowBox[{"-", 
       FractionBox[
        RowBox[{"F21", " ", 
         SuperscriptBox["L3", "2"]}], "20"]}], 
      RowBox[{"-", 
       FractionBox[
        RowBox[{"11", " ", "F22", " ", 
         SuperscriptBox["L3", "2"]}], "210"]}], 
      FractionBox[
       RowBox[{"F22", " ", 
        SuperscriptBox["L3", "3"]}], "105"]}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{
  3.8531625959361525`*^9, 3.8531628106486206`*^9, 3.853321320656988*^9, 
   3.8533842512456656`*^9, 3.8535589733431253`*^9, 3.854089995858659*^9, 
   3.8540901971195664`*^9, {3.8552385381745963`*^9, 3.8552385443945894`*^9}},
 CellLabel->
  "Out[101]//MatrixForm=",ExpressionUUID->"80169ef1-cd23-4423-8bf3-\
32c93b16d202"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Generalised Distributed Loads [DD1]", "Section",
 CellChangeTimes->{{3.8531579018704567`*^9, 3.853157920354855*^9}, {
   3.8531631387344275`*^9, 3.8531631436684375`*^9}, {3.853321354899456*^9, 
   3.853321365908455*^9}, {3.8540875439518657`*^9, 3.8540875742964177`*^9}, 
   3.8540899518003464`*^9},ExpressionUUID->"a88a241b-2c35-4b48-8b43-\
1f17e4a8eed9"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", "Torsion", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"nucleusDT", " ", "=", " ", 
     RowBox[{
      SubsuperscriptBox["\[Integral]", "0", "1"], 
      RowBox[{
       RowBox[{"Outer", "[", 
        RowBox[{"Times", ",", " ", 
         RowBox[{"ATh", ".", "psi"}], ",", " ", 
         RowBox[{"psi", ".", "ATR"}]}], "]"}], 
       RowBox[{"\[DifferentialD]", "z"}]}]}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"Bending", " ", "-", " ", 
     RowBox[{"shear", " ", "force"}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"nucleusDBV", " ", "=", " ", 
     RowBox[{
      SubsuperscriptBox["\[Integral]", "0", "1"], 
      RowBox[{
       RowBox[{"Outer", "[", 
        RowBox[{"Times", ",", " ", 
         RowBox[{"Av", ".", "psi"}], ",", " ", 
         RowBox[{"psi", ".", "ABV"}]}], "]"}], 
       RowBox[{"\[DifferentialD]", "z"}]}]}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"Bending", " ", "-", " ", 
     RowBox[{"bending", " ", "moment"}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"nucleusDBM", " ", "=", " ", 
     RowBox[{
      SubsuperscriptBox["\[Integral]", "0", "1"], 
      RowBox[{
       RowBox[{"Outer", "[", 
        RowBox[{"Times", ",", " ", 
         RowBox[{"Av", ".", "psi1"}], ",", " ", 
         RowBox[{"psi", ".", "ABM"}]}], "]"}], 
       RowBox[{"\[DifferentialD]", "z"}]}]}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "The", " ", "nucleus", " ", "is", " ", "taken", " ", "directly", " ", 
     "taken", " ", "from", " ", "the", " ", 
     RowBox[{"eq", ".", " ", "3.367"}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"nucleusDBM", " ", "=", " ", 
      RowBox[{
       RowBox[{
        RowBox[{"ConstantArray", "[", 
         RowBox[{"0", ",", 
          RowBox[{"{", 
           RowBox[{"6", ",", "6"}], "}"}]}], "]"}], "\[IndentingNewLine]", 
        RowBox[{"nucleusDBM", "[", 
         RowBox[{"[", 
          RowBox[{"2", ",", "3"}], "]"}], "]"}]}], " ", "=", " ", 
       RowBox[{
        RowBox[{"nucleusDBM", "[", 
         RowBox[{"[", 
          RowBox[{"2", ",", "6"}], "]"}], "]"}], " ", "=", " ", 
        RowBox[{
         RowBox[{"-", "1"}], "/", "2"}]}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"nucleusDBM", "[", 
       RowBox[{"[", 
        RowBox[{"3", ",", "3"}], "]"}], "]"}], " ", "=", 
      RowBox[{"1", "/", "12"}]}], ";", "  ", 
     RowBox[{
      RowBox[{"nucleusDBM", "[", 
       RowBox[{"[", 
        RowBox[{"3", ",", "6"}], "]"}], "]"}], " ", "=", " ", 
      RowBox[{
       RowBox[{"-", "1"}], "/", "12"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"nucleusDBM", "[", 
       RowBox[{"[", 
        RowBox[{"5", ",", "3"}], "]"}], "]"}], " ", "=", " ", 
      RowBox[{
       RowBox[{"nucleusDBM", "[", 
        RowBox[{"[", 
         RowBox[{"5", ",", "6"}], "]"}], "]"}], " ", "=", " ", 
       RowBox[{"1", "/", "2"}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"nucleusDBM", "[", 
       RowBox[{"[", 
        RowBox[{"6", ",", "3"}], "]"}], "]"}], " ", "=", 
      RowBox[{
       RowBox[{"-", "1"}], "/", "12"}]}], ";", "  ", 
     RowBox[{
      RowBox[{"nucleusDBM", "[", 
       RowBox[{"[", 
        RowBox[{"6", ",", "6"}], "]"}], "]"}], " ", "=", " ", 
      RowBox[{"1", "/", "12"}]}], ";"}], "*)"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"nucleusDT", "//", "MatrixForm"}], "\[IndentingNewLine]", 
   RowBox[{"nucleusDBV", "//", "MatrixForm"}], "\[IndentingNewLine]", 
   RowBox[{"nucleusDBM", "//", "MatrixForm"}]}]}]], "Input",
 CellChangeTimes->{{3.853157927540287*^9, 3.8531579712851896`*^9}, {
   3.8531606417896385`*^9, 3.8531608665384884`*^9}, {3.853161144811466*^9, 
   3.853161215210041*^9}, {3.8531613774339037`*^9, 3.8531613793237295`*^9}, {
   3.853319502751261*^9, 3.8533196753294168`*^9}, {3.853325905367114*^9, 
   3.853326000917409*^9}, 3.8533815696576166`*^9, {3.8533816225061693`*^9, 
   3.853381623523614*^9}, {3.8533822562887535`*^9, 3.853382267935441*^9}, {
   3.8533823605534935`*^9, 3.8533823622573633`*^9}, {3.8533837419964933`*^9, 
   3.8533839192815914`*^9}, {3.8533839977608128`*^9, 
   3.8533840971483183`*^9}, {3.8533841481613765`*^9, 3.853384166524573*^9}, {
   3.8552356685178137`*^9, 3.8552357107695303`*^9}, 
   3.8947934991059484`*^9},ExpressionUUID->"eff80f11-d500-4503-9ce8-\
1c7ba810a233"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0"}], "}"}], 
   ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0"}], "}"}], 
   ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0"}], "}"}], 
   ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0"}], "}"}], 
   ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0"}], "}"}], 
   ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0"}], "}"}]}], 
  "}"}]], "Output",
 CellChangeTimes->{
  3.853161380193492*^9, 3.8533209052165613`*^9, 3.8533212395081286`*^9, 
   3.853321286248886*^9, 3.8533816284446974`*^9, 3.8533822686249194`*^9, 
   3.8533826111003976`*^9, 3.853384103524519*^9, {3.8533841524034796`*^9, 
   3.85338416767153*^9}, 3.853558973297603*^9, 3.854089986717355*^9, 
   3.854090148511173*^9, 3.854090190099213*^9},
 CellLabel->"Out[72]=",ExpressionUUID->"cc8ef9de-84a2-403f-a69a-42047ac51cec"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      FractionBox["1", "3"], "0", "0", 
      FractionBox["1", "6"], "0", "0"},
     {"0", "0", "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0"},
     {
      FractionBox["1", "6"], "0", "0", 
      FractionBox["1", "3"], "0", "0"},
     {"0", "0", "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0"}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{
  3.853161380193492*^9, 3.8533209052165613`*^9, 3.8533212395081286`*^9, 
   3.853321286248886*^9, 3.8533816284446974`*^9, 3.8533822686249194`*^9, 
   3.8533826111003976`*^9, 3.853384103524519*^9, {3.8533841524034796`*^9, 
   3.85338416767153*^9}, 3.853558973297603*^9, 3.854089986717355*^9, 
   3.854090148511173*^9, 3.8540901901032553`*^9},
 CellLabel->
  "Out[77]//MatrixForm=",ExpressionUUID->"cf2bc4e5-1da5-4966-801a-\
40f4722a3ca3"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"0", "0", "0", "0", "0", "0"},
     {"0", 
      FractionBox["7", "20"], "0", "0", 
      FractionBox["3", "20"], "0"},
     {"0", 
      FractionBox["1", "20"], "0", "0", 
      FractionBox["1", "30"], "0"},
     {"0", "0", "0", "0", "0", "0"},
     {"0", 
      FractionBox["3", "20"], "0", "0", 
      FractionBox["7", "20"], "0"},
     {"0", 
      RowBox[{"-", 
       FractionBox["1", "30"]}], "0", "0", 
      RowBox[{"-", 
       FractionBox["1", "20"]}], "0"}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{
  3.853161380193492*^9, 3.8533209052165613`*^9, 3.8533212395081286`*^9, 
   3.853321286248886*^9, 3.8533816284446974`*^9, 3.8533822686249194`*^9, 
   3.8533826111003976`*^9, 3.853384103524519*^9, {3.8533841524034796`*^9, 
   3.85338416767153*^9}, 3.853558973297603*^9, 3.854089986717355*^9, 
   3.854090148511173*^9, 3.8540901901032553`*^9},
 CellLabel->
  "Out[78]//MatrixForm=",ExpressionUUID->"48d2bbf5-2f4c-4fe6-886b-\
3c1a804e3fd2"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"0", "0", "0", "0", "0", "0"},
     {"0", "0", 
      RowBox[{"-", 
       FractionBox["1", "2"]}], "0", "0", 
      RowBox[{"-", 
       FractionBox["1", "2"]}]},
     {"0", "0", 
      FractionBox["1", "12"], "0", "0", 
      RowBox[{"-", 
       FractionBox["1", "12"]}]},
     {"0", "0", "0", "0", "0", "0"},
     {"0", "0", 
      FractionBox["1", "2"], "0", "0", 
      FractionBox["1", "2"]},
     {"0", "0", 
      RowBox[{"-", 
       FractionBox["1", "12"]}], "0", "0", 
      FractionBox["1", "12"]}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{
  3.853161380193492*^9, 3.8533209052165613`*^9, 3.8533212395081286`*^9, 
   3.853321286248886*^9, 3.8533816284446974`*^9, 3.8533822686249194`*^9, 
   3.8533826111003976`*^9, 3.853384103524519*^9, {3.8533841524034796`*^9, 
   3.85338416767153*^9}, 3.853558973297603*^9, 3.854089986717355*^9, 
   3.854090148511173*^9, 3.8540901901072655`*^9},
 CellLabel->
  "Out[79]//MatrixForm=",ExpressionUUID->"ae501f3d-171c-4d76-b15e-\
27130ddb2016"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"Element", " ", "matrix", " ", "for", " ", "virtual", " ", 
    RowBox[{"work", ":"}]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"DD1Elem", " ", "=", " ", 
     RowBox[{"Table", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"L", "[", 
          RowBox[{"[", "i", "]"}], "]"}], "*", 
         RowBox[{
          RowBox[{"Transpose", "[", 
           RowBox[{"S1", "[", 
            RowBox[{"[", "i", "]"}], "]"}], "]"}], ".", " ", "nucleusDT"}]}], 
        "+", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"L", "[", 
          RowBox[{"[", "i", "]"}], "]"}], "*", 
         RowBox[{
          RowBox[{"Transpose", "[", 
           RowBox[{"S1", "[", 
            RowBox[{"[", "i", "]"}], "]"}], "]"}], ".", " ", "nucleusDBV"}]}],
         "+", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"L", "[", 
          RowBox[{"[", "i", "]"}], "]"}], "*", 
         RowBox[{
          RowBox[{"Transpose", "[", 
           RowBox[{"S2", "[", 
            RowBox[{"[", "i", "]"}], "]"}], "]"}], ".", " ", 
          "nucleusDBM"}]}]}], ",", "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{"i", ",", "n"}], "}"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"DD1Elem", "[", 
     RowBox[{"[", "1", "]"}], "]"}], "//", "MatrixForm"}]}]}]], "Input",
 CellChangeTimes->{{3.853161229844341*^9, 3.853161248381115*^9}, {
   3.853161290410644*^9, 3.8531613648317037`*^9}, {3.853161426346966*^9, 
   3.853161432176824*^9}, {3.853161477589877*^9, 3.8531615148437853`*^9}, 
   3.8531615904846325`*^9, {3.853161657239006*^9, 3.8531617697101545`*^9}, 
   3.853161913796624*^9, {3.853320973030608*^9, 3.853321094720787*^9}, {
   3.853326008878501*^9, 3.8533261225563602`*^9}, {3.8533826255393353`*^9, 
   3.853382645440727*^9}, {3.8533827353958683`*^9, 3.8533827517038083`*^9}, {
   3.853382925536919*^9, 3.853382930403367*^9}, {3.85408997039858*^9, 
   3.854089974408881*^9}},
 CellLabel->"In[80]:=",ExpressionUUID->"41b76958-0bbf-4221-a1f3-802db7ac36ec"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      FractionBox["L1", "3"], "0", "0", 
      FractionBox["L1", "6"], "0", "0"},
     {"0", 
      FractionBox[
       RowBox[{"7", " ", "L1"}], "20"], 
      RowBox[{"-", 
       FractionBox["1", "2"]}], "0", 
      FractionBox[
       RowBox[{"3", " ", "L1"}], "20"], 
      RowBox[{"-", 
       FractionBox["1", "2"]}]},
     {"0", 
      FractionBox[
       SuperscriptBox["L1", "2"], "20"], 
      FractionBox["L1", "12"], "0", 
      FractionBox[
       SuperscriptBox["L1", "2"], "30"], 
      RowBox[{"-", 
       FractionBox["L1", "12"]}]},
     {
      FractionBox["L1", "6"], "0", "0", 
      FractionBox["L1", "3"], "0", "0"},
     {"0", 
      FractionBox[
       RowBox[{"3", " ", "L1"}], "20"], 
      FractionBox["1", "2"], "0", 
      FractionBox[
       RowBox[{"7", " ", "L1"}], "20"], 
      FractionBox["1", "2"]},
     {"0", 
      RowBox[{"-", 
       FractionBox[
        SuperscriptBox["L1", "2"], "30"]}], 
      RowBox[{"-", 
       FractionBox["L1", "12"]}], "0", 
      RowBox[{"-", 
       FractionBox[
        SuperscriptBox["L1", "2"], "20"]}], 
      FractionBox["L1", "12"]}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{
  3.8531617702771616`*^9, 3.8533210954773293`*^9, 3.8533212429599123`*^9, 
   3.853321289048753*^9, {3.853382655664691*^9, 3.853382673773075*^9}, 
   3.853382753147375*^9, 3.853382931473474*^9, 3.8533841865642505`*^9, 
   3.853558973321582*^9, 3.8540899929329042`*^9, 3.8540901935554037`*^9},
 CellLabel->
  "Out[81]//MatrixForm=",ExpressionUUID->"6404f263-3a55-4f8e-8d1a-\
b7f6ba634254"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"Global", " ", "mass", " ", 
    RowBox[{"matrix", ":"}]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"DD1", " ", "=", " ", 
     RowBox[{"ConstantArray", "[", 
      RowBox[{"0", ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"3", "*", 
          RowBox[{"(", 
           RowBox[{"n", "+", "1"}], ")"}]}], ",", " ", 
         RowBox[{"3", "*", 
          RowBox[{"(", 
           RowBox[{"n", "+", "1"}], ")"}]}]}], "}"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Do", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"DD1", "[", 
        RowBox[{"[", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"3", "*", "i"}], "-", "2"}], ";;", 
           RowBox[{
            RowBox[{"3", "*", "i"}], "+", "3"}]}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{"3", "*", "i"}], "-", "2"}], ";;", 
           RowBox[{
            RowBox[{"3", "*", "i"}], "+", "3"}]}]}], "]"}], "]"}], " ", "=", 
       "  ", 
       RowBox[{
        RowBox[{"DD1", "[", 
         RowBox[{"[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"3", "*", "i"}], "-", "2"}], ";;", 
            RowBox[{
             RowBox[{"3", "*", "i"}], "+", "3"}]}], ",", 
           RowBox[{
            RowBox[{
             RowBox[{"3", "*", "i"}], "-", "2"}], ";;", 
            RowBox[{
             RowBox[{"3", "*", "i"}], "+", "3"}]}]}], "]"}], "]"}], "+", 
        RowBox[{"DD1Elem", "[", 
         RowBox[{"[", "i", "]"}], "]"}]}]}], " ", ",", 
      RowBox[{"{", 
       RowBox[{"i", ",", "n"}], "}"}]}], "]"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"DD1", "//", "MatrixForm"}]}]}]], "Input",
 CellChangeTimes->{{3.8531610319170322`*^9, 3.853161049542431*^9}, {
   3.8531619255992284`*^9, 3.85316197249403*^9}, {3.853162027082408*^9, 
   3.853162033222666*^9}, {3.8531624391565003`*^9, 3.853162466398546*^9}, {
   3.853162513600278*^9, 3.853162589887618*^9}, {3.8531626332898397`*^9, 
   3.853162636461113*^9}, 3.853162809569166*^9, {3.8531628929120197`*^9, 
   3.853162897575876*^9}, {3.8533213021808357`*^9, 3.8533213201194935`*^9}, {
   3.853384230799572*^9, 3.853384250870369*^9}, {3.8540899760485344`*^9, 
   3.854089982517408*^9}},
 CellLabel->"In[82]:=",ExpressionUUID->"8f65c13a-0f84-46f8-b837-d97fb28cff5d"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      FractionBox["L1", "3"], "0", "0", 
      FractionBox["L1", "6"], "0", "0", "0", "0", "0", "0", "0", "0"},
     {"0", 
      FractionBox[
       RowBox[{"7", " ", "L1"}], "20"], 
      RowBox[{"-", 
       FractionBox["1", "2"]}], "0", 
      FractionBox[
       RowBox[{"3", " ", "L1"}], "20"], 
      RowBox[{"-", 
       FractionBox["1", "2"]}], "0", "0", "0", "0", "0", "0"},
     {"0", 
      FractionBox[
       SuperscriptBox["L1", "2"], "20"], 
      FractionBox["L1", "12"], "0", 
      FractionBox[
       SuperscriptBox["L1", "2"], "30"], 
      RowBox[{"-", 
       FractionBox["L1", "12"]}], "0", "0", "0", "0", "0", "0"},
     {
      FractionBox["L1", "6"], "0", "0", 
      RowBox[{
       FractionBox["L1", "3"], "+", 
       FractionBox["L2", "3"]}], "0", "0", 
      FractionBox["L2", "6"], "0", "0", "0", "0", "0"},
     {"0", 
      FractionBox[
       RowBox[{"3", " ", "L1"}], "20"], 
      FractionBox["1", "2"], "0", 
      RowBox[{
       FractionBox[
        RowBox[{"7", " ", "L1"}], "20"], "+", 
       FractionBox[
        RowBox[{"7", " ", "L2"}], "20"]}], "0", "0", 
      FractionBox[
       RowBox[{"3", " ", "L2"}], "20"], 
      RowBox[{"-", 
       FractionBox["1", "2"]}], "0", "0", "0"},
     {"0", 
      RowBox[{"-", 
       FractionBox[
        SuperscriptBox["L1", "2"], "30"]}], 
      RowBox[{"-", 
       FractionBox["L1", "12"]}], "0", 
      RowBox[{
       RowBox[{"-", 
        FractionBox[
         SuperscriptBox["L1", "2"], "20"]}], "+", 
       FractionBox[
        SuperscriptBox["L2", "2"], "20"]}], 
      RowBox[{
       FractionBox["L1", "12"], "+", 
       FractionBox["L2", "12"]}], "0", 
      FractionBox[
       SuperscriptBox["L2", "2"], "30"], 
      RowBox[{"-", 
       FractionBox["L2", "12"]}], "0", "0", "0"},
     {"0", "0", "0", 
      FractionBox["L2", "6"], "0", "0", 
      RowBox[{
       FractionBox["L2", "3"], "+", 
       FractionBox["L3", "3"]}], "0", "0", 
      FractionBox["L3", "6"], "0", "0"},
     {"0", "0", "0", "0", 
      FractionBox[
       RowBox[{"3", " ", "L2"}], "20"], 
      FractionBox["1", "2"], "0", 
      RowBox[{
       FractionBox[
        RowBox[{"7", " ", "L2"}], "20"], "+", 
       FractionBox[
        RowBox[{"7", " ", "L3"}], "20"]}], "0", "0", 
      FractionBox[
       RowBox[{"3", " ", "L3"}], "20"], 
      RowBox[{"-", 
       FractionBox["1", "2"]}]},
     {"0", "0", "0", "0", 
      RowBox[{"-", 
       FractionBox[
        SuperscriptBox["L2", "2"], "30"]}], 
      RowBox[{"-", 
       FractionBox["L2", "12"]}], "0", 
      RowBox[{
       RowBox[{"-", 
        FractionBox[
         SuperscriptBox["L2", "2"], "20"]}], "+", 
       FractionBox[
        SuperscriptBox["L3", "2"], "20"]}], 
      RowBox[{
       FractionBox["L2", "12"], "+", 
       FractionBox["L3", "12"]}], "0", 
      FractionBox[
       SuperscriptBox["L3", "2"], "30"], 
      RowBox[{"-", 
       FractionBox["L3", "12"]}]},
     {"0", "0", "0", "0", "0", "0", 
      FractionBox["L3", "6"], "0", "0", 
      FractionBox["L3", "3"], "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", 
      FractionBox[
       RowBox[{"3", " ", "L3"}], "20"], 
      FractionBox["1", "2"], "0", 
      FractionBox[
       RowBox[{"7", " ", "L3"}], "20"], 
      FractionBox["1", "2"]},
     {"0", "0", "0", "0", "0", "0", "0", 
      RowBox[{"-", 
       FractionBox[
        SuperscriptBox["L3", "2"], "30"]}], 
      RowBox[{"-", 
       FractionBox["L3", "12"]}], "0", 
      RowBox[{"-", 
       FractionBox[
        SuperscriptBox["L3", "2"], "20"]}], 
      FractionBox["L3", "12"]}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{3.8531625959361525`*^9, 3.8531628106486206`*^9, 
  3.853321320656988*^9, 3.8533842512456656`*^9, 3.8535589733431253`*^9, 
  3.854089995858659*^9, 3.8540901971195664`*^9},
 CellLabel->
  "Out[84]//MatrixForm=",ExpressionUUID->"5f443d38-63e0-4c5e-96e4-\
45397c39f05d"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Generalised Concentrated Loads [DD2]", "Section",
 CellChangeTimes->{{3.8531579018704567`*^9, 3.853157920354855*^9}, {
  3.8531631387344275`*^9, 3.8531631436684375`*^9}, {3.853321354899456*^9, 
  3.853321365908455*^9}, {3.8540875439518657`*^9, 3.8540875791027308`*^9}, {
  3.8540891936071978`*^9, 3.854089200471374*^9}, {3.8540899552785883`*^9, 
  3.8540899622108927`*^9}},ExpressionUUID->"6a945c24-0771-4dcb-bf4d-\
13ea415c90ae"],

Cell[TextData[{
 StyleBox["TODO : Check the derivation for the distribution matrix for \
concentrated loads . The derivation below is not correct!",
  FontWeight->"Bold"],
 " "
}], "Text",
 CellChangeTimes->{{3.8541045728680162`*^9, 
  3.8541046176960344`*^9}},ExpressionUUID->"0c82aa52-a1d8-49ba-83ea-\
57cbdd80d320"],

Cell[BoxData[
 RowBox[{
  RowBox[{"psiDirac", " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"DiracDelta", "[", "z", "]"}], ",", " ", 
     RowBox[{"DiracDelta", "[", "z", "]"}], ",", " ", 
     RowBox[{"DiracDelta", "[", "z", "]"}], ",", " ", 
     RowBox[{"DiracDelta", "[", 
      RowBox[{"z", "-", "1"}], "]"}], ",", " ", 
     RowBox[{"DiracDelta", "[", 
      RowBox[{"z", "-", "1"}], "]"}], ",", " ", 
     RowBox[{"DiracDelta", "[", 
      RowBox[{"z", "-", "1"}], "]"}]}], "}"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.854088941035076*^9, 3.854088995822647*^9}, {
   3.8540890327642393`*^9, 3.854089048928117*^9}, 3.854090203966977*^9},
 CellLabel->"In[86]:=",ExpressionUUID->"3fad55ca-6f7f-4b80-93d4-73528f73abdf"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"Integration", " ", 
    RowBox[{"limits", ":"}]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"eps", " ", "=", " ", "1*^-10"}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", "Torsion", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"nucleusDTdsc", " ", "=", " ", 
     RowBox[{
      SubsuperscriptBox["\[Integral]", 
       RowBox[{"0", "-", "eps"}], 
       RowBox[{"1", "+", "eps"}]], 
      RowBox[{
       RowBox[{"Outer", "[", 
        RowBox[{"Times", ",", " ", 
         RowBox[{"ATh", ".", "psi"}], ",", " ", 
         RowBox[{"psiDirac", ".", "ATR"}]}], "]"}], 
       RowBox[{"\[DifferentialD]", "z"}]}]}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"Bending", " ", "-", " ", 
     RowBox[{"shear", " ", "force"}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"nucleusDBVdsc", " ", "=", " ", 
     RowBox[{
      SubsuperscriptBox["\[Integral]", 
       RowBox[{"0", "-", "eps"}], 
       RowBox[{"1", "+", "eps"}]], 
      RowBox[{
       RowBox[{"Outer", "[", 
        RowBox[{"Times", ",", " ", 
         RowBox[{"Av", ".", "psi"}], ",", " ", 
         RowBox[{"psiDirac", ".", "ABV"}]}], "]"}], 
       RowBox[{"\[DifferentialD]", "z"}]}]}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"Bending", " ", "-", " ", 
     RowBox[{"bending", " ", "moment"}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"nucleusDBMdsc", " ", "=", " ", 
     RowBox[{
      SubsuperscriptBox["\[Integral]", 
       RowBox[{"0", "-", "eps"}], 
       RowBox[{"1", "+", "eps"}]], 
      RowBox[{
       RowBox[{"Outer", "[", 
        RowBox[{"Times", ",", " ", 
         RowBox[{"Av", ".", "psi"}], ",", " ", 
         RowBox[{"psiDirac", ".", "ABM"}]}], "]"}], 
       RowBox[{"\[DifferentialD]", "z"}]}]}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "This", " ", "approach", " ", "for", " ", "calculating", " ", 
     "nucleusDBMdsc", " ", "must", " ", "be", " ", "double", " ", 
     RowBox[{"chekced", "!"}]}], " ", "*)"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"nucleusDTdsc", "//", "MatrixForm"}], "\[IndentingNewLine]", 
   RowBox[{"nucleusDBVdsc", "//", "MatrixForm"}], "\[IndentingNewLine]", 
   RowBox[{"nucleusDBMdsc", "//", "MatrixForm"}]}]}]], "Input",
 CellChangeTimes->{{3.853157927540287*^9, 3.8531579712851896`*^9}, {
   3.8531606417896385`*^9, 3.8531608665384884`*^9}, {3.853161144811466*^9, 
   3.853161215210041*^9}, {3.8531613774339037`*^9, 3.8531613793237295`*^9}, {
   3.853319502751261*^9, 3.8533196753294168`*^9}, {3.853325905367114*^9, 
   3.853326000917409*^9}, 3.8533815696576166`*^9, {3.8533816225061693`*^9, 
   3.853381623523614*^9}, {3.8533822562887535`*^9, 3.853382267935441*^9}, {
   3.8533823605534935`*^9, 3.8533823622573633`*^9}, {3.8533837419964933`*^9, 
   3.8533839192815914`*^9}, {3.8533839977608128`*^9, 
   3.8533840971483183`*^9}, {3.8533841481613765`*^9, 3.853384166524573*^9}, {
   3.8540890917437625`*^9, 3.8540891436362047`*^9}, {3.8540893280237036`*^9, 
   3.854089391745159*^9}, {3.854089467581712*^9, 3.8540895054106255`*^9}, {
   3.8540895947401543`*^9, 3.8540895951316695`*^9}, {3.8540896631099095`*^9, 
   3.8540897490697317`*^9}},
 CellLabel->"In[87]:=",ExpressionUUID->"f8954728-08cb-4830-bd8c-821526794311"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"1", "0", "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0"},
     {"0", "0", "0", "1", "0", "0"},
     {"0", "0", "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0"}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{
  3.853161380193492*^9, 3.8533209052165613`*^9, 3.8533212395081286`*^9, 
   3.853321286248886*^9, 3.8533816284446974`*^9, 3.8533822686249194`*^9, 
   3.8533826111003976`*^9, 3.853384103524519*^9, {3.8533841524034796`*^9, 
   3.85338416767153*^9}, 3.853558973297603*^9, 3.8540891061322155`*^9, 
   3.8540891480430384`*^9, 3.8540893348005767`*^9, {3.854089385571129*^9, 
   3.8540893933113203`*^9}, 3.8540895972248087`*^9, 3.854089751119961*^9, 
   3.8540898137694907`*^9, 3.8540900687371645`*^9, 3.8540901219314632`*^9, 
   3.854090209814681*^9},
 CellLabel->
  "Out[91]//MatrixForm=",ExpressionUUID->"c2ebe363-efa0-4d0d-85e4-\
cd73c3a5439d"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"0", "0", "0", "0", "0", "0"},
     {"0", "1", "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0"},
     {"0", "0", "0", "0", "1", "0"},
     {"0", "0", "0", "0", "0", "0"}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{
  3.853161380193492*^9, 3.8533209052165613`*^9, 3.8533212395081286`*^9, 
   3.853321286248886*^9, 3.8533816284446974`*^9, 3.8533822686249194`*^9, 
   3.8533826111003976`*^9, 3.853384103524519*^9, {3.8533841524034796`*^9, 
   3.85338416767153*^9}, 3.853558973297603*^9, 3.8540891061322155`*^9, 
   3.8540891480430384`*^9, 3.8540893348005767`*^9, {3.854089385571129*^9, 
   3.8540893933113203`*^9}, 3.8540895972248087`*^9, 3.854089751119961*^9, 
   3.8540898137694907`*^9, 3.8540900687371645`*^9, 3.8540901219314632`*^9, 
   3.854090209814681*^9},
 CellLabel->
  "Out[92]//MatrixForm=",ExpressionUUID->"2e79fb22-bc44-4542-a42c-\
95c5a2cc3fc0"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"0", "0", "0", "0", "0", "0"},
     {"0", "0", "1", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "1"},
     {"0", "0", "0", "0", "0", "0"}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{
  3.853161380193492*^9, 3.8533209052165613`*^9, 3.8533212395081286`*^9, 
   3.853321286248886*^9, 3.8533816284446974`*^9, 3.8533822686249194`*^9, 
   3.8533826111003976`*^9, 3.853384103524519*^9, {3.8533841524034796`*^9, 
   3.85338416767153*^9}, 3.853558973297603*^9, 3.8540891061322155`*^9, 
   3.8540891480430384`*^9, 3.8540893348005767`*^9, {3.854089385571129*^9, 
   3.8540893933113203`*^9}, 3.8540895972248087`*^9, 3.854089751119961*^9, 
   3.8540898137694907`*^9, 3.8540900687371645`*^9, 3.8540901219314632`*^9, 
   3.854090209818667*^9},
 CellLabel->
  "Out[93]//MatrixForm=",ExpressionUUID->"3613dde3-d45d-4d33-99c0-\
df062401b7ba"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"Element", " ", "matrix", " ", "for", " ", "virtual", " ", 
    RowBox[{"work", ":"}]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"DD2Elem", " ", "=", " ", 
     RowBox[{"Table", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"L", "[", 
          RowBox[{"[", "i", "]"}], "]"}], "*", 
         RowBox[{
          RowBox[{"Transpose", "[", 
           RowBox[{"S1", "[", 
            RowBox[{"[", "i", "]"}], "]"}], "]"}], ".", " ", 
          "nucleusDTdsc"}]}], "+", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"L", "[", 
          RowBox[{"[", "i", "]"}], "]"}], "*", 
         RowBox[{
          RowBox[{"Transpose", "[", 
           RowBox[{"S1", "[", 
            RowBox[{"[", "i", "]"}], "]"}], "]"}], ".", " ", 
          "nucleusDBVdsc"}]}], "+", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"L", "[", 
          RowBox[{"[", "i", "]"}], "]"}], "*", 
         RowBox[{
          RowBox[{"Transpose", "[", 
           RowBox[{"S2", "[", 
            RowBox[{"[", "i", "]"}], "]"}], "]"}], ".", " ", 
          "nucleusDBMdsc"}]}]}], ",", "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{"i", ",", "n"}], "}"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"DD2Elem", "[", 
     RowBox[{"[", "1", "]"}], "]"}], "//", "MatrixForm"}]}]}]], "Input",
 CellChangeTimes->{{3.853161229844341*^9, 3.853161248381115*^9}, {
   3.853161290410644*^9, 3.8531613648317037`*^9}, {3.853161426346966*^9, 
   3.853161432176824*^9}, {3.853161477589877*^9, 3.8531615148437853`*^9}, 
   3.8531615904846325`*^9, {3.853161657239006*^9, 3.8531617697101545`*^9}, 
   3.853161913796624*^9, {3.853320973030608*^9, 3.853321094720787*^9}, {
   3.853326008878501*^9, 3.8533261225563602`*^9}, {3.8533826255393353`*^9, 
   3.853382645440727*^9}, {3.8533827353958683`*^9, 3.8533827517038083`*^9}, {
   3.853382925536919*^9, 3.853382930403367*^9}, {3.8540896291732836`*^9, 
   3.854089636416588*^9}, {3.8540897920217185`*^9, 3.8540897922993793`*^9}, {
   3.8540898594791746`*^9, 3.85408985979873*^9}, {3.854090011012719*^9, 
   3.854090015178817*^9}},
 CellLabel->"In[94]:=",ExpressionUUID->"20868554-e6aa-44ff-9402-bd4cebc72fd1"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"L1", "0", "0", "0", "0", "0"},
     {"0", "L1", "1", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0"},
     {"0", "0", "0", "L1", "0", "0"},
     {"0", "0", "0", "0", "L1", "1"},
     {"0", "0", "0", "0", "0", "0"}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{
  3.8531617702771616`*^9, 3.8533210954773293`*^9, 3.8533212429599123`*^9, 
   3.853321289048753*^9, {3.853382655664691*^9, 3.853382673773075*^9}, 
   3.853382753147375*^9, 3.853382931473474*^9, 3.8533841865642505`*^9, 
   3.853558973321582*^9, {3.854089783549774*^9, 3.854089816720927*^9}, 
   3.8540898611141834`*^9, 3.8540900745841026`*^9, 3.854090216109821*^9},
 CellLabel->
  "Out[95]//MatrixForm=",ExpressionUUID->"4e3cd4a0-6677-4adf-8435-\
1d0021dc2555"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"Global", " ", "mass", " ", 
    RowBox[{"matrix", ":"}]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"DD2", " ", "=", " ", 
     RowBox[{"ConstantArray", "[", 
      RowBox[{"0", ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"3", "*", 
          RowBox[{"(", 
           RowBox[{"n", "+", "1"}], ")"}]}], ",", " ", 
         RowBox[{"3", "*", 
          RowBox[{"(", 
           RowBox[{"n", "+", "1"}], ")"}]}]}], "}"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Do", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"DD2", "[", 
        RowBox[{"[", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"3", "*", "i"}], "-", "2"}], ";;", 
           RowBox[{
            RowBox[{"3", "*", "i"}], "+", "3"}]}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{"3", "*", "i"}], "-", "2"}], ";;", 
           RowBox[{
            RowBox[{"3", "*", "i"}], "+", "3"}]}]}], "]"}], "]"}], " ", "=", 
       "  ", 
       RowBox[{
        RowBox[{"DD2", "[", 
         RowBox[{"[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"3", "*", "i"}], "-", "2"}], ";;", 
            RowBox[{
             RowBox[{"3", "*", "i"}], "+", "3"}]}], ",", 
           RowBox[{
            RowBox[{
             RowBox[{"3", "*", "i"}], "-", "2"}], ";;", 
            RowBox[{
             RowBox[{"3", "*", "i"}], "+", "3"}]}]}], "]"}], "]"}], "+", 
        RowBox[{"DD2Elem", "[", 
         RowBox[{"[", "i", "]"}], "]"}]}]}], " ", ",", 
      RowBox[{"{", 
       RowBox[{"i", ",", "n"}], "}"}]}], "]"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"DD2", "//", "MatrixForm"}]}]}]], "Input",
 CellChangeTimes->{{3.8531610319170322`*^9, 3.853161049542431*^9}, {
   3.8531619255992284`*^9, 3.85316197249403*^9}, {3.853162027082408*^9, 
   3.853162033222666*^9}, {3.8531624391565003`*^9, 3.853162466398546*^9}, {
   3.853162513600278*^9, 3.853162589887618*^9}, {3.8531626332898397`*^9, 
   3.853162636461113*^9}, 3.853162809569166*^9, {3.8531628929120197`*^9, 
   3.853162897575876*^9}, {3.8533213021808357`*^9, 3.8533213201194935`*^9}, {
   3.853384230799572*^9, 3.853384250870369*^9}, {3.8540898310317154`*^9, 
   3.854089876477579*^9}, {3.8540900195278873`*^9, 3.85409003465013*^9}},
 CellLabel->"In[96]:=",ExpressionUUID->"2131ddf8-3d7a-4d37-abaa-e03572063d8e"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"L1", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0"},
     {"0", "L1", "1", "0", "0", "0", "0", "0", "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0"},
     {"0", "0", "0", 
      RowBox[{"L1", "+", "L2"}], "0", "0", "0", "0", "0", "0", "0", "0"},
     {"0", "0", "0", "0", 
      RowBox[{"L1", "+", "L2"}], "2", "0", "0", "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", 
      RowBox[{"L2", "+", "L3"}], "0", "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", 
      RowBox[{"L2", "+", "L3"}], "2", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "L3", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "L3", "1"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0"}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{3.8531625959361525`*^9, 3.8531628106486206`*^9, 
  3.853321320656988*^9, 3.8533842512456656`*^9, 3.8535589733431253`*^9, 
  3.8540898771159987`*^9, 3.854090035178889*^9, 3.854090078330431*^9, 
  3.854090220226832*^9},
 CellLabel->
  "Out[98]//MatrixForm=",ExpressionUUID->"f9013418-9e5c-401b-b577-\
e15b1f668086"]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["Validation of Python code", "Section",
 CellChangeTimes->{{3.853500420186987*^9, 
  3.8535004366792955`*^9}},ExpressionUUID->"6d459f44-53b2-47de-8814-\
b6d43cc10399"],

Cell[BoxData[
 RowBox[{
  RowBox[{"inputData", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"L1", "->", "0.04508"}], ",", " ", 
     RowBox[{"EI1", "->", " ", "0.4186"}], ",", " ", 
     RowBox[{"GJ1", "->", "0.9539"}], ",", " ", 
     RowBox[{"K1", "->", 
      RowBox[{"0.25", "*", 
       RowBox[{"Sqrt", "[", 
        RowBox[{"0.4186", "*", "0.9539"}], "]"}]}]}], ",", " ", 
     RowBox[{"m1", "->", "0.2351"}], ",", " ", 
     RowBox[{"\[Rho]Ip1", "->", "2.056*^-5"}], ",", " ", 
     RowBox[{"d1", "->", 
      RowBox[{"-", "0.000508"}]}], ",", " ", "\[IndentingNewLine]", 
     RowBox[{"L2", "->", "0.04508"}], ",", " ", 
     RowBox[{"EI2", "->", " ", "0.4186"}], ",", " ", 
     RowBox[{"GJ2", "->", "0.9539"}], ",", " ", 
     RowBox[{"K2", "->", 
      RowBox[{"0.25", "*", 
       RowBox[{"Sqrt", "[", 
        RowBox[{"0.4186", "*", "0.9539"}], "]"}]}]}], ",", " ", 
     RowBox[{"m2", "->", "0.2351"}], ",", " ", 
     RowBox[{"\[Rho]Ip2", "->", "2.056*^-5"}], ",", " ", 
     RowBox[{"d2", "->", 
      RowBox[{"-", "0.000508"}]}]}], "}"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.853500453872609*^9, 3.853500488059413*^9}, {
   3.8535005406257577`*^9, 3.8535006499603233`*^9}, {3.853500706099779*^9, 
   3.85350076409929*^9}, {3.853501781609265*^9, 3.853501796983305*^9}, 
   3.853501886010482*^9, {3.8535020684710264`*^9, 3.853502073713792*^9}, {
   3.8535616349007826`*^9, 3.8535616759072113`*^9}, {3.853562463309801*^9, 
   3.8535624792928677`*^9}},
 CellLabel->
  "In[126]:=",ExpressionUUID->"9626b028-589b-491c-9638-3fdbf8a29a5f"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"KKElem", "[", 
    RowBox[{"[", "1", "]"}], "]"}], "/.", "inputData"}], "//", 
  "MatrixForm"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"KK", "[", 
    RowBox[{"[", 
     RowBox[{
      RowBox[{"1", ";;", "6"}], ",", 
      RowBox[{"1", ";;", "6"}]}], "]"}], "]"}], "/.", "inputData"}], "//", 
  "MatrixForm"}]}], "Input",
 CellChangeTimes->{{3.8535009752336235`*^9, 3.853500976120082*^9}, {
  3.853501011738123*^9, 3.8535010346052675`*^9}, {3.853501801538161*^9, 
  3.8535018612577033`*^9}},
 CellLabel->
  "In[127]:=",ExpressionUUID->"14c76b5a-3b81-4255-9845-e46b54fefdc0"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"21.160159716060335`", "0", "3.5043472766285007`", 
      RowBox[{"-", "21.160159716060335`"}], "0", 
      RowBox[{"-", "3.5043472766285007`"}]},
     {"0", "54831.325906941056`", "1235.8980859424514`", "0", 
      RowBox[{"-", "54831.325906941056`"}], "1235.8980859424514`"},
     {"3.5043472766285007`", "1235.8980859424514`", "37.142857142857146`", 
      RowBox[{"-", "3.5043472766285007`"}], 
      RowBox[{"-", "1235.8980859424514`"}], "18.571428571428573`"},
     {
      RowBox[{"-", "21.160159716060335`"}], "0", 
      RowBox[{"-", "3.5043472766285007`"}], "21.160159716060335`", "0", 
      "3.5043472766285007`"},
     {"0", 
      RowBox[{"-", "54831.325906941056`"}], 
      RowBox[{"-", "1235.8980859424514`"}], "0", "54831.325906941056`", 
      RowBox[{"-", "1235.8980859424514`"}]},
     {
      RowBox[{"-", "3.5043472766285007`"}], "1235.8980859424514`", 
      "18.571428571428573`", "3.5043472766285007`", 
      RowBox[{"-", "1235.8980859424514`"}], "37.142857142857146`"}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{{3.8535010263048987`*^9, 3.8535010371724596`*^9}, {
   3.853501825103366*^9, 3.8535018897656655`*^9}, {3.8535021120549135`*^9, 
   3.8535021281734324`*^9}, 3.853558973365676*^9, 3.853561683096623*^9, 
   3.8535624841892133`*^9},
 CellLabel->
  "Out[127]//MatrixForm=",ExpressionUUID->"5f592e99-4e19-45c7-b57f-\
0c0d5b7ee62a"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"21.160159716060335`", "0", "3.5043472766285007`", 
      RowBox[{"-", "21.160159716060335`"}], "0", 
      RowBox[{"-", "3.5043472766285007`"}]},
     {"0", "54831.325906941056`", "1235.8980859424514`", "0", 
      RowBox[{"-", "54831.325906941056`"}], "1235.8980859424514`"},
     {"3.5043472766285007`", "1235.8980859424514`", "37.142857142857146`", 
      RowBox[{"-", "3.5043472766285007`"}], 
      RowBox[{"-", "1235.8980859424514`"}], "18.571428571428573`"},
     {
      RowBox[{"-", "21.160159716060335`"}], "0", 
      RowBox[{"-", "3.5043472766285007`"}], "42.32031943212067`", "0", 
      "7.008694553257001`"},
     {"0", 
      RowBox[{"-", "54831.325906941056`"}], 
      RowBox[{"-", "1235.8980859424514`"}], "0", "109662.65181388211`", "0.`"},
     {
      RowBox[{"-", "3.5043472766285007`"}], "1235.8980859424514`", 
      "18.571428571428573`", "7.008694553257001`", "0.`", "74.28571428571429`"}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{{3.8535010263048987`*^9, 3.8535010371724596`*^9}, {
   3.853501825103366*^9, 3.8535018897656655`*^9}, {3.8535021120549135`*^9, 
   3.8535021281734324`*^9}, 3.853558973365676*^9, 3.853561683096623*^9, 
   3.853562484193209*^9},
 CellLabel->
  "Out[128]//MatrixForm=",ExpressionUUID->"eccd2494-1aec-489c-8441-\
081d6f80182c"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"MMElem", "[", 
    RowBox[{"[", "1", "]"}], "]"}], "/.", "inputData"}], "//", 
  "MatrixForm"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"MM", "[", 
    RowBox[{"[", 
     RowBox[{
      RowBox[{"1", ";;", "6"}], ",", 
      RowBox[{"1", ";;", "6"}]}], "]"}], "]"}], "/.", "inputData"}], "//", 
  "MatrixForm"}]}], "Input",
 CellChangeTimes->{{3.8535016586472964`*^9, 3.8535016770664625`*^9}, {
  3.8535019401080503`*^9, 3.8535019447572765`*^9}},
 CellLabel->
  "In[117]:=",ExpressionUUID->"c8075474-116e-4820-ab5b-85348a5872df"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"3.089482666666667`*^-7", 
      RowBox[{"-", "1.8547039000000002`*^-6"}], 
      RowBox[{"-", "1.1944293116`*^-8"}], "1.5447413333333334`*^-7", 
      RowBox[{"-", "7.948730999999999`*^-7"}], "7.962862077333334`*^-9"},
     {
      RowBox[{"-", "1.8547039000000002`*^-6"}], "0.0039365144000000005`", 
      "0.000025026137957333336`", 
      RowBox[{"-", "7.948730999999999`*^-7"}], "0.0013626396000000001`", 
      RowBox[{"-", "0.000014788172429333334`"}]},
     {
      RowBox[{"-", "1.1944293116`*^-8"}], "0.000025026137957333336`", 
      "2.051233271121067`*^-7", 
      RowBox[{"-", "7.962862077333334`*^-9"}], "0.000014788172429333334`", 
      RowBox[{"-", "1.5384249533408`*^-7"}]},
     {"1.5447413333333334`*^-7", 
      RowBox[{"-", "7.948730999999999`*^-7"}], 
      RowBox[{"-", "7.962862077333334`*^-9"}], "3.089482666666667`*^-7", 
      RowBox[{"-", "1.8547039000000002`*^-6"}], "1.1944293116`*^-8"},
     {
      RowBox[{"-", "7.948730999999999`*^-7"}], "0.0013626396000000001`", 
      "0.000014788172429333334`", 
      RowBox[{"-", "1.8547039000000002`*^-6"}], "0.0039365144000000005`", 
      RowBox[{"-", "0.000025026137957333336`"}]},
     {"7.962862077333334`*^-9", 
      RowBox[{"-", "0.000014788172429333334`"}], 
      RowBox[{"-", "1.5384249533408`*^-7"}], "1.1944293116`*^-8", 
      RowBox[{"-", "0.000025026137957333336`"}], "2.051233271121067`*^-7"}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{3.8535016779633694`*^9, 3.8535019453376555`*^9, 
  3.8535021305807753`*^9, 3.853558973389131*^9, 3.853561689391281*^9},
 CellLabel->
  "Out[117]//MatrixForm=",ExpressionUUID->"deba6e87-e177-4d11-9c55-\
b2209755ae7b"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"3.089482666666667`*^-7", 
      RowBox[{"-", "1.8547039000000002`*^-6"}], 
      RowBox[{"-", "1.1944293116`*^-8"}], "1.5447413333333334`*^-7", 
      RowBox[{"-", "7.948730999999999`*^-7"}], "7.962862077333334`*^-9"},
     {
      RowBox[{"-", "1.8547039000000002`*^-6"}], "0.0039365144000000005`", 
      "0.000025026137957333336`", 
      RowBox[{"-", "7.948730999999999`*^-7"}], "0.0013626396000000001`", 
      RowBox[{"-", "0.000014788172429333334`"}]},
     {
      RowBox[{"-", "1.1944293116`*^-8"}], "0.000025026137957333336`", 
      "2.051233271121067`*^-7", 
      RowBox[{"-", "7.962862077333334`*^-9"}], "0.000014788172429333334`", 
      RowBox[{"-", "1.5384249533408`*^-7"}]},
     {"1.5447413333333334`*^-7", 
      RowBox[{"-", "7.948730999999999`*^-7"}], 
      RowBox[{"-", "7.962862077333334`*^-9"}], "6.178965333333334`*^-7", 
      RowBox[{"-", "3.7094078000000004`*^-6"}], "0.`"},
     {
      RowBox[{"-", "7.948730999999999`*^-7"}], "0.0013626396000000001`", 
      "0.000014788172429333334`", 
      RowBox[{"-", "3.7094078000000004`*^-6"}], "0.007873028800000001`", 
      "0.`"},
     {"7.962862077333334`*^-9", 
      RowBox[{"-", "0.000014788172429333334`"}], 
      RowBox[{"-", "1.5384249533408`*^-7"}], "0.`", "0.`", 
      "4.102466542242134`*^-7"}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{3.8535016779633694`*^9, 3.8535019453376555`*^9, 
  3.8535021305807753`*^9, 3.853558973389131*^9, 3.853561689395278*^9},
 CellLabel->
  "Out[118]//MatrixForm=",ExpressionUUID->"cacc789a-a588-4f36-a9a9-\
6e5d23328a6a"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"DDElem", "[", 
    RowBox[{"[", "1", "]"}], "]"}], "/.", "inputData"}], "//", 
  "MatrixForm"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"DD", "[", 
    RowBox[{"[", 
     RowBox[{
      RowBox[{"1", ";;", "6"}], ",", 
      RowBox[{"1", ";;", "6"}]}], "]"}], "]"}], "/.", "inputData"}], "//", 
  "MatrixForm"}]}], "Input",
 CellChangeTimes->{{3.8535592521270285`*^9, 3.8535592596875114`*^9}},
 CellLabel->
  "In[119]:=",ExpressionUUID->"46719a33-94a5-4f93-bcbf-3982c2c45668"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"0.015026666666666667`", "0", "0", "0.007513333333333334`", "0", "0"},
     {"0", "0.015778`", 
      RowBox[{"-", 
       FractionBox["1", "2"]}], "0", "0.006762`", 
      RowBox[{"-", 
       FractionBox["1", "2"]}]},
     {"0", "0.00010161032`", "0.003756666666666667`", "0", 
      "0.00006774021333333334`", 
      RowBox[{"-", "0.003756666666666667`"}]},
     {"0.007513333333333334`", "0", "0", "0.015026666666666667`", "0", "0"},
     {"0", "0.006762`", 
      FractionBox["1", "2"], "0", "0.015778`", 
      FractionBox["1", "2"]},
     {"0", 
      RowBox[{"-", "0.00006774021333333334`"}], 
      RowBox[{"-", "0.003756666666666667`"}], "0", 
      RowBox[{"-", "0.00010161032`"}], "0.003756666666666667`"}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{3.853559260451962*^9, 3.8535616955310574`*^9},
 CellLabel->
  "Out[119]//MatrixForm=",ExpressionUUID->"9ab0a816-0087-4c54-afa2-\
78764164f704"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"0.015026666666666667`", "0", "0", "0.007513333333333334`", "0", "0"},
     {"0", "0.015778`", 
      RowBox[{"-", 
       FractionBox["1", "2"]}], "0", "0.006762`", 
      RowBox[{"-", 
       FractionBox["1", "2"]}]},
     {"0", "0.00010161032`", "0.003756666666666667`", "0", 
      "0.00006774021333333334`", 
      RowBox[{"-", "0.003756666666666667`"}]},
     {"0.007513333333333334`", "0", "0", "0.030053333333333335`", "0", "0"},
     {"0", "0.006762`", 
      FractionBox["1", "2"], "0", "0.031556`", "0"},
     {"0", 
      RowBox[{"-", "0.00006774021333333334`"}], 
      RowBox[{"-", "0.003756666666666667`"}], "0", "0.`", 
      "0.007513333333333334`"}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{3.853559260451962*^9, 3.8535616955310574`*^9},
 CellLabel->
  "Out[120]//MatrixForm=",ExpressionUUID->"00f3a77b-9d8f-4e77-964d-\
c337e3302ff1"]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\

Export to CSV\
\>", "Subsection",
 CellChangeTimes->{{3.853559338588766*^9, 
  3.853559351631401*^9}},ExpressionUUID->"79951ac1-5e89-4653-94a1-\
362406369672"],

Cell["\<\
Export the first 6x6 quadrant to a CSV file to compare with python \
implementation of the code: \
\>", "Text",
 CellChangeTimes->{{3.853559287341497*^9, 
  3.8535593367584524`*^9}},ExpressionUUID->"9f2261a0-351a-43cd-8cca-\
d92d1e558414"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
   "Set", " ", "the", " ", "directory", " ", "of", " ", "the", " ", 
    "Notebook", " ", "as", " ", "the", " ", "starting", " ", "directory", " ",
     "for", " ", "the", " ", "relative", " ", "path"}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"SetDirectory", "[", 
     RowBox[{"NotebookDirectory", "[", "]"}], "]"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"Export", "[", 
    RowBox[{"\"\<MM.csv\>\"", ",", 
     RowBox[{
      RowBox[{"MM", "[", 
       RowBox[{"[", 
        RowBox[{
         RowBox[{"1", ";;", "6"}], ",", 
         RowBox[{"1", ";;", "6"}]}], "]"}], "]"}], "/.", "inputData"}], ",", 
     "\"\<CSV\>\""}], "]"}], "\[IndentingNewLine]", 
   RowBox[{"Export", "[", 
    RowBox[{"\"\<KK.csv\>\"", ",", 
     RowBox[{
      RowBox[{"KK", "[", 
       RowBox[{"[", 
        RowBox[{
         RowBox[{"1", ";;", "6"}], ",", 
         RowBox[{"1", ";;", "6"}]}], "]"}], "]"}], "/.", "inputData"}], ",", 
     "\"\<CSV\>\""}], "]"}], "\[IndentingNewLine]", 
   RowBox[{"Export", "[", 
    RowBox[{"\"\<DD.csv\>\"", ",", 
     RowBox[{
      RowBox[{"DD", "[", 
       RowBox[{"[", 
        RowBox[{
         RowBox[{"1", ";;", "6"}], ",", 
         RowBox[{"1", ";;", "6"}]}], "]"}], "]"}], "/.", "inputData"}], ",", 
     "\"\<CSV\>\""}], "]"}]}]}]], "Input",
 CellChangeTimes->{{3.8535593577982235`*^9, 3.853559373833294*^9}, {
   3.853559444098879*^9, 3.8535595197723036`*^9}, 3.853560389702248*^9, {
   3.8535604420819116`*^9, 3.853560549881588*^9}, {3.8535606028805933`*^9, 
   3.8535606218163424`*^9}, {3.8535609009118767`*^9, 
   3.8535609396428924`*^9}, {3.853561313826442*^9, 3.8535613697009077`*^9}, {
   3.853561399984832*^9, 3.8535614202190757`*^9}},
 CellLabel->
  "In[121]:=",ExpressionUUID->"ebe8121c-2464-468c-90cb-8380fd728cf8"],

Cell[BoxData["\<\"MM.csv\"\>"], "Output",
 CellChangeTimes->{{3.853560486035971*^9, 3.853560552358797*^9}, 
   3.8535606237719493`*^9, {3.8535609066834335`*^9, 3.853560929174082*^9}, {
   3.853561364670702*^9, 3.8535613703654633`*^9}, 3.853561706233118*^9},
 CellLabel->
  "Out[122]=",ExpressionUUID->"cdbb4c26-2d56-403d-8dfc-f2e54f44aca0"],

Cell[BoxData["\<\"KK.csv\"\>"], "Output",
 CellChangeTimes->{{3.853560486035971*^9, 3.853560552358797*^9}, 
   3.8535606237719493`*^9, {3.8535609066834335`*^9, 3.853560929174082*^9}, {
   3.853561364670702*^9, 3.8535613703654633`*^9}, 3.853561706237113*^9},
 CellLabel->
  "Out[123]=",ExpressionUUID->"9b3c6818-18ea-40e5-b09d-231f12711ff1"],

Cell[BoxData["\<\"DD.csv\"\>"], "Output",
 CellChangeTimes->{{3.853560486035971*^9, 3.853560552358797*^9}, 
   3.8535606237719493`*^9, {3.8535609066834335`*^9, 3.853560929174082*^9}, {
   3.853561364670702*^9, 3.8535613703654633`*^9}, 3.85356170624111*^9},
 CellLabel->
  "Out[124]=",ExpressionUUID->"b65492ef-0976-479c-8aea-dc710364a407"]
}, Open  ]]
}, Open  ]]
}, Closed]]
},
WindowSize->{949.5, 811.5},
WindowMargins->{{-5.25, Automatic}, {Automatic, 0}},
Magnification:>1.05 Inherited,
FrontEndVersion->"13.0 for Microsoft Windows (64-bit) (December 2, 2021)",
StyleDefinitions->"Default.nb",
ExpressionUUID->"0c7bbea7-e122-4d21-9218-4742374d0245"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 159, 3, 70, "Section",ExpressionUUID->"2820e5eb-ad93-4e7a-9a51-957c3d5b4c62"],
Cell[742, 27, 5968, 177, 353, "Text",ExpressionUUID->"e014c3eb-9496-4ff2-a15d-3e4365783218"],
Cell[CellGroupData[{
Cell[6735, 208, 154, 3, 56, "Subsection",ExpressionUUID->"4d02d3aa-253a-4332-825f-23eec052ed53"],
Cell[6892, 213, 10284, 302, 557, "Text",ExpressionUUID->"1569139e-cee4-4ad7-a9c2-f4883bc1e428"]
}, Open  ]],
Cell[CellGroupData[{
Cell[17213, 520, 239, 4, 56, "Subsection",ExpressionUUID->"8c8042b4-13fe-4d5b-967b-52c31362409e"],
Cell[17455, 526, 5691, 158, 508, "Text",ExpressionUUID->"dda5aed4-e7fb-4406-a673-b055eea9099d"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[23195, 690, 164, 3, 70, "Section",ExpressionUUID->"580e10fa-faee-47c9-a4d9-319887c7bd49"],
Cell[CellGroupData[{
Cell[23384, 697, 165, 3, 56, "Subsection",ExpressionUUID->"c4aa0e9e-f4e9-4053-b1e6-99c33b6aa18b"],
Cell[23552, 702, 3977, 100, 350, "Input",ExpressionUUID->"23af980d-e0d6-42ee-8ba7-48292dd1140f"]
}, Open  ]],
Cell[CellGroupData[{
Cell[27566, 807, 161, 3, 56, "Subsection",ExpressionUUID->"b4036aa0-d7f2-465c-8793-6ed1debf4333"],
Cell[CellGroupData[{
Cell[27752, 814, 987, 26, 110, "Input",ExpressionUUID->"6e1a39d7-6ce6-4aa8-bea3-62cfcf4f36db"],
Cell[28742, 842, 10809, 232, 250, "Output",ExpressionUUID->"c467dd42-9058-4a1f-812a-7d05d54e60e8"]
}, Open  ]],
Cell[CellGroupData[{
Cell[39588, 1079, 1649, 47, 134, "Input",ExpressionUUID->"d50e50f0-292c-4d63-a0bf-9a08d6700752"],
Cell[41240, 1128, 35572, 676, 247, "Output",ExpressionUUID->"8b3a849d-a453-493e-8197-352bdc890b90"]
}, Open  ]],
Cell[CellGroupData[{
Cell[76849, 1809, 5670, 155, 629, "Input",ExpressionUUID->"339f4d75-43ba-4300-a97b-d66156332e4f"],
Cell[82522, 1966, 1095, 27, 137, "Output",ExpressionUUID->"802b7156-f5c7-4343-bb6c-63d85874f1da"],
Cell[83620, 1995, 1097, 27, 137, "Output",ExpressionUUID->"7917c94a-8b82-4b3c-9e8d-be765f0d447a"],
Cell[84720, 2024, 1097, 27, 137, "Output",ExpressionUUID->"46f2fb13-8343-41ad-b98f-f0050fc59291"],
Cell[85820, 2053, 1097, 27, 137, "Output",ExpressionUUID->"dee7a291-0a92-4b89-b737-f27263460fc3"],
Cell[86920, 2082, 1097, 27, 137, "Output",ExpressionUUID->"bcd976db-dbd7-4650-bd1c-957e2f6e17b8"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[88066, 2115, 180, 3, 56, "Subsection",ExpressionUUID->"580bb3c2-cabf-4e7d-a618-f84a7faa82da"],
Cell[CellGroupData[{
Cell[88271, 2122, 3311, 88, 130, "Input",ExpressionUUID->"6384b430-3ba7-4ed4-941b-d21af3e7b078"],
Cell[91585, 2212, 1053, 26, 137, "Output",ExpressionUUID->"b5a75fb1-559d-4be6-b684-52c1eb5fc331"],
Cell[92641, 2240, 1155, 30, 169, "Output",ExpressionUUID->"b7a42f58-7a1d-4e0d-a7f3-9f2172dad12f"]
}, Open  ]]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[93857, 2277, 168, 3, 70, "Section",ExpressionUUID->"49ed5daf-d5c0-4691-804c-bf69f17eef5f"],
Cell[CellGroupData[{
Cell[94050, 2284, 2499, 59, 348, "Input",ExpressionUUID->"f4bfefc4-87bf-459e-a121-adbbeeb52a0b"],
Cell[96552, 2345, 901, 26, 137, "Output",ExpressionUUID->"35a73a21-dfa8-4809-84c3-a52b8ed00e29"],
Cell[97456, 2373, 901, 26, 137, "Output",ExpressionUUID->"266fa656-751a-404a-afd7-ebb666e22c2a"],
Cell[98360, 2401, 901, 26, 137, "Output",ExpressionUUID->"84d7adbe-fdcf-4aa3-94f6-a03eaf58280f"],
Cell[99264, 2429, 993, 30, 137, "Output",ExpressionUUID->"c96cf6cc-048c-4e3a-b045-b8a3d2c91ce0"]
}, Open  ]],
Cell[CellGroupData[{
Cell[100294, 2464, 3090, 81, 190, "Input",ExpressionUUID->"9f3dc9eb-2fdb-4356-ac3a-f6763e8b79ce"],
Cell[103387, 2547, 2723, 92, 189, "Output",ExpressionUUID->"277e2dd3-4405-406b-8475-632dec813f79"]
}, Open  ]],
Cell[CellGroupData[{
Cell[106147, 2644, 2243, 62, 90, "Input",ExpressionUUID->"cb8f63be-29a1-4bbf-b4ea-9c6dd7523989"],
Cell[108393, 2708, 7495, 248, 352, "Output",ExpressionUUID->"19a98395-18cc-43c9-8cb9-5ecdec0a4be1"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[115937, 2962, 216, 4, 70, "Section",ExpressionUUID->"ca789be7-ef20-4e36-9cc1-db15afe1b785"],
Cell[CellGroupData[{
Cell[116178, 2970, 2542, 60, 348, "Input",ExpressionUUID->"54e07063-bb02-4fbe-a9c1-fa5809bc1d1e"],
Cell[118723, 3032, 1030, 29, 153, "Output",ExpressionUUID->"ebaa02f8-6237-4d1e-a211-694853054926"],
Cell[119756, 3063, 1184, 35, 153, "Output",ExpressionUUID->"51ae9035-336e-47de-be38-1eb96fc4c065"],
Cell[120943, 3100, 1186, 35, 169, "Output",ExpressionUUID->"97c7a09f-439e-4756-86ea-46386c5afffe"],
Cell[122132, 3137, 1508, 47, 169, "Output",ExpressionUUID->"3ad530d4-5655-4507-9e29-368a6bc65661"]
}, Open  ]],
Cell[CellGroupData[{
Cell[123677, 3189, 3238, 83, 190, "Input",ExpressionUUID->"db507d2d-0c2b-4397-888e-bc26ed4afc6b"],
Cell[126918, 3274, 4287, 127, 199, "Output",ExpressionUUID->"ef7d936a-99af-4959-ac02-c57cde0b5690"]
}, Open  ]],
Cell[CellGroupData[{
Cell[131242, 3406, 2288, 62, 90, "Input",ExpressionUUID->"bd3c1d81-bbd9-40f1-a5de-99c0fdf0b92c"],
Cell[133533, 3470, 12155, 356, 372, "Output",ExpressionUUID->"6dcd53a4-833d-4d14-803e-d99eed82b62b"]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[145737, 3832, 508, 7, 55, "Section",ExpressionUUID->"41427f96-fd3b-4d74-9bb2-863783ca6611"],
Cell[CellGroupData[{
Cell[146270, 3843, 7972, 199, 589, "Input",ExpressionUUID->"81aaaa0b-f022-4a56-b29a-24c362c2cd01"],
Cell[154245, 4044, 942, 24, 82, "Output",ExpressionUUID->"c879d2f5-f785-47b8-b6bf-bbcad5658568"],
Cell[155190, 4070, 2017, 60, 88, "Output",ExpressionUUID->"4f98a9ea-5ad3-4b81-9cbe-ce68b9265b41"],
Cell[157210, 4132, 2910, 93, 185, "Output",ExpressionUUID->"8adccc46-a212-471b-bd59-0e5617b62344"]
}, Open  ]],
Cell[CellGroupData[{
Cell[160157, 4230, 1795, 37, 70, "Input",ExpressionUUID->"66a99d73-94cb-4368-8bed-0377d17bf6f6"],
Cell[161955, 4269, 4299, 131, 203, "Output",ExpressionUUID->"7d18c487-c40e-4edd-8653-018ac561c156"]
}, Open  ]],
Cell[CellGroupData[{
Cell[166291, 4405, 2556, 66, 90, "Input",ExpressionUUID->"7771bd65-3b40-4ae9-bebb-ff5c26eea1d7"],
Cell[168850, 4473, 11567, 357, 380, "Output",ExpressionUUID->"12870d47-8846-434b-b411-b2a8cc30b73a"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[180466, 4836, 563, 8, 70, "Section",ExpressionUUID->"8e1db90c-4305-4e3c-a654-fc29d0462de0"],
Cell[CellGroupData[{
Cell[181054, 4848, 8054, 200, 589, "Input",ExpressionUUID->"880eb7e2-b2d8-4c0e-9588-0dceb74e83e1"],
Cell[189111, 5050, 963, 24, 82, "Output",ExpressionUUID->"950b9764-64da-4fbb-b1a5-2bbce6c4ed1b"],
Cell[190077, 5076, 2039, 60, 88, "Output",ExpressionUUID->"072b9952-ff21-438e-8cb3-b4ff26438df2"],
Cell[192119, 5138, 2932, 93, 185, "Output",ExpressionUUID->"0f11422b-3c31-4923-a625-4aedbd6cda5e"]
}, Open  ]],
Cell[CellGroupData[{
Cell[195088, 5236, 1847, 38, 70, "Input",ExpressionUUID->"cf1cedfd-7add-4256-b99d-49d43724eca6"],
Cell[196938, 5276, 4323, 131, 203, "Output",ExpressionUUID->"5c0a3d20-708d-40dd-8113-42200a2c5aae"]
}, Open  ]],
Cell[CellGroupData[{
Cell[201298, 5412, 2604, 66, 90, "Input",ExpressionUUID->"2efb00a0-855c-4736-bea0-2e6d7c791f12"],
Cell[203905, 5480, 11591, 357, 380, "Output",ExpressionUUID->"ac8b2129-77fc-4af9-8b08-132188cec24f"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[215545, 5843, 513, 7, 70, "Section",ExpressionUUID->"b8adf825-69d3-459f-9c6a-6be2a6b04b47"],
Cell[CellGroupData[{
Cell[216083, 5854, 7754, 197, 589, "Input",ExpressionUUID->"968df1c9-b0fa-4e82-91a5-fd3d6bb1d3f4"],
Cell[223840, 6053, 915, 23, 82, "Output",ExpressionUUID->"af1813dd-4b01-46d4-a187-89a0da7cf7a6"],
Cell[224758, 6078, 1990, 59, 88, "Output",ExpressionUUID->"b912db09-0330-4104-ba36-3201b0397537"],
Cell[226751, 6139, 2883, 92, 185, "Output",ExpressionUUID->"76c176ac-fbf3-4c82-9cd1-a744bd8e2748"]
}, Open  ]],
Cell[CellGroupData[{
Cell[229671, 6236, 1751, 38, 70, "Input",ExpressionUUID->"2ff633da-12cb-45b1-85b6-cd86955c2df0"],
Cell[231425, 6276, 4274, 130, 203, "Output",ExpressionUUID->"183ffb1c-ca20-4578-9238-24d09ebba3fd"]
}, Open  ]],
Cell[CellGroupData[{
Cell[235736, 6411, 2511, 65, 90, "Input",ExpressionUUID->"cf4c5512-6ba8-4841-bfaf-1429c8de97cc"],
Cell[238250, 6478, 11540, 356, 380, "Output",ExpressionUUID->"80169ef1-cd23-4423-8bf3-32c93b16d202"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[249839, 6840, 361, 5, 70, "Section",ExpressionUUID->"a88a241b-2c35-4b48-8b43-1f17e4a8eed9"],
Cell[CellGroupData[{
Cell[250225, 6849, 4537, 110, 429, "Input",ExpressionUUID->"eff80f11-d500-4503-9ce8-1c7ba810a233"],
Cell[254765, 6961, 1109, 27, 33, "Output",ExpressionUUID->"cc8ef9de-84a2-403f-a69a-42047ac51cec"],
Cell[255877, 6990, 1228, 32, 153, "Output",ExpressionUUID->"cf2bc4e5-1da5-4966-801a-40f4722a3ca3"],
Cell[257108, 7024, 1382, 38, 169, "Output",ExpressionUUID->"48d2bbf5-2f4c-4fe6-886b-3c1a804e3fd2"],
Cell[258493, 7064, 1424, 40, 169, "Output",ExpressionUUID->"ae501f3d-171c-4d76-b15e-27130ddb2016"]
}, Open  ]],
Cell[CellGroupData[{
Cell[259954, 7109, 2147, 50, 170, "Input",ExpressionUUID->"41b76958-0bbf-4221-a1f3-802db7ac36ec"],
Cell[262104, 7161, 1975, 61, 191, "Output",ExpressionUUID->"6404f263-3a55-4f8e-8d1a-b7f6ba634254"]
}, Open  ]],
Cell[CellGroupData[{
Cell[264116, 7227, 2395, 64, 90, "Input",ExpressionUUID->"8f65c13a-0f84-46f8-b837-d97fb28cff5d"],
Cell[266514, 7293, 4322, 135, 356, "Output",ExpressionUUID->"5f443d38-63e0-4c5e-96e4-45397c39f05d"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[270885, 7434, 436, 6, 70, "Section",ExpressionUUID->"6a945c24-0771-4dcb-bf4d-13ea415c90ae"],
Cell[271324, 7442, 318, 8, 36, "Text",ExpressionUUID->"0c82aa52-a1d8-49ba-83ea-57cbdd80d320"],
Cell[271645, 7452, 738, 16, 29, "Input",ExpressionUUID->"3fad55ca-6f7f-4b80-93d4-73528f73abdf"],
Cell[CellGroupData[{
Cell[272408, 7472, 3384, 74, 356, "Input",ExpressionUUID->"f8954728-08cb-4830-bd8c-821526794311"],
Cell[275795, 7548, 1332, 31, 137, "Output",ExpressionUUID->"c2ebe363-efa0-4d0d-85e4-cd73c3a5439d"],
Cell[277130, 7581, 1332, 31, 137, "Output",ExpressionUUID->"2e79fb22-bc44-4542-a42c-95c5a2cc3fc0"],
Cell[278465, 7614, 1332, 31, 137, "Output",ExpressionUUID->"3613dde3-d45d-4d33-99c0-df062401b7ba"]
}, Open  ]],
Cell[CellGroupData[{
Cell[279834, 7650, 2314, 52, 170, "Input",ExpressionUUID->"20868554-e6aa-44ff-9402-bd4cebc72fd1"],
Cell[282151, 7704, 1155, 28, 137, "Output",ExpressionUUID->"4e3cd4a0-6677-4adf-8435-1d0021dc2555"]
}, Open  ]],
Cell[CellGroupData[{
Cell[283343, 7737, 2442, 64, 90, "Input",ExpressionUUID->"2131ddf8-3d7a-4d37-abaa-e03572063d8e"],
Cell[285788, 7803, 1705, 36, 248, "Output",ExpressionUUID->"f9013418-9e5c-401b-b577-e15b1f668086"]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[287542, 7845, 172, 3, 55, "Section",ExpressionUUID->"6d459f44-53b2-47de-8814-b6d43cc10399"],
Cell[287717, 7850, 1556, 34, 50, "Input",ExpressionUUID->"9626b028-589b-491c-9638-3fdbf8a29a5f"],
Cell[CellGroupData[{
Cell[289298, 7888, 640, 18, 50, "Input",ExpressionUUID->"14c76b5a-3b81-4255-9845-e46b54fefdc0"],
Cell[289941, 7908, 1797, 40, 137, "Output",ExpressionUUID->"5f592e99-4e19-45c7-b57f-0c0d5b7ee62a"],
Cell[291741, 7950, 1715, 38, 137, "Output",ExpressionUUID->"eccd2494-1aec-489c-8441-081d6f80182c"]
}, Open  ]],
Cell[CellGroupData[{
Cell[293493, 7993, 593, 17, 50, "Input",ExpressionUUID->"c8075474-116e-4820-ab5b-85348a5872df"],
Cell[294089, 8012, 2077, 45, 155, "Output",ExpressionUUID->"deba6e87-e177-4d11-9c55-b2209755ae7b"],
Cell[296169, 8059, 1976, 45, 155, "Output",ExpressionUUID->"cacc789a-a588-4f36-a9a9-6e5d23328a6a"]
}, Open  ]],
Cell[CellGroupData[{
Cell[298182, 8109, 540, 16, 50, "Input",ExpressionUUID->"46719a33-94a5-4f93-bcbf-3982c2c45668"],
Cell[298725, 8127, 1336, 34, 153, "Output",ExpressionUUID->"9ab0a816-0087-4c54-afa2-78764164f704"],
Cell[300064, 8163, 1285, 33, 153, "Output",ExpressionUUID->"00f3a77b-9d8f-4e77-964d-c337e3302ff1"]
}, Open  ]],
Cell[CellGroupData[{
Cell[301386, 8201, 170, 6, 84, "Subsection",ExpressionUUID->"79951ac1-5e89-4653-94a1-362406369672"],
Cell[301559, 8209, 249, 6, 36, "Text",ExpressionUUID->"9f2261a0-351a-43cd-8cca-d92d1e558414"],
Cell[CellGroupData[{
Cell[301833, 8219, 1850, 47, 110, "Input",ExpressionUUID->"ebe8121c-2464-468c-90cb-8380fd728cf8"],
Cell[303686, 8268, 340, 5, 33, "Output",ExpressionUUID->"cdbb4c26-2d56-403d-8dfc-f2e54f44aca0"],
Cell[304029, 8275, 340, 5, 33, "Output",ExpressionUUID->"9b3c6818-18ea-40e5-b09d-231f12711ff1"],
Cell[304372, 8282, 339, 5, 33, "Output",ExpressionUUID->"b65492ef-0976-479c-8aea-dc710364a407"]
}, Open  ]]
}, Open  ]]
}, Closed]]
}
]
*)

